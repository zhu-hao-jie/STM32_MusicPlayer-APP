


ARM Macro Assembler    Page 1 


    1 00000000         
    2 00000000         
    3 00000000        A 
                       globalptr
                               RN               r10         ;//=wram_globals* p
                                                            tr 6502µÄ»ù×¼Ö¸Õë
    4 00000000         ;-------------------------------------------------------
                       ---------------------
    5 00000000         
    6 00000000                 MAP              0,globalptr ;//MAP ÓÃÓÚ¶¨ÒåÒ»¸ö
                                                            ½á¹¹»¯µÄÄÚ´æ±íµÄÊ×µ
                                                            ØÖ·
    7 00000000         ;//6502.s   ;//¶¨ÒåÄÚ´æ±íµÄÊ×µØÖ·Îªglobalptr
    8 00000000 00000000 
                       opz     #                4           ;opz # 256*4       
                                                            ;//´úÂë±íµØÖ·      
                                                             
    9 00000000 00000004 
                       readmem_tbl
                               #                8*4         ;//8*4
   10 00000000 00000024 
                       writemem_tbl
                               #                8*4         ;//8*4
   11 00000000 00000044 
                       memmap_tbl
                               #                8*4         ;//´æ´¢Æ÷Ó³Ïó ram+r
                                                            om
   12 00000000 00000064 
                       cpuregs #                7*4         ;//1208´æ·Å6502¼Ä´æ
                                                            Æ÷±£´æµÄ¿ªÊ¼µØÖ·
   13 00000000 00000080 
                       m6502_s #                4           ;//
   14 00000000 00000084 
                       lastbank
                               #                4           ;//6502PC´Ó ROMµÄ×î
                                                            ºóÆ«ÒÆÁ¿
   15 00000000 00000088 
                       nexttimeout
                               #                4
   16 00000000         
   17 00000000 0000008C 
                       rombase #                4           ;//ROM¿ªÊ¼µØÖ·
   18 00000000 00000090 
                       romnumber
                               #                4           ;// ROM´óÐ¡  
   19 00000000 00000094 
                       rommask #                4           ;//ROMÑÚÄ¤ rommask=
                                                            romsize-1
   20 00000000         
   21 00000000 00000098 
                       joy0data
                               #                4           ;//´®ÐÐÊý¾Ý
   22 00000000 0000009C 
                       joy1data
                               #                4           ;//ÊÖ±ú1´®ÐÐÊý¾Ý
   23 00000000         
   24 00000000 000000A0 
                       clocksh #                4           ;//Ö´ÐÐµÄÊ±ÖÓÊý apu
                                                            ÓÃ



ARM Macro Assembler    Page 2 


   25 00000000 000000A4 
                       cpunmif #                4           ;cpuÖÐ¶Ï±êÖ¾
   26 00000000 000000A8 
                       cpuirqf #                4           ;cpuÖÐ¶Ï±êÖ¾   43*4
                                                            
   27 00000000         ;*******************************************************
                       ****************************************
   28 00000000 00000001 
                       C       EQU              0x01        ;//6502 flags  6502
                                                            ±êÖ¾
   29 00000000 00000002 
                       Z       EQU              0x02
   30 00000000 00000004 
                       I       EQU              0x04
   31 00000000 00000008 
                       D       EQU              0x08
   32 00000000 00000010 
                       B       EQU              0x10        ;//(allways 1 excep
                                                            t when IRQ pushes i
                                                            t)IRQÍâ²¿ÖÐ¶Ï
   33 00000000 00000020 
                       R       EQU              0x20        ;//(locked at 1)
   34 00000000 00000040 
                       V       EQU              0x40
   35 00000000 00000080 
                       N       EQU              0x80
   36 00000000         
   37 00000000                 MACRO                        ;//translate from 6
                                                            502 PC to rom offse
                                                            t·­Òë´Ó6502 PC ROMµ
                                                            ÄÆ«ÒÆÁ¿
   38 00000000                 encodePC
   39 00000000                 and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 00000000                 adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   41 00000000         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 00000000                 lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 00000000                 ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 00000000         
   45 00000000                 str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 00000000                 add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
   47 00000000                 MEND
   48 00000000         
   49 00000000                 MACRO                        ;//pack 6502 flags 
                                                            into r0   6502±êÖ¾°
                                                            ü×°µ½R0
   50 00000000                 encodeP          $extra
   51 00000000                 and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   52 00000000                 tst              m6502_nz,#0x80000000 ;//PSR_N
   53 00000000                 orrne            r0,r0,#N    ;N
   54 00000000                 tst              m6502_nz,#0xff
   55 00000000                 orreq            r0,r0,#Z    ;Z
   56 00000000                 orr              r0,r0,#$extra ;R(&B)



ARM Macro Assembler    Page 3 


   57 00000000                 MEND
   58 00000000         
   59 00000000                 MACRO                        ;//;ºê¶¨Òå//unpack 
                                                            6502 flags from r0 
                                                              ½âÑ¹Ëõ6502´ÓR0µÄ±
                                                            êÖ¾
   60 00000000                 decodeP
   61 00000000                 bic              cycles,cycles,#CYC_V+CYC_D+CYC_
I+CYC_C
   62 00000000                 and              r1,r0,#V+D+I+C
   63 00000000                 orr              cycles,cycles,r1 ;//VDIC
   64 00000000                 bic              m6502_nz,r0,#0xFD 
                                                            ;//r0 is signed
   65 00000000                 eor              m6502_nz,m6502_nz,#Z
   66 00000000                 MEND                         ;//    ;ºê¶¨Òå½áÊø
   67 00000000         
   68 00000000                 MACRO
   69 00000000                 fetch            $count      ;//ÌáÈ¡²Ù×÷Âë ;$±êº
                                                            Å ºêÃû $²ÎÊý1£¬$²ÎÊ
                                                            ý2£¬...
   70 00000000         ;//-----------------------------------------------------
                       ----------------
   71 00000000                 ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000000                 add              r0,r0,#$count
   73 00000000                 str              r0,clocksh
   74 00000000         
   75 00000000                 ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000000         ;//-----------------------------------------------------
                       --------------------
   77 00000000                 subs             cycles,cycles,#$count*256 ;//CY
                                                            CLE=256 ;// 3*256 Õ
                                                            ýÊý»ò0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸
                                                            Áî  
   78 00000000                 ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000000         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000000                 ldrpl            pc,[r1,r0,lsl#2]
   81 00000000                 ldr              pc,nexttimeout
   82 00000000                 MEND
   83 00000000         
   84 00000000                 MACRO                        ;//ÏàÍ¬µÄÌáÈ¡£¬µ«Ëü
                                                            Ôö¼ÓÁË½øÎ»£¨Î»0£©
   85 00000000                 fetch_c          $count      ;//same as fetch ex
                                                            cept it adds the Ca
                                                            rry (bit 0) also.
   86 00000000         ;//-----------------------------------------------------
                       ----------------
   87 00000000                 ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000000                 add              r0,r0,#$count
   89 00000000                 str              r0,clocksh
   90 00000000         
   91 00000000                 ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 4 


   92 00000000         ;//-----------------------------------------------------
                       --------------------
   93 00000000                 sbcs             cycles,cycles,#$count*256 
                                                            ;//CYCLE=256
   94 00000000                 ldrplb           r0,[m6502_pc],#1
   95 00000000         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000000                 ldrpl            pc,[r1,r0,lsl#2]
   97 00000000                 ldr              pc,nexttimeout
   98 00000000                 MEND
   99 00000000         
  100 00000000                 MACRO
  101 00000000                 clearcycles
  102 00000000                 and              cycles,cycles,#CYC_MASK 
                                                            ;Save CPU bits
  103 00000000                 MEND
  104 00000000         
  105 00000000                 MACRO
  106 00000000                 readmemabs
  107 00000000                 and              r1,addy,#0xE000
  108 00000000                 adr              lr,%F0
  109 00000000         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000000                 lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000000                 ldr              pc,[m6502_rmem,r1]
  112 00000000         
  113 00000000         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  114 00000000                 MEND
  115 00000000         
  116 00000000                 MACRO
  117 00000000                 readmemzp
  118 00000000                 ldrb             r0,[cpu_zpage,addy]
  119 00000000                 MEND
  120 00000000         
  121 00000000                 MACRO
  122 00000000                 readmemzpi
  123 00000000         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 00000000                 lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 00000000                 ldrb             r0,[cpu_zpage,r0]
  126 00000000         
  127 00000000                 MEND
  128 00000000         
  129 00000000                 MACRO
  130 00000000                 readmemzps
  131 00000000                 ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  132 00000000                 MEND
  133 00000000         
  134 00000000                 MACRO
  135 00000000                 readmemimm
  136 00000000                 ldrb             r0,[m6502_pc],#1 ;ROM
  137 00000000                 MEND
  138 00000000         
  139 00000000                 MACRO
  140 00000000                 readmemimms
  141 00000000                 ldrsb            m6502_nz,[m6502_pc],#1



ARM Macro Assembler    Page 5 


  142 00000000                 MEND
  143 00000000         
  144 00000000                 MACRO
  145 00000000                 readmem
  146 00000000                 [                _type = _ABS
  147 00000000                 readmemabs
  148 00000000                 ]
  149 00000000                 [                _type = _ZP
  150 00000000                 readmemzp
  151 00000000                 ]
  152 00000000                 [                _type = _ZPI
  153 00000000                 readmemzpi
  154 00000000                 ]
  155 00000000                 [                _type = _IMM
  156 00000000                 readmemimm
  157 00000000                 ]
  158 00000000                 MEND
  159 00000000         
  160 00000000                 MACRO
  161 00000000                 readmems
  162 00000000                 [                _type = _ABS
  163 00000000                 readmemabs
  164 00000000                 orr              m6502_nz,r0,r0,lsl#24
  165 00000000                 ]
  166 00000000                 [                _type = _ZP
  167 00000000                 readmemzps
  168 00000000                 ]
  169 00000000                 [                _type = _IMM
  170 00000000                 readmemimms
  171 00000000                 ]
  172 00000000                 MEND
  173 00000000         
  174 00000000         
  175 00000000                 MACRO
  176 00000000                 writememabs
  177 00000000                 and              r1,addy,#0xe000
  178 00000000                 adr              r2,writemem_tbl
  179 00000000                 adr              lr,%F0
  180 00000000         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00000000                 lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00000000                 ldr              pc,[r2,r1]
  183 00000000         
  184 00000000         0                                    ;out: r0,r1,r2,addy
                                                            =?
  185 00000000                 MEND
  186 00000000         
  187 00000000                 MACRO
  188 00000000                 writememzp
  189 00000000                 strb             r0,[cpu_zpage,addy]
  190 00000000                 MEND
  191 00000000         
  192 00000000                 MACRO
  193 00000000                 writememzpi
  194 00000000         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 00000000                 lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 00000000                 strb             r0,[cpu_zpage,r1]



ARM Macro Assembler    Page 6 


  197 00000000         
  198 00000000         
  199 00000000                 MEND
  200 00000000         
  201 00000000                 MACRO
  202 00000000                 writemem                     ;//Ð´ÄÚ´æ
  203 00000000                 [                _type = _ABS
  204 00000000                 writememabs
  205 00000000                 ]
  206 00000000                 [                _type = _ZP
  207 00000000                 writememzp
  208 00000000                 ]
  209 00000000                 [                _type = _ZPI
  210 00000000                 writememzpi
  211 00000000                 ]
  212 00000000                 MEND
  213 00000000         ;-------------------------------------------------------
                       ---------------------
  214 00000000         
  215 00000000                 MACRO                        ;//////////////////
                                                            /////////////// ///
                                                            //////////////////
  216 00000000                 push16                       ;push r0
  217 00000000                 mov              r1,r0,lsr#8
  218 00000000                 ldr              r2,m6502_s
  219 00000000                 strb             r1,[r2],#-1
  220 00000000                 orr              r2,r2,#0x100
  221 00000000                 strb             r0,[r2],#-1
  222 00000000                 strb             r2,m6502_s
  223 00000000                 MEND                         ;r1,r2=?
  224 00000000         
  225 00000000                 MACRO
  226 00000000                 push8            $x
  227 00000000                 ldr              r2,m6502_s
  228 00000000                 strb             $x,[r2],#-1
  229 00000000                 strb             r2,m6502_s
  230 00000000                 MEND                         ;r2=?
  231 00000000         
  232 00000000                 MACRO
  233 00000000                 pop16                        ;pop m6502_pc
  234 00000000                 ldrb             r2,m6502_s
  235 00000000                 add              r2,r2,#2
  236 00000000                 strb             r2,m6502_s
  237 00000000                 ldr              r2,m6502_s
  238 00000000                 ldrb             r0,[r2],#-1
  239 00000000                 orr              r2,r2,#0x100
  240 00000000                 ldrb             m6502_pc,[r2]
  241 00000000                 orr              m6502_pc,m6502_pc,r0,lsl#8
  242 00000000                 MEND                         ;r0,r1=?
  243 00000000         
  244 00000000                 MACRO
  245 00000000                 pop8             $x
  246 00000000                 ldrb             r2,m6502_s
  247 00000000                 add              r2,r2,#1
  248 00000000                 strb             r2,m6502_s
  249 00000000                 orr              r2,r2,#0x100
  250 00000000                 ldrsb            $x,[cpu_zpage,r2] ;signed for P
                                                            LA & PLP
  251 00000000         



ARM Macro Assembler    Page 7 


  252 00000000                 MEND                         ;r2=?
  253 00000000         
  254 00000000         ;-------------------------------------------------------
                       ---------------------
  255 00000000         ;doXXX: load addy, increment m6502_pc
  256 00000000         
  257 00000000                 GBLA             _type
  258 00000000         
  259 00000000 00000001 
                       _IMM    EQU              1           ;immediate
  260 00000000 00000002 
                       _ZP     EQU              2           ;zero page
  261 00000000 00000003 
                       _ZPI    EQU              3           ;zero page indexed
  262 00000000 00000004 
                       _ABS    EQU              4           ;absolute
  263 00000000         
  264 00000000                 MACRO
  265 00000000                 doABS                        ;absolute          
                                                                 $nnnn
  266 00000000         _type   SETA             _ABS
  267 00000000                 ldrb             addy,[m6502_pc],#1
  268 00000000                 ldrb             r0,[m6502_pc],#1
  269 00000000                 orr              addy,addy,r0,lsl#8
  270 00000000                 MEND
  271 00000000         
  272 00000000                 MACRO
  273 00000000                 doAIX                        ;absolute indexed X
                                                                 $nnnn,X
  274 00000000         _type   SETA             _ABS
  275 00000000                 ldrb             addy,[m6502_pc],#1
  276 00000000                 ldrb             r0,[m6502_pc],#1
  277 00000000                 orr              addy,addy,r0,lsl#8
  278 00000000                 add              addy,addy,m6502_x,lsr#24
  279 00000000         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  280 00000000                 MEND
  281 00000000         
  282 00000000                 MACRO
  283 00000000                 doAIY                        ;absolute indexed Y
                                                                 $nnnn,Y
  284 00000000         _type   SETA             _ABS
  285 00000000                 ldrb             addy,[m6502_pc],#1
  286 00000000                 ldrb             r0,[m6502_pc],#1
  287 00000000                 orr              addy,addy,r0,lsl#8
  288 00000000                 add              addy,addy,m6502_y,lsr#24
  289 00000000         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  290 00000000                 MEND
  291 00000000         
  292 00000000                 MACRO
  293 00000000                 doIMM                        ;immediate         
                                                                 #$nn
  294 00000000         _type   SETA             _IMM
  295 00000000                 MEND
  296 00000000         
  297 00000000                 MACRO
  298 00000000                 doIIX                        ;indexed indirect X
                                                                 ($nn,X)
  299 00000000         _type   SETA             _ABS
  300 00000000                 ldrb             r0,[m6502_pc],#1



ARM Macro Assembler    Page 8 


  301 00000000                 add              r0,m6502_x,r0,lsl#24
  302 00000000         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00000000                 lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00000000                 ldrb             addy,[cpu_zpage,addy]
  305 00000000         
  306 00000000                 add              r0,r0,#0x01000000
  307 00000000         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00000000                 lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00000000                 ldrb             r1,[cpu_zpage,r1]
  310 00000000         
  311 00000000                 orr              addy,addy,r1,lsl#8
  312 00000000                 MEND
  313 00000000         
  314 00000000                 MACRO
  315 00000000                 doIIY                        ;indirect indexed Y
                                                                 ($nn),Y
  316 00000000         _type   SETA             _ABS
  317 00000000                 ldrb             r0,[m6502_pc],#1
  318 00000000         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 00000000         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 00000000                 ldrb             addy,[r0,cpu_zpage]
  321 00000000                 add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 00000000         
  323 00000000         
  324 00000000                 ldrb             r1,[r0,#1]
  325 00000000                 orr              addy,addy,r1,lsl#8
  326 00000000                 add              addy,addy,m6502_y,lsr#24
  327 00000000         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  328 00000000                 MEND
  329 00000000         
  330 00000000                 MACRO
  331 00000000                 doZPI                        ;Zeropage indirect 
                                                                ($nn)
  332 00000000         _type   SETA             _ABS
  333 00000000                 ldrb             r0,[m6502_pc],#1
  334 00000000         ;// ldrb addy,[r0,cpu_zpage]!;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼Ó
                       µ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  335 00000000         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  336 00000000                 ldrb             addy,[r0,cpu_zpage]
  337 00000000                 add              r0,r0,cpu_zpage
  338 00000000         
  339 00000000         
  340 00000000                 ldrb             r1,[r0,#1]
  341 00000000                 orr              addy,addy,r1,lsl#8
  342 00000000                 MEND
  343 00000000         
  344 00000000                 MACRO
  345 00000000                 doZ                          ;zero page         
                                                                 $nn
  346 00000000         _type   SETA             _ZP
  347 00000000                 ldrb             addy,[m6502_pc],#1
  348 00000000                 MEND
  349 00000000         



ARM Macro Assembler    Page 9 


  350 00000000                 MACRO
  351 00000000                 doZ2                         ;zero page         
                                                                 $nn
  352 00000000         _type   SETA             _ZP
  353 00000000                 ldrb             addy,[m6502_pc],#2 ;ugly thing 
                                                            for bbr/bbs
  354 00000000                 MEND
  355 00000000         
  356 00000000                 MACRO
  357 00000000                 doZIX                        ;zero page indexed 
                                                            X    $nn,X
  358 00000000         _type   SETA             _ZP
  359 00000000                 ldrb             addy,[m6502_pc],#1
  360 00000000                 add              addy,addy,m6502_x,lsr#24
  361 00000000                 and              addy,addy,#0xff 
                                                            ;Rygar needs this
  362 00000000                 MEND
  363 00000000         
  364 00000000                 MACRO
  365 00000000                 doZIXf                       ;zero page indexed 
                                                            X    $nn,X
  366 00000000         _type   SETA             _ZPI
  367 00000000                 ldrb             addy,[m6502_pc],#1
  368 00000000                 add              addy,m6502_x,addy,lsl#24
  369 00000000                 MEND
  370 00000000         
  371 00000000                 MACRO
  372 00000000                 doZIY                        ;zero page indexed 
                                                            Y    $nn,Y
  373 00000000         _type   SETA             _ZP
  374 00000000                 ldrb             addy,[m6502_pc],#1
  375 00000000                 add              addy,addy,m6502_y,lsr#24
  376 00000000                 and              addy,addy,#0xff
  377 00000000                 MEND
  378 00000000         
  379 00000000                 MACRO
  380 00000000                 doZIYf                       ;zero page indexed 
                                                            Y    $nn,Y
  381 00000000         _type   SETA             _ZPI
  382 00000000                 ldrb             addy,[m6502_pc],#1
  383 00000000                 add              addy,m6502_y,addy,lsl#24
  384 00000000                 MEND
  385 00000000         
  386 00000000         ;-------------------------------------------------------
                       ---------------------
  387 00000000         
  388 00000000                 MACRO
  389 00000000                 opADC
  390 00000000                 readmem
  391 00000000                 movs             r1,cycles,lsr#1 ;get C
  392 00000000                 subcs            r0,r0,#0x00000100
  393 00000000                 adcs             m6502_a,m6502_a,r0,ror#8
  394 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00000000                 orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 00000000                 bicvc            cycles,cycles,#CYC_V ;V
  397 00000000                 MEND
  398 00000000         
  399 00000000                 MACRO



ARM Macro Assembler    Page 10 


  400 00000000                 opAND
  401 00000000                 readmem
  402 00000000                 and              m6502_a,m6502_a,r0,lsl#24
  403 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  404 00000000                 MEND
  405 00000000         
  406 00000000                 MACRO
  407 00000000                 opASL
  408 00000000                 readmem
  409 00000000                 add              r0,r0,r0
  410 00000000                 orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  411 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  412 00000000                 writemem
  413 00000000                 MEND
  414 00000000         
  415 00000000                 MACRO
  416 00000000                 opBIT
  417 00000000                 readmem
  418 00000000                 bic              cycles,cycles,#CYC_V ;reset V
  419 00000000                 tst              r0,#V
  420 00000000                 orrne            cycles,cycles,#CYC_V ;V
  421 00000000                 and              m6502_nz,r0,m6502_a,lsr#24 ;Z
  422 00000000                 orr              m6502_nz,m6502_nz,r0,lsl#24 ;N
  423 00000000                 MEND
  424 00000000         
  425 00000000                 MACRO
  426 00000000                 opCOMP           $x          ;A,X & Y
  427 00000000                 readmem
  428 00000000                 subs             m6502_nz,$x,r0,lsl#24
  429 00000000                 mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  431 00000000                 MEND
  432 00000000         
  433 00000000                 MACRO
  434 00000000                 opDEC
  435 00000000                 readmem
  436 00000000                 sub              r0,r0,#1
  437 00000000                 orr              m6502_nz,r0,r0,lsl#24 ;NZ
  438 00000000                 writemem
  439 00000000                 MEND
  440 00000000         
  441 00000000                 MACRO
  442 00000000                 opEOR
  443 00000000                 readmem
  444 00000000                 eor              m6502_a,m6502_a,r0,lsl#24
  445 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  446 00000000                 MEND
  447 00000000         
  448 00000000                 MACRO
  449 00000000                 opINC
  450 00000000                 readmem
  451 00000000                 add              r0,r0,#1
  452 00000000                 orr              m6502_nz,r0,r0,lsl#24 ;NZ
  453 00000000                 writemem
  454 00000000                 MEND
  455 00000000         
  456 00000000                 MACRO



ARM Macro Assembler    Page 11 


  457 00000000                 opLOAD           $x
  458 00000000                 readmems
  459 00000000                 mov              $x,m6502_nz,lsl#24
  460 00000000                 MEND
  461 00000000         
  462 00000000                 MACRO
  463 00000000                 opLSR
  464 00000000                 [                _type = _ABS
  465 00000000                 readmemabs
  466 00000000                 movs             r0,r0,lsr#1
  467 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  468 00000000                 mov              m6502_nz,r0 ;Z, (N=0)
  469 00000000                 writememabs
  470 00000000                 ]
  471 00000000                 [                _type = _ZP
  472 00000000                 ldrb             m6502_nz,[cpu_zpage,addy]
  473 00000000                 movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  474 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  475 00000000                 strb             m6502_nz,[cpu_zpage,addy]
  476 00000000                 ]
  477 00000000                 [                _type = _ZPI
  478 00000000         ;//  ldrb m6502_nz,[cpu_zpage,addy,lsr#24]
  479 00000000                 lsr              m6502_nz,addy,#24 
                                                            ;//¸Ä¹ý£¬¼Ó2ÐÐ
  480 00000000                 ldrb             m6502_nz,[cpu_zpage,m6502_nz]
  481 00000000         
  482 00000000                 movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  483 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  484 00000000         ;//  strb m6502_nz,[cpu_zpage,addy,lsr#24]
  485 00000000                 lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ
  486 00000000                 strb             m6502_nz,[cpu_zpage,r1]
  487 00000000         
  488 00000000                 ]
  489 00000000                 MEND
  490 00000000         
  491 00000000                 MACRO
  492 00000000                 opORA
  493 00000000                 readmem
  494 00000000                 orr              m6502_a,m6502_a,r0,lsl#24
  495 00000000                 mov              m6502_nz,m6502_a,asr#24
  496 00000000                 MEND
  497 00000000         
  498 00000000                 MACRO
  499 00000000                 opROL
  500 00000000                 readmem
  501 00000000                 movs             cycles,cycles,lsr#1 ;get C
  502 00000000                 adc              r0,r0,r0
  503 00000000                 orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  504 00000000                 adc              cycles,cycles,cycles ;Set C
  505 00000000                 writemem
  506 00000000                 MEND
  507 00000000         
  508 00000000                 MACRO
  509 00000000                 opROR



ARM Macro Assembler    Page 12 


  510 00000000                 readmem
  511 00000000                 movs             cycles,cycles,lsr#1 ;get C
  512 00000000                 orrcs            r0,r0,#0x100
  513 00000000                 movs             r0,r0,lsr#1
  514 00000000                 orr              m6502_nz,r0,r0,lsl#24 ;NZ
  515 00000000                 adc              cycles,cycles,cycles ;Set C
  516 00000000                 writemem
  517 00000000                 MEND
  518 00000000         
  519 00000000                 MACRO
  520 00000000                 opSBC
  521 00000000                 readmem
  522 00000000                 movs             r1,cycles,lsr#1 ;get C
  523 00000000                 sbcs             m6502_a,m6502_a,r0,lsl#24
  524 00000000                 and              m6502_a,m6502_a,#0xff000000
  525 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 00000000                 orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 00000000                 bicvc            cycles,cycles,#CYC_V ;V
  528 00000000                 MEND
  529 00000000         
  530 00000000                 MACRO
  531 00000000                 opSTORE          $x
  532 00000000                 mov              r0,$x,lsr#24
  533 00000000                 writemem
  534 00000000                 MEND
  535 00000000         ;*******************************************************
                       ******************************************
  536 00000000         
  537 00000000                 IMPORT           NES_RAM     ;nes_main.c   __ali
                                                            gn(1024) uint8 NES_
                                                            RAM[0x800];//±£³Ö10
                                                            24×Ö½Ú¶ÔÆë
  538 00000000                 IMPORT           NES_SRAM    ;nes_main.c   uint8
                                                             NES_SRAM[0x2000]; 
                                                            
  539 00000000                 IMPORT           spr_ram     ;             uint8
                                                             spr_ram[0x100];
  540 00000000                 IMPORT           romfile     ;from main.c 
  541 00000000         
  542 00000000                 EXPORT           cpunmi      ;cpuÖÐ¶Ï±êÖ¾
  543 00000000                 EXPORT           cpuirq      ;cpuÖÐ¶Ï±êÖ¾ 
  544 00000000                 EXPORT           clocks      ;apuÒªµÄcpuÊ±ÖÓ
  545 00000000                 EXPORT           cpu_data    ;µØÖ· cart.s
  546 00000000                 EXPORT           rommap
  547 00000000                 EXPORT           NMI6502
  548 00000000                 EXPORT           CPU_reset
  549 00000000                 EXPORT           run6502
  550 00000000         
  551 00000000                 EXPORT           cpu6502_init
  552 00000000                 EXPORT           map67_
  553 00000000                 EXPORT           map67_0
  554 00000000                 EXPORT           map89_
  555 00000000                 EXPORT           mapAB_
  556 00000000                 EXPORT           mapCD_
  557 00000000                 EXPORT           mapEF_
  558 00000000                 EXPORT           map89ABCDEF_
  559 00000000         
  560 00000000 0000FFFE 



ARM Macro Assembler    Page 13 


                       IRQ_VECTOR
                               EQU              0xfffe      ; //IRQ / BRKÖÐ¶ÏÏò
                                                            Á¿µØÖ·
  561 00000000 0000FFFC 
                       RES_VECTOR
                               EQU              0xfffc      ;// ¸´Î»ÖÐ¶ÏÏòÁ¿µØÖ
                                                            ·
  562 00000000 0000FFFA 
                       NMI_VECTOR
                               EQU              0xfffa      ;// NMIÖÐ¶ÏÏòÁ¿µØÖ·
                                                            
  563 00000000         
  564 00000000         ;cycle flags- (stored in cycles reg for speed)´æ´¢ÔÚÖÜÆÚ
                       ÕÂËÙ¶È
  565 00000000         
  566 00000000 00000001 
                       CYC_C   EQU              0x01        ;Carry bit ½øÎ»
  567 00000000         ;BRANCH   EQU 0x02 ;branch instruction encountered Óöµ½·
                       ÖÖ§Ö¸Áî
  568 00000000 00000004 
                       CYC_I   EQU              0x04        ;IRQ mask
  569 00000000 00000008 
                       CYC_D   EQU              0x08        ;Decimal bit Ð¡ÊýÎ»
                                                            
  570 00000000 00000040 
                       CYC_V   EQU              0x40        ;Overflow bit  Òç³ö
                                                            Î»
  571 00000000         ;CYC_MASK  EQU 0xFF;CYCLE-1 ;Mask
  572 00000000         
  573 00000000                 AREA             cpu_code, CODE, READONLY 
                                                            ;, ALIGN=2
  574 00000000         ; ²»Òª¶Ô ARM ´úÂë½ÚÊ¹ÓÃ ALIGN=0 »ò ALIGN=1¡£
  575 00000000         ;    ²»Òª¶Ô Thumb ´úÂë½ÚÊ¹ÓÃ ALIGN=0¡£
  576 00000000         ;AREA  Î±´úÂëÒ²ÊÇÐèÒªÓï·¨µÄ£¬AREA  ºóÃæ¸ú×Å¶ÎÃû±êºÅ£¬È»º
                       óÊÇÊôÐÔ£¬CODE ±íÊ¾ÕâÊÇÒ» 
  577 00000000         ;¸ö´úÂë¶Î£¬READONLY ±íÊ¾Õâ¸ö¶ÎÊÇÖ»¶ÁµÄ
  578 00000000         ;|.text|ÏµÍ³Ä¬ÈÏµÄ´úÂë¶ÎÃû  
  579 00000000         ; ALIGN Ö¸ÁîÍ¨¹ýÓÃÁã»ò NOP Ö¸Áî½øÐÐÌî³ä½«µ±Ç°Î»ÖÃ¶ÔÆëµ½Ö
                       ¸¶¨±ß½ç
  580 00000000         ;ENTRY  Õâ¸öÎ±´úÂëÊÇÓÃÀ´¶¨ÒåÈë¿Úµã
  581 00000000                 THUMB                        ;ThumbÊÇARMÌåÏµ½á¹¹
                                                            ÖÐÒ»ÖÖ16Î»µÄÖ¸Áî¼¯
  582 00000000         ; REQUIRE8  ;REQUIRE8 Ö¸ÁîÖ¸¶¨µ±Ç°ÎÄ¼þÒªÇó¶ÑÕ»°Ë×Ö½Ú¶ÔÆë
                       ¡£ ËüÉèÖÃ REQ8 ±àÒëÊôÐÔÒÔÍ¨ÖªÁ´½ÓÆ÷¡£
  583 00000000                 PRESERVE8                    ;{TRUE} ;PRESERVE8 
                                                            Ö¸ÁîÖ¸¶¨µ±Ç°ÎÄ¼þ±£³
                                                            Ö¶ÑÕ»°Ë×Ö½Ú¶ÔÆë¡£ Ë
                                                            üÉèÖÃ PRES8 ±àÒëÊôÐ
                                                            ÔÒÔÍ¨ÖªÁ´½ÓÆ÷¡£
  584 00000000         ;Èç¹ûÄúÊ¡ÂÔ PRESERVE8 ºÍ PRESERVE8 {FALSE}£¬»ã±à³ÌÐò»á¼ì
                       ²éÐÞ¸Ä sp µÄÖ¸Áî£¬
  585 00000000         ;ÒÔ¾ö¶¨ÊÇ·ñÉèÖÃ PRES8 ±àÒëÊôÐÔ¡£ ARM ½¨ÒéÃ÷È·Ö¸¶¨ PRESER
                       VE8¡£
  586 00000000         ; ARMÊ¹ÓÃr0×÷Îª·µ»ØÖµ
  587 00000000         ;²ÎÊý´«µÝARM£º¼Ä´æÆ÷µ½¶ÑÕ»£¬Ê×ÏÈ½«²ÎÊý¸³¸ør0, r1µÈ
  588 00000000         
  589 00000000         ;  PROC Îª×Ó³ÌÐò¿ªÊ¼£¬ENDP Îª×Ó³ÌÐò½áÊø
  590 00000000         
  591 00000000         



ARM Macro Assembler    Page 14 


  592 00000000         ;r0,r1,r2=temp regs   
  593 00000000        3 
                       m6502_nz
                               RN               r3          ;bit 31=N, Z=1 if b
                                                            its 0-7=0    ;RN¶¨Ò
                                                            å¼Ä´æÆ÷Ãû
  594 00000000        4 
                       m6502_rmem
                               RN               r4          ;readmem_tbl
  595 00000000        5 
                       m6502_a RN               r5          ;//bits 0-23=0, »¹Ó
                                                            ÃÓÚÇå³ýÔÚÄÚ´æÖÐµÄ×Ö
                                                            ½Ú
  596 00000000        6 
                       m6502_x RN               r6          ;bits 0-23=0
  597 00000000        7 
                       m6502_y RN               r7          ;bits 0-23=0
  598 00000000        8 
                       cycles  RN               r8          ;//also VDIC flagsÒ
                                                            ²VDIC±êÖ¾
  599 00000000        9 
                       m6502_pc
                               RN               r9
  600 00000000        A 
                       globalptr
                               RN               r10         ;=wram_globals* ptr
                                                            
  601 00000000        A 
                       m6502_optbl
                               RN               r10
  602 00000000        B 
                       cpu_zpage
                               RN               r11         ;=CPU_RAM
  603 00000000        C 
                       addy    RN               r12         ;//keep this at r12
                                                             (´ÓÍ· APCS) //addr
                                                              :´ú±í8Î»µØÖ· 
  604 00000000         ;r13=SP
  605 00000000         ;r14=LR
  606 00000000         ;r15=PC
  607 00000000         ;---------------------------------------------------
  608 00000000         
  609 00000000         
  610 00000000         _00                                  ;   BRK
  611 00000000         ;-------------------------------------------------------
                       ---------------------
  612 00000000         
  613 00000000 F8DA 0084       ldr              r0,lastbank ;   6502PC´Ó ROMµÄ×
                                                            îºóÆ«ÒÆÁ¿
  614 00000004 EBA9 0100       sub              r1,m6502_pc,r0
  615 00000008 F101 0001       add              r0,r1,#1
  616 0000000C                 push16                       ;save PC
  217 0000000C EA4F 2110       mov              r1,r0,lsr#8
  218 00000010 F8DA 2080       ldr              r2,m6502_s
  219 00000014 F802 1901       strb             r1,[r2],#-1
  220 00000018 F442 7280       orr              r2,r2,#0x100
  221 0000001C F802 0901       strb             r0,[r2],#-1
  222 00000020 F88A 2080       strb             r2,m6502_s
  617 00000024         



ARM Macro Assembler    Page 15 


  618 00000024                 encodeP          (B+R)       ;save P
   51 00000024 F008 004D       and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   52 00000028 F013 4F00       tst              m6502_nz,#0x80000000 ;//PSR_N
   53 0000002C BF18 F040 
              0080             orrne            r0,r0,#N    ;N
   54 00000032 F013 0FFF       tst              m6502_nz,#0xff
   55 00000036 BF08 F040 
              0002             orreq            r0,r0,#Z    ;Z
   56 0000003C F040 0030       orr              r0,r0,#(B+R) ;R(&B)
  619 00000040         
  620 00000040 F64F 7CFE       ldr              r12,=IRQ_VECTOR
  621 00000044 F7FF FFFE       bl               VecCont
  622 00000048         
  623 00000048                 fetch            7
   70 00000048         ;//-----------------------------------------------------
                       ----------------
   71 00000048 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000004C F100 0007       add              r0,r0,#7
   73 00000050 F8CA 00A0       str              r0,clocksh
   74 00000054         
   75 00000054 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000058         ;//-----------------------------------------------------
                       --------------------
   77 00000058 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000005C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000062         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000062 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000066 F8DA F088       ldr              pc,nexttimeout
  624 0000006A                 LTORG                        ;Ö¸Áî£¬ LTORG¿ÉÄÜÊÇ
                                                            ÔÚÒ»¸ö¿ÉÖ´ÐÐµÄÎ»ÖÃ
  625 0000006A         ;-------------------------------------------------------
                       ---------------------
  626 0000006A         _01                                  ;   ORA ($nn,X)
  627 0000006A         ;-------------------------------------------------------
                       ---------------------
  628 0000006A                 doIIX
  299 0000006A 00000004 
                       _type   SETA             _ABS
  300 0000006A F819 0B01       ldrb             r0,[m6502_pc],#1
  301 0000006E EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00000072         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00000072 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00000076 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 0000007A         
  306 0000007A F100 7080       add              r0,r0,#0x01000000
  307 0000007E         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»



ARM Macro Assembler    Page 16 


  308 0000007E EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00000082 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00000086         
  311 00000086 EA4C 2C01       orr              addy,addy,r1,lsl#8
  629 0000008A                 opORA
  493 0000008A                 readmem
  146 0000008A                 [                _type = _ABS
  147 0000008A                 readmemabs
  107 0000008A F40C 4160       and              r1,addy,#0xE000
  108 0000008E F20F 0E0A       adr              lr,%F0
  109 00000092         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000092 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000096 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000009A         
  113 0000009A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000009A                 ]
  149 0000009A                 [                _type = _ZP
  151                          ]
  152 0000009A                 [                _type = _ZPI
  154                          ]
  155 0000009A                 [                _type = _IMM
  157                          ]
  494 0000009A EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 0000009E EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  630 000000A2                 fetch            6
   70 000000A2         ;//-----------------------------------------------------
                       ----------------
   71 000000A2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000000A6 F100 0006       add              r0,r0,#6
   73 000000AA F8CA 00A0       str              r0,clocksh
   74 000000AE         
   75 000000AE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000000B2         ;//-----------------------------------------------------
                       --------------------
   77 000000B2 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000000B6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000000BC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000000BC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000000C0 F8DA F088       ldr              pc,nexttimeout
  631 000000C4         ;-------------------------------------------------------
                       ---------------------
  632 000000C4         _05                                  ;   ORA $nn
  633 000000C4         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 17 


  634 000000C4                 doZ
  346 000000C4 00000002 
                       _type   SETA             _ZP
  347 000000C4 F819 CB01       ldrb             addy,[m6502_pc],#1
  635 000000C8                 opORA
  493 000000C8                 readmem
  146 000000C8                 [                _type = _ABS
  148                          ]
  149 000000C8                 [                _type = _ZP
  150 000000C8                 readmemzp
  118 000000C8 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 000000CC                 ]
  152 000000CC                 [                _type = _ZPI
  154                          ]
  155 000000CC                 [                _type = _IMM
  157                          ]
  494 000000CC EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 000000D0 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  636 000000D4                 fetch            3
   70 000000D4         ;//-----------------------------------------------------
                       ----------------
   71 000000D4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000000D8 F100 0003       add              r0,r0,#3
   73 000000DC F8CA 00A0       str              r0,clocksh
   74 000000E0         
   75 000000E0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000000E4         ;//-----------------------------------------------------
                       --------------------
   77 000000E4 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000000E8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000000EE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000000EE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000000F2 F8DA F088       ldr              pc,nexttimeout
  637 000000F6         ;-------------------------------------------------------
                       ---------------------
  638 000000F6         _06                                  ;   ASL $nn
  639 000000F6         ;-------------------------------------------------------
                       ---------------------
  640 000000F6                 doZ
  346 000000F6 00000002 
                       _type   SETA             _ZP
  347 000000F6 F819 CB01       ldrb             addy,[m6502_pc],#1
  641 000000FA                 opASL
  408 000000FA                 readmem
  146 000000FA                 [                _type = _ABS
  148                          ]
  149 000000FA                 [                _type = _ZP
  150 000000FA                 readmemzp
  118 000000FA F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 000000FE                 ]



ARM Macro Assembler    Page 18 


  152 000000FE                 [                _type = _ZPI
  154                          ]
  155 000000FE                 [                _type = _IMM
  157                          ]
  409 000000FE 4400            add              r0,r0,r0
  410 00000100 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  411 00000104 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  412 00000108                 writemem
  203 00000108                 [                _type = _ABS
  205                          ]
  206 00000108                 [                _type = _ZP
  207 00000108                 writememzp
  189 00000108 F80B 000C       strb             r0,[cpu_zpage,addy]
  208 0000010C                 ]
  209 0000010C                 [                _type = _ZPI
  211                          ]
  642 0000010C                 fetch_c          5
   86 0000010C         ;//-----------------------------------------------------
                       ----------------
   87 0000010C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000110 F100 0005       add              r0,r0,#5
   89 00000114 F8CA 00A0       str              r0,clocksh
   90 00000118         
   91 00000118 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000011C         ;//-----------------------------------------------------
                       --------------------
   93 0000011C F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   94 00000120 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000126         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000126 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 0000012A F8DA F088       ldr              pc,nexttimeout
  643 0000012E         ;-------------------------------------------------------
                       ---------------------
  644 0000012E         _08                                  ;   PHP
  645 0000012E         ;-------------------------------------------------------
                       ---------------------
  646 0000012E                 encodeP          (B+R)
   51 0000012E F008 004D       and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   52 00000132 F013 4F00       tst              m6502_nz,#0x80000000 ;//PSR_N
   53 00000136 BF18 F040 
              0080             orrne            r0,r0,#N    ;N
   54 0000013C F013 0FFF       tst              m6502_nz,#0xff
   55 00000140 BF08 F040 
              0002             orreq            r0,r0,#Z    ;Z
   56 00000146 F040 0030       orr              r0,r0,#(B+R) ;R(&B)
  647 0000014A                 push8            r0
  227 0000014A F8DA 2080       ldr              r2,m6502_s
  228 0000014E F802 0901       strb             r0,[r2],#-1
  229 00000152 F88A 2080       strb             r2,m6502_s
  648 00000156                 fetch            3
   70 00000156         ;//-----------------------------------------------------
                       ----------------
   71 00000156 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 19 


                                                            ÓÊý
   72 0000015A F100 0003       add              r0,r0,#3
   73 0000015E F8CA 00A0       str              r0,clocksh
   74 00000162         
   75 00000162 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000166         ;//-----------------------------------------------------
                       --------------------
   77 00000166 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000016A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000170         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000170 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000174 F8DA F088       ldr              pc,nexttimeout
  649 00000178         ;-------------------------------------------------------
                       ---------------------
  650 00000178         _09                                  ;   ORA #$nn
  651 00000178         ;-------------------------------------------------------
                       ---------------------
  652 00000178                 doIMM
  294 00000178 00000001 
                       _type   SETA             _IMM
  653 00000178                 opORA
  493 00000178                 readmem
  146 00000178                 [                _type = _ABS
  148                          ]
  149 00000178                 [                _type = _ZP
  151                          ]
  152 00000178                 [                _type = _ZPI
  154                          ]
  155 00000178                 [                _type = _IMM
  156 00000178                 readmemimm
  136 00000178 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 0000017C                 ]
  494 0000017C EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 00000180 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  654 00000184                 fetch            2
   70 00000184         ;//-----------------------------------------------------
                       ----------------
   71 00000184 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000188 F100 0002       add              r0,r0,#2
   73 0000018C F8CA 00A0       str              r0,clocksh
   74 00000190         
   75 00000190 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000194         ;//-----------------------------------------------------
                       --------------------
   77 00000194 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000198 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ



ARM Macro Assembler    Page 20 


                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000019E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000019E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000001A2 F8DA F088       ldr              pc,nexttimeout
  655 000001A6         ;-------------------------------------------------------
                       ---------------------
  656 000001A6         _0A                                  ;   ASL
  657 000001A6         ;-------------------------------------------------------
                       ---------------------
  658 000001A6 196D            adds             m6502_a,m6502_a,m6502_a
  659 000001A8 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  660 000001AC F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  661 000001B0                 fetch_c          2           ;also subs carry
   86 000001B0         ;//-----------------------------------------------------
                       ----------------
   87 000001B0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 000001B4 F100 0002       add              r0,r0,#2
   89 000001B8 F8CA 00A0       str              r0,clocksh
   90 000001BC         
   91 000001BC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000001C0         ;//-----------------------------------------------------
                       --------------------
   93 000001C0 F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 000001C4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000001CA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000001CA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000001CE F8DA F088       ldr              pc,nexttimeout
  662 000001D2         ;-------------------------------------------------------
                       ---------------------
  663 000001D2         _0D                                  ;   ORA $nnnn
  664 000001D2         ;-------------------------------------------------------
                       ---------------------
  665 000001D2                 doABS
  266 000001D2 00000004 
                       _type   SETA             _ABS
  267 000001D2 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000001D6 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000001DA EA4C 2C00       orr              addy,addy,r0,lsl#8
  666 000001DE                 opORA
  493 000001DE                 readmem
  146 000001DE                 [                _type = _ABS
  147 000001DE                 readmemabs
  107 000001DE F40C 4160       and              r1,addy,#0xE000
  108 000001E2 F20F 0E0A       adr              lr,%F0
  109 000001E6         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000001E6 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000001EA F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000001EE         
  113 000001EE         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 21 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000001EE                 ]
  149 000001EE                 [                _type = _ZP
  151                          ]
  152 000001EE                 [                _type = _ZPI
  154                          ]
  155 000001EE                 [                _type = _IMM
  157                          ]
  494 000001EE EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 000001F2 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  667 000001F6                 fetch            4
   70 000001F6         ;//-----------------------------------------------------
                       ----------------
   71 000001F6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000001FA F100 0004       add              r0,r0,#4
   73 000001FE F8CA 00A0       str              r0,clocksh
   74 00000202         
   75 00000202 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000206         ;//-----------------------------------------------------
                       --------------------
   77 00000206 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000020A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000210         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000210 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000214 F8DA F088       ldr              pc,nexttimeout
  668 00000218         ;-------------------------------------------------------
                       ---------------------
  669 00000218         _0E                                  ;   ASL $nnnn
  670 00000218         ;-------------------------------------------------------
                       ---------------------
  671 00000218                 doABS
  266 00000218 00000004 
                       _type   SETA             _ABS
  267 00000218 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 0000021C F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00000220 EA4C 2C00       orr              addy,addy,r0,lsl#8
  672 00000224                 opASL
  408 00000224                 readmem
  146 00000224                 [                _type = _ABS
  147 00000224                 readmemabs
  107 00000224 F40C 4160       and              r1,addy,#0xE000
  108 00000228 F20F 0E08       adr              lr,%F0
  109 0000022C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000022C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000230 F854 F001       ldr              pc,[m6502_rmem,r1]



ARM Macro Assembler    Page 22 


  112 00000234         
  113 00000234         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000234                 ]
  149 00000234                 [                _type = _ZP
  151                          ]
  152 00000234                 [                _type = _ZPI
  154                          ]
  155 00000234                 [                _type = _IMM
  157                          ]
  409 00000234 4400            add              r0,r0,r0
  410 00000236 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  411 0000023A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  412 0000023E                 writemem
  203 0000023E                 [                _type = _ABS
  204 0000023E                 writememabs
  177 0000023E F40C 4160       and              r1,addy,#0xe000
  178 00000242 F10A 0224       adr              r2,writemem_tbl
  179 00000246 F20F 0E0A       adr              lr,%F0
  180 0000024A         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 0000024A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 0000024E F852 F001       ldr              pc,[r2,r1]
  183 00000252         
  184 00000252         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00000252                 ]
  206 00000252                 [                _type = _ZP
  208                          ]
  209 00000252                 [                _type = _ZPI
  211                          ]
  673 00000252                 fetch_c          6
   86 00000252         ;//-----------------------------------------------------
                       ----------------
   87 00000252 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000256 F100 0006       add              r0,r0,#6
   89 0000025A F8CA 00A0       str              r0,clocksh
   90 0000025E         
   91 0000025E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000262         ;//-----------------------------------------------------
                       --------------------
   93 00000262 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 00000266 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 0000026C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 0000026C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000270 F8DA F088       ldr              pc,nexttimeout
  674 00000274         ;-------------------------------------------------------
                       ---------------------  
  675 00000274         _10                                  ;   BPL *
  676 00000274         ;-------------------------------------------------------



ARM Macro Assembler    Page 23 


                       ---------------------
  677 00000274 F013 4F00       tst              m6502_nz,#0x80000000
  678 00000278 F919 0B01       ldrsb            r0,[m6502_pc],#1
  679 0000027C BF04 4481       addeq            m6502_pc,m6502_pc,r0
  680 00000280         ; subeq cycles,cycles,#3*CYCLE
  681 00000280 F5A8 7880       subeq            cycles,cycles,#256
  682 00000284                 fetch            2
   70 00000284         ;//-----------------------------------------------------
                       ----------------
   71 00000284 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000288 F100 0002       add              r0,r0,#2
   73 0000028C F8CA 00A0       str              r0,clocksh
   74 00000290         
   75 00000290 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000294         ;//-----------------------------------------------------
                       --------------------
   77 00000294 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000298 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000029E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000029E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000002A2 F8DA F088       ldr              pc,nexttimeout
  683 000002A6         ;-------------------------------------------------------
                       ---------------------
  684 000002A6         _11                                  ;   ORA ($nn),Y
  685 000002A6         ;-------------------------------------------------------
                       ---------------------
  686 000002A6                 doIIY
  316 000002A6 00000004 
                       _type   SETA             _ABS
  317 000002A6 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 000002AA         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 000002AA         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 000002AA F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 000002AE 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 000002B0         
  323 000002B0         
  324 000002B0 7841            ldrb             r1,[r0,#1]
  325 000002B2 EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 000002B6 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 000002BA         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  687 000002BA                 opORA
  493 000002BA                 readmem
  146 000002BA                 [                _type = _ABS
  147 000002BA                 readmemabs
  107 000002BA F40C 4160       and              r1,addy,#0xE000
  108 000002BE F20F 0E0A       adr              lr,%F0
  109 000002C2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x



ARM Macro Assembler    Page 24 


                       E000 (for rom_R)
  110 000002C2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000002C6 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000002CA         
  113 000002CA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000002CA                 ]
  149 000002CA                 [                _type = _ZP
  151                          ]
  152 000002CA                 [                _type = _ZPI
  154                          ]
  155 000002CA                 [                _type = _IMM
  157                          ]
  494 000002CA EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 000002CE EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  688 000002D2                 fetch            5
   70 000002D2         ;//-----------------------------------------------------
                       ----------------
   71 000002D2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000002D6 F100 0005       add              r0,r0,#5
   73 000002DA F8CA 00A0       str              r0,clocksh
   74 000002DE         
   75 000002DE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000002E2         ;//-----------------------------------------------------
                       --------------------
   77 000002E2 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000002E6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000002EC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000002EC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000002F0 F8DA F088       ldr              pc,nexttimeout
  689 000002F4         ;-------------------------------------------------------
                       ---------------------
  690 000002F4         _15                                  ;   ORA $nn,X
  691 000002F4         ;-------------------------------------------------------
                       ---------------------
  692 000002F4                 doZIXf
  366 000002F4 00000003 
                       _type   SETA             _ZPI
  367 000002F4 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 000002F8 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  693 000002FC                 opORA
  493 000002FC                 readmem
  146 000002FC                 [                _type = _ABS
  148                          ]
  149 000002FC                 [                _type = _ZP
  151                          ]



ARM Macro Assembler    Page 25 


  152 000002FC                 [                _type = _ZPI
  153 000002FC                 readmemzpi
  123 000002FC         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 000002FC EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 00000300 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00000304         
  154 00000304                 ]
  155 00000304                 [                _type = _IMM
  157                          ]
  494 00000304 EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 00000308 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  694 0000030C                 fetch            4
   70 0000030C         ;//-----------------------------------------------------
                       ----------------
   71 0000030C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000310 F100 0004       add              r0,r0,#4
   73 00000314 F8CA 00A0       str              r0,clocksh
   74 00000318         
   75 00000318 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000031C         ;//-----------------------------------------------------
                       --------------------
   77 0000031C F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000320 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000326         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000326 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000032A F8DA F088       ldr              pc,nexttimeout
  695 0000032E         ;-------------------------------------------------------
                       ---------------------
  696 0000032E         _16                                  ;   ASL $nn,X
  697 0000032E         ;-------------------------------------------------------
                       ---------------------
  698 0000032E                 doZIXf
  366 0000032E 00000003 
                       _type   SETA             _ZPI
  367 0000032E F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00000332 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  699 00000336                 opASL
  408 00000336                 readmem
  146 00000336                 [                _type = _ABS
  148                          ]
  149 00000336                 [                _type = _ZP
  151                          ]
  152 00000336                 [                _type = _ZPI
  153 00000336                 readmemzpi
  123 00000336         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 00000336 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 0000033A F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 0000033E         
  154 0000033E                 ]
  155 0000033E                 [                _type = _IMM



ARM Macro Assembler    Page 26 


  157                          ]
  409 0000033E 4400            add              r0,r0,r0
  410 00000340 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  411 00000344 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  412 00000348                 writemem
  203 00000348                 [                _type = _ABS
  205                          ]
  206 00000348                 [                _type = _ZP
  208                          ]
  209 00000348                 [                _type = _ZPI
  210 00000348                 writememzpi
  194 00000348         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 00000348 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 0000034C F80B 0001       strb             r0,[cpu_zpage,r1]
  197 00000350         
  198 00000350         
  211 00000350                 ]
  700 00000350                 fetch_c          6
   86 00000350         ;//-----------------------------------------------------
                       ----------------
   87 00000350 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000354 F100 0006       add              r0,r0,#6
   89 00000358 F8CA 00A0       str              r0,clocksh
   90 0000035C         
   91 0000035C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000360         ;//-----------------------------------------------------
                       --------------------
   93 00000360 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 00000364 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 0000036A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 0000036A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 0000036E F8DA F088       ldr              pc,nexttimeout
  701 00000372         ;-------------------------------------------------------
                       ---------------------
  702 00000372         _18                                  ;   CLC
  703 00000372         ;-------------------------------------------------------
                       ---------------------
  704 00000372 F028 0801       bic              cycles,cycles,#CYC_C
  705 00000376                 fetch            2
   70 00000376         ;//-----------------------------------------------------
                       ----------------
   71 00000376 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000037A F100 0002       add              r0,r0,#2
   73 0000037E F8CA 00A0       str              r0,clocksh
   74 00000382         
   75 00000382 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000386         ;//-----------------------------------------------------
                       --------------------
   77 00000386 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  



ARM Macro Assembler    Page 27 


   78 0000038A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000390         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000390 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000394 F8DA F088       ldr              pc,nexttimeout
  706 00000398         ;-------------------------------------------------------
                       ---------------------
  707 00000398         _19                                  ;   ORA $nnnn,Y
  708 00000398         ;-------------------------------------------------------
                       ---------------------
  709 00000398                 doAIY
  284 00000398 00000004 
                       _type   SETA             _ABS
  285 00000398 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 0000039C F819 0B01       ldrb             r0,[m6502_pc],#1
  287 000003A0 EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 000003A4 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 000003A8         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  710 000003A8                 opORA
  493 000003A8                 readmem
  146 000003A8                 [                _type = _ABS
  147 000003A8                 readmemabs
  107 000003A8 F40C 4160       and              r1,addy,#0xE000
  108 000003AC F20F 0E08       adr              lr,%F0
  109 000003B0         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000003B0 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000003B4 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000003B8         
  113 000003B8         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000003B8                 ]
  149 000003B8                 [                _type = _ZP
  151                          ]
  152 000003B8                 [                _type = _ZPI
  154                          ]
  155 000003B8                 [                _type = _IMM
  157                          ]
  494 000003B8 EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 000003BC EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  711 000003C0                 fetch            4
   70 000003C0         ;//-----------------------------------------------------
                       ----------------
   71 000003C0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000003C4 F100 0004       add              r0,r0,#4
   73 000003C8 F8CA 00A0       str              r0,clocksh
   74 000003CC         
   75 000003CC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000003D0         ;//-----------------------------------------------------



ARM Macro Assembler    Page 28 


                       --------------------
   77 000003D0 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000003D4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000003DA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000003DA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000003DE F8DA F088       ldr              pc,nexttimeout
  712 000003E2         ;-------------------------------------------------------
                       ---------------------
  713 000003E2         _1D                                  ;   ORA $nnnn,X
  714 000003E2         ;-------------------------------------------------------
                       ---------------------
  715 000003E2                 doAIX
  274 000003E2 00000004 
                       _type   SETA             _ABS
  275 000003E2 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 000003E6 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 000003EA EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 000003EE EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 000003F2         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  716 000003F2                 opORA
  493 000003F2                 readmem
  146 000003F2                 [                _type = _ABS
  147 000003F2                 readmemabs
  107 000003F2 F40C 4160       and              r1,addy,#0xE000
  108 000003F6 F20F 0E0A       adr              lr,%F0
  109 000003FA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000003FA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000003FE F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000402         
  113 00000402         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000402                 ]
  149 00000402                 [                _type = _ZP
  151                          ]
  152 00000402                 [                _type = _ZPI
  154                          ]
  155 00000402                 [                _type = _IMM
  157                          ]
  494 00000402 EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  495 00000406 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  717 0000040A                 fetch            4
   70 0000040A         ;//-----------------------------------------------------
                       ----------------
   71 0000040A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000040E F100 0004       add              r0,r0,#4
   73 00000412 F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 29 


   74 00000416         
   75 00000416 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000041A         ;//-----------------------------------------------------
                       --------------------
   77 0000041A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000041E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000424         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000424 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000428 F8DA F088       ldr              pc,nexttimeout
  718 0000042C         ;-------------------------------------------------------
                       ---------------------
  719 0000042C         _1E                                  ;   ASL $nnnn,X
  720 0000042C         ;-------------------------------------------------------
                       ---------------------
  721 0000042C                 doAIX
  274 0000042C 00000004 
                       _type   SETA             _ABS
  275 0000042C F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00000430 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00000434 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00000438 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 0000043C         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  722 0000043C                 opASL
  408 0000043C                 readmem
  146 0000043C                 [                _type = _ABS
  147 0000043C                 readmemabs
  107 0000043C F40C 4160       and              r1,addy,#0xE000
  108 00000440 F20F 0E08       adr              lr,%F0
  109 00000444         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000444 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000448 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000044C         
  113 0000044C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000044C                 ]
  149 0000044C                 [                _type = _ZP
  151                          ]
  152 0000044C                 [                _type = _ZPI
  154                          ]
  155 0000044C                 [                _type = _IMM
  157                          ]
  409 0000044C 4400            add              r0,r0,r0
  410 0000044E EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  411 00000452 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  412 00000456                 writemem



ARM Macro Assembler    Page 30 


  203 00000456                 [                _type = _ABS
  204 00000456                 writememabs
  177 00000456 F40C 4160       and              r1,addy,#0xe000
  178 0000045A F10A 0224       adr              r2,writemem_tbl
  179 0000045E F20F 0E0A       adr              lr,%F0
  180 00000462         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00000462 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00000466 F852 F001       ldr              pc,[r2,r1]
  183 0000046A         
  184 0000046A         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 0000046A                 ]
  206 0000046A                 [                _type = _ZP
  208                          ]
  209 0000046A                 [                _type = _ZPI
  211                          ]
  723 0000046A                 fetch_c          7
   86 0000046A         ;//-----------------------------------------------------
                       ----------------
   87 0000046A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 0000046E F100 0007       add              r0,r0,#7
   89 00000472 F8CA 00A0       str              r0,clocksh
   90 00000476         
   91 00000476 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000047A         ;//-----------------------------------------------------
                       --------------------
   93 0000047A F578 68E0       sbcs             cycles,cycles,#7*256 
                                                            ;//CYCLE=256
   94 0000047E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000484         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000484 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000488 F8DA F088       ldr              pc,nexttimeout
  724 0000048C         ;-------------------------------------------------------
                       ---------------------
  725 0000048C         _20                                  ;   JSR $nnnn
  726 0000048C         ;-------------------------------------------------------
                       ---------------------
  727 0000048C F819 2B01       ldrb             r2,[m6502_pc],#1
  728 00000490 F8DA 1084       ldr              r1,lastbank
  729 00000494 EBA9 0001       sub              r0,m6502_pc,r1
  730 00000498 F899 1000       ldrb             r1,[m6502_pc]
  731 0000049C EA42 2901       orr              m6502_pc,r2,r1,lsl#8
  732 000004A0                 push16
  217 000004A0 EA4F 2110       mov              r1,r0,lsr#8
  218 000004A4 F8DA 2080       ldr              r2,m6502_s
  219 000004A8 F802 1901       strb             r1,[r2],#-1
  220 000004AC F442 7280       orr              r2,r2,#0x100
  221 000004B0 F802 0901       strb             r0,[r2],#-1
  222 000004B4 F88A 2080       strb             r2,m6502_s
  733 000004B8                 encodePC
   39 000004B8 F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 000004BC F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2



ARM Macro Assembler    Page 31 


   41 000004C0         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 000004C0 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 000004C4 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 000004C6         
   45 000004C6 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 000004CA 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  734 000004CC                 fetch            6
   70 000004CC         ;//-----------------------------------------------------
                       ----------------
   71 000004CC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000004D0 F100 0006       add              r0,r0,#6
   73 000004D4 F8CA 00A0       str              r0,clocksh
   74 000004D8         
   75 000004D8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000004DC         ;//-----------------------------------------------------
                       --------------------
   77 000004DC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000004E0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000004E6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000004E6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000004EA F8DA F088       ldr              pc,nexttimeout
  735 000004EE         ;-------------------------------------------------------
                       ---------------------
  736 000004EE         _21                                  ;   AND ($nn,X)
  737 000004EE         ;-------------------------------------------------------
                       ---------------------
  738 000004EE                 doIIX
  299 000004EE 00000004 
                       _type   SETA             _ABS
  300 000004EE F819 0B01       ldrb             r0,[m6502_pc],#1
  301 000004F2 EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 000004F6         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 000004F6 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 000004FA F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 000004FE         
  306 000004FE F100 7080       add              r0,r0,#0x01000000
  307 00000502         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00000502 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00000506 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 0000050A         
  311 0000050A EA4C 2C01       orr              addy,addy,r1,lsl#8
  739 0000050E                 opAND
  401 0000050E                 readmem



ARM Macro Assembler    Page 32 


  146 0000050E                 [                _type = _ABS
  147 0000050E                 readmemabs
  107 0000050E F40C 4160       and              r1,addy,#0xE000
  108 00000512 F20F 0E0A       adr              lr,%F0
  109 00000516         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000516 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 0000051A F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000051E         
  113 0000051E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000051E                 ]
  149 0000051E                 [                _type = _ZP
  151                          ]
  152 0000051E                 [                _type = _ZPI
  154                          ]
  155 0000051E                 [                _type = _IMM
  157                          ]
  402 0000051E EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 00000522 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  740 00000526                 fetch            6
   70 00000526         ;//-----------------------------------------------------
                       ----------------
   71 00000526 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000052A F100 0006       add              r0,r0,#6
   73 0000052E F8CA 00A0       str              r0,clocksh
   74 00000532         
   75 00000532 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000536         ;//-----------------------------------------------------
                       --------------------
   77 00000536 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000053A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000540         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000540 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000544 F8DA F088       ldr              pc,nexttimeout
  741 00000548         ;-------------------------------------------------------
                       ---------------------
  742 00000548         _24                                  ;   BIT $nn
  743 00000548         ;-------------------------------------------------------
                       ---------------------
  744 00000548                 doZ
  346 00000548 00000002 
                       _type   SETA             _ZP
  347 00000548 F819 CB01       ldrb             addy,[m6502_pc],#1
  745 0000054C                 opBIT
  417 0000054C                 readmem



ARM Macro Assembler    Page 33 


  146 0000054C                 [                _type = _ABS
  148                          ]
  149 0000054C                 [                _type = _ZP
  150 0000054C                 readmemzp
  118 0000054C F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00000550                 ]
  152 00000550                 [                _type = _ZPI
  154                          ]
  155 00000550                 [                _type = _IMM
  157                          ]
  418 00000550 F028 0840       bic              cycles,cycles,#CYC_V ;reset V
  419 00000554 F010 0F40       tst              r0,#V
  420 00000558 BF18 F048 
              0840             orrne            cycles,cycles,#CYC_V ;V
  421 0000055E EA00 6315       and              m6502_nz,r0,m6502_a,lsr#24 ;Z
  422 00000562 EA43 6300       orr              m6502_nz,m6502_nz,r0,lsl#24 ;N
  746 00000566                 fetch            3
   70 00000566         ;//-----------------------------------------------------
                       ----------------
   71 00000566 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000056A F100 0003       add              r0,r0,#3
   73 0000056E F8CA 00A0       str              r0,clocksh
   74 00000572         
   75 00000572 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000576         ;//-----------------------------------------------------
                       --------------------
   77 00000576 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000057A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000580         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000580 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000584 F8DA F088       ldr              pc,nexttimeout
  747 00000588         ;-------------------------------------------------------
                       ---------------------
  748 00000588         _25                                  ;   AND $nn
  749 00000588         ;-------------------------------------------------------
                       ---------------------
  750 00000588                 doZ
  346 00000588 00000002 
                       _type   SETA             _ZP
  347 00000588 F819 CB01       ldrb             addy,[m6502_pc],#1
  751 0000058C                 opAND
  401 0000058C                 readmem
  146 0000058C                 [                _type = _ABS
  148                          ]
  149 0000058C                 [                _type = _ZP
  150 0000058C                 readmemzp
  118 0000058C F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00000590                 ]
  152 00000590                 [                _type = _ZPI
  154                          ]



ARM Macro Assembler    Page 34 


  155 00000590                 [                _type = _IMM
  157                          ]
  402 00000590 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 00000594 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  752 00000598                 fetch            3
   70 00000598         ;//-----------------------------------------------------
                       ----------------
   71 00000598 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000059C F100 0003       add              r0,r0,#3
   73 000005A0 F8CA 00A0       str              r0,clocksh
   74 000005A4         
   75 000005A4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000005A8         ;//-----------------------------------------------------
                       --------------------
   77 000005A8 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000005AC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000005B2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000005B2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000005B6 F8DA F088       ldr              pc,nexttimeout
  753 000005BA         ;-------------------------------------------------------
                       ---------------------
  754 000005BA         _26                                  ;   ROL $nn
  755 000005BA         ;-------------------------------------------------------
                       ---------------------
  756 000005BA                 doZ
  346 000005BA 00000002 
                       _type   SETA             _ZP
  347 000005BA F819 CB01       ldrb             addy,[m6502_pc],#1
  757 000005BE                 opROL
  500 000005BE                 readmem
  146 000005BE                 [                _type = _ABS
  148                          ]
  149 000005BE                 [                _type = _ZP
  150 000005BE                 readmemzp
  118 000005BE F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 000005C2                 ]
  152 000005C2                 [                _type = _ZPI
  154                          ]
  155 000005C2                 [                _type = _IMM
  157                          ]
  501 000005C2 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  502 000005C6 EB40 0000       adc              r0,r0,r0
  503 000005CA EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  504 000005CE EB48 0808       adc              cycles,cycles,cycles ;Set C
  505 000005D2                 writemem
  203 000005D2                 [                _type = _ABS
  205                          ]
  206 000005D2                 [                _type = _ZP
  207 000005D2                 writememzp
  189 000005D2 F80B 000C       strb             r0,[cpu_zpage,addy]



ARM Macro Assembler    Page 35 


  208 000005D6                 ]
  209 000005D6                 [                _type = _ZPI
  211                          ]
  758 000005D6                 fetch            5
   70 000005D6         ;//-----------------------------------------------------
                       ----------------
   71 000005D6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000005DA F100 0005       add              r0,r0,#5
   73 000005DE F8CA 00A0       str              r0,clocksh
   74 000005E2         
   75 000005E2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000005E6         ;//-----------------------------------------------------
                       --------------------
   77 000005E6 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000005EA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000005F0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000005F0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000005F4 F8DA F088       ldr              pc,nexttimeout
  759 000005F8         ;-------------------------------------------------------
                       ---------------------
  760 000005F8         _28                                  ;   PLP
  761 000005F8         ;-------------------------------------------------------
                       ---------------------
  762 000005F8                 pop8             r0
  246 000005F8 F89A 2080       ldrb             r2,m6502_s
  247 000005FC F102 0201       add              r2,r2,#1
  248 00000600 F88A 2080       strb             r2,m6502_s
  249 00000604 F442 7280       orr              r2,r2,#0x100
  250 00000608 F91B 0002       ldrsb            r0,[cpu_zpage,r2] ;signed for P
                                                            LA & PLP
  251 0000060C         
  763 0000060C                 decodeP
   61 0000060C F028 084D       bic              cycles,cycles,#CYC_V+CYC_D+CYC_
I+CYC_C
   62 00000610 F000 014D       and              r1,r0,#V+D+I+C
   63 00000614 EA48 0801       orr              cycles,cycles,r1 ;//VDIC
   64 00000618 F020 03FD       bic              m6502_nz,r0,#0xFD 
                                                            ;//r0 is signed
   65 0000061C F083 0302       eor              m6502_nz,m6502_nz,#Z
  764 00000620                 fetch            4
   70 00000620         ;//-----------------------------------------------------
                       ----------------
   71 00000620 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000624 F100 0004       add              r0,r0,#4
   73 00000628 F8CA 00A0       str              r0,clocksh
   74 0000062C         
   75 0000062C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000630         ;//-----------------------------------------------------



ARM Macro Assembler    Page 36 


                       --------------------
   77 00000630 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000634 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000063A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000063A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000063E F8DA F088       ldr              pc,nexttimeout
  765 00000642         ;-------------------------------------------------------
                       ---------------------
  766 00000642         _29                                  ;   AND #$nn
  767 00000642         ;-------------------------------------------------------
                       ---------------------
  768 00000642                 doIMM
  294 00000642 00000001 
                       _type   SETA             _IMM
  769 00000642                 opAND
  401 00000642                 readmem
  146 00000642                 [                _type = _ABS
  148                          ]
  149 00000642                 [                _type = _ZP
  151                          ]
  152 00000642                 [                _type = _ZPI
  154                          ]
  155 00000642                 [                _type = _IMM
  156 00000642                 readmemimm
  136 00000642 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 00000646                 ]
  402 00000646 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 0000064A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  770 0000064E                 fetch            2
   70 0000064E         ;//-----------------------------------------------------
                       ----------------
   71 0000064E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000652 F100 0002       add              r0,r0,#2
   73 00000656 F8CA 00A0       str              r0,clocksh
   74 0000065A         
   75 0000065A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000065E         ;//-----------------------------------------------------
                       --------------------
   77 0000065E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000662 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000668         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000668 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000066C F8DA F088       ldr              pc,nexttimeout



ARM Macro Assembler    Page 37 


  771 00000670         ;-------------------------------------------------------
                       ---------------------
  772 00000670         _2A                                  ;   ROL
  773 00000670         ;-------------------------------------------------------
                       ---------------------
  774 00000670 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  775 00000674 BF28 F445 
              0500             orrcs            m6502_a,m6502_a,#0x00800000
  776 0000067A 196D            adds             m6502_a,m6502_a,m6502_a
  777 0000067C EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  778 00000680 EB48 0808       adc              cycles,cycles,cycles ;Set C
  779 00000684                 fetch            2
   70 00000684         ;//-----------------------------------------------------
                       ----------------
   71 00000684 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000688 F100 0002       add              r0,r0,#2
   73 0000068C F8CA 00A0       str              r0,clocksh
   74 00000690         
   75 00000690 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000694         ;//-----------------------------------------------------
                       --------------------
   77 00000694 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000698 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000069E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000069E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000006A2 F8DA F088       ldr              pc,nexttimeout
  780 000006A6         ;-------------------------------------------------------
                       ---------------------
  781 000006A6         _2C                                  ;   BIT $nnnn
  782 000006A6         ;-------------------------------------------------------
                       ---------------------
  783 000006A6                 doABS
  266 000006A6 00000004 
                       _type   SETA             _ABS
  267 000006A6 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000006AA F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000006AE EA4C 2C00       orr              addy,addy,r0,lsl#8
  784 000006B2                 opBIT
  417 000006B2                 readmem
  146 000006B2                 [                _type = _ABS
  147 000006B2                 readmemabs
  107 000006B2 F40C 4160       and              r1,addy,#0xE000
  108 000006B6 F20F 0E0A       adr              lr,%F0
  109 000006BA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000006BA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000006BE F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000006C2         
  113 000006C2         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 38 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000006C2                 ]
  149 000006C2                 [                _type = _ZP
  151                          ]
  152 000006C2                 [                _type = _ZPI
  154                          ]
  155 000006C2                 [                _type = _IMM
  157                          ]
  418 000006C2 F028 0840       bic              cycles,cycles,#CYC_V ;reset V
  419 000006C6 F010 0F40       tst              r0,#V
  420 000006CA BF18 F048 
              0840             orrne            cycles,cycles,#CYC_V ;V
  421 000006D0 EA00 6315       and              m6502_nz,r0,m6502_a,lsr#24 ;Z
  422 000006D4 EA43 6300       orr              m6502_nz,m6502_nz,r0,lsl#24 ;N
  785 000006D8                 fetch            4
   70 000006D8         ;//-----------------------------------------------------
                       ----------------
   71 000006D8 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000006DC F100 0004       add              r0,r0,#4
   73 000006E0 F8CA 00A0       str              r0,clocksh
   74 000006E4         
   75 000006E4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000006E8         ;//-----------------------------------------------------
                       --------------------
   77 000006E8 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000006EC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000006F2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000006F2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000006F6 F8DA F088       ldr              pc,nexttimeout
  786 000006FA         ;-------------------------------------------------------
                       ---------------------
  787 000006FA         _2D                                  ;   AND $nnnn
  788 000006FA         ;-------------------------------------------------------
                       ---------------------
  789 000006FA                 doABS
  266 000006FA 00000004 
                       _type   SETA             _ABS
  267 000006FA F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000006FE F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00000702 EA4C 2C00       orr              addy,addy,r0,lsl#8
  790 00000706                 opAND
  401 00000706                 readmem
  146 00000706                 [                _type = _ABS
  147 00000706                 readmemabs
  107 00000706 F40C 4160       and              r1,addy,#0xE000
  108 0000070A F20F 0E0A       adr              lr,%F0
  109 0000070E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x



ARM Macro Assembler    Page 39 


                       E000 (for rom_R)
  110 0000070E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000712 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000716         
  113 00000716         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000716                 ]
  149 00000716                 [                _type = _ZP
  151                          ]
  152 00000716                 [                _type = _ZPI
  154                          ]
  155 00000716                 [                _type = _IMM
  157                          ]
  402 00000716 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 0000071A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  791 0000071E                 fetch            4
   70 0000071E         ;//-----------------------------------------------------
                       ----------------
   71 0000071E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000722 F100 0004       add              r0,r0,#4
   73 00000726 F8CA 00A0       str              r0,clocksh
   74 0000072A         
   75 0000072A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000072E         ;//-----------------------------------------------------
                       --------------------
   77 0000072E F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000732 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000738         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000738 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000073C F8DA F088       ldr              pc,nexttimeout
  792 00000740         ;-------------------------------------------------------
                       ---------------------
  793 00000740         _2E                                  ;   ROL $nnnn
  794 00000740         ;-------------------------------------------------------
                       ---------------------
  795 00000740                 doABS
  266 00000740 00000004 
                       _type   SETA             _ABS
  267 00000740 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00000744 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00000748 EA4C 2C00       orr              addy,addy,r0,lsl#8
  796 0000074C                 opROL
  500 0000074C                 readmem
  146 0000074C                 [                _type = _ABS
  147 0000074C                 readmemabs
  107 0000074C F40C 4160       and              r1,addy,#0xE000



ARM Macro Assembler    Page 40 


  108 00000750 F20F 0E08       adr              lr,%F0
  109 00000754         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000754 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000758 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000075C         
  113 0000075C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000075C                 ]
  149 0000075C                 [                _type = _ZP
  151                          ]
  152 0000075C                 [                _type = _ZPI
  154                          ]
  155 0000075C                 [                _type = _IMM
  157                          ]
  501 0000075C EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  502 00000760 EB40 0000       adc              r0,r0,r0
  503 00000764 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  504 00000768 EB48 0808       adc              cycles,cycles,cycles ;Set C
  505 0000076C                 writemem
  203 0000076C                 [                _type = _ABS
  204 0000076C                 writememabs
  177 0000076C F40C 4160       and              r1,addy,#0xe000
  178 00000770 F10A 0224       adr              r2,writemem_tbl
  179 00000774 F20F 0E08       adr              lr,%F0
  180 00000778         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00000778 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 0000077C F852 F001       ldr              pc,[r2,r1]
  183 00000780         
  184 00000780         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00000780                 ]
  206 00000780                 [                _type = _ZP
  208                          ]
  209 00000780                 [                _type = _ZPI
  211                          ]
  797 00000780                 fetch            6
   70 00000780         ;//-----------------------------------------------------
                       ----------------
   71 00000780 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000784 F100 0006       add              r0,r0,#6
   73 00000788 F8CA 00A0       str              r0,clocksh
   74 0000078C         
   75 0000078C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000790         ;//-----------------------------------------------------
                       --------------------
   77 00000790 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000794 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ



ARM Macro Assembler    Page 41 


                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000079A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000079A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000079E F8DA F088       ldr              pc,nexttimeout
  798 000007A2         ;-------------------------------------------------------
                       ---------------------
  799 000007A2         _30                                  ;   BMI *
  800 000007A2         ;-------------------------------------------------------
                       ---------------------
  801 000007A2 F013 4F00       tst              m6502_nz,#0x80000000
  802 000007A6 F919 0B01       ldrsb            r0,[m6502_pc],#1
  803 000007AA BF1C 4481       addne            m6502_pc,m6502_pc,r0
  804 000007AE         ; subne cycles,cycles,#3*CYCLE
  805 000007AE F5A8 7880       subne            cycles,cycles,#256
  806 000007B2                 fetch            2
   70 000007B2         ;//-----------------------------------------------------
                       ----------------
   71 000007B2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000007B6 F100 0002       add              r0,r0,#2
   73 000007BA F8CA 00A0       str              r0,clocksh
   74 000007BE         
   75 000007BE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000007C2         ;//-----------------------------------------------------
                       --------------------
   77 000007C2 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000007C6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000007CC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000007CC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000007D0 F8DA F088       ldr              pc,nexttimeout
  807 000007D4         ;-------------------------------------------------------
                       ---------------------
  808 000007D4         _31                                  ;   AND ($nn),Y
  809 000007D4         ;-------------------------------------------------------
                       ---------------------
  810 000007D4                 doIIY
  316 000007D4 00000004 
                       _type   SETA             _ABS
  317 000007D4 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 000007D8         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 000007D8         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 000007D8 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 000007DC 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 000007DE         
  323 000007DE         



ARM Macro Assembler    Page 42 


  324 000007DE 7841            ldrb             r1,[r0,#1]
  325 000007E0 EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 000007E4 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 000007E8         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  811 000007E8                 opAND
  401 000007E8                 readmem
  146 000007E8                 [                _type = _ABS
  147 000007E8                 readmemabs
  107 000007E8 F40C 4160       and              r1,addy,#0xE000
  108 000007EC F20F 0E08       adr              lr,%F0
  109 000007F0         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000007F0 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000007F4 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000007F8         
  113 000007F8         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000007F8                 ]
  149 000007F8                 [                _type = _ZP
  151                          ]
  152 000007F8                 [                _type = _ZPI
  154                          ]
  155 000007F8                 [                _type = _IMM
  157                          ]
  402 000007F8 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 000007FC EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  812 00000800                 fetch            5
   70 00000800         ;//-----------------------------------------------------
                       ----------------
   71 00000800 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000804 F100 0005       add              r0,r0,#5
   73 00000808 F8CA 00A0       str              r0,clocksh
   74 0000080C         
   75 0000080C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000810         ;//-----------------------------------------------------
                       --------------------
   77 00000810 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000814 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000081A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000081A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000081E F8DA F088       ldr              pc,nexttimeout
  813 00000822         ;-------------------------------------------------------
                       ---------------------
  814 00000822         _35                                  ;   AND $nn,X
  815 00000822         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 43 


  816 00000822                 doZIXf
  366 00000822 00000003 
                       _type   SETA             _ZPI
  367 00000822 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00000826 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  817 0000082A                 opAND
  401 0000082A                 readmem
  146 0000082A                 [                _type = _ABS
  148                          ]
  149 0000082A                 [                _type = _ZP
  151                          ]
  152 0000082A                 [                _type = _ZPI
  153 0000082A                 readmemzpi
  123 0000082A         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 0000082A EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 0000082E F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00000832         
  154 00000832                 ]
  155 00000832                 [                _type = _IMM
  157                          ]
  402 00000832 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 00000836 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  818 0000083A                 fetch            4
   70 0000083A         ;//-----------------------------------------------------
                       ----------------
   71 0000083A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000083E F100 0004       add              r0,r0,#4
   73 00000842 F8CA 00A0       str              r0,clocksh
   74 00000846         
   75 00000846 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000084A         ;//-----------------------------------------------------
                       --------------------
   77 0000084A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000084E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000854         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000854 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000858 F8DA F088       ldr              pc,nexttimeout
  819 0000085C         ;-------------------------------------------------------
                       ---------------------
  820 0000085C         _36                                  ;   ROL $nn,X
  821 0000085C         ;-------------------------------------------------------
                       ---------------------
  822 0000085C                 doZIXf
  366 0000085C 00000003 
                       _type   SETA             _ZPI
  367 0000085C F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00000860 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  823 00000864                 opROL
  500 00000864                 readmem
  146 00000864                 [                _type = _ABS



ARM Macro Assembler    Page 44 


  148                          ]
  149 00000864                 [                _type = _ZP
  151                          ]
  152 00000864                 [                _type = _ZPI
  153 00000864                 readmemzpi
  123 00000864         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 00000864 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 00000868 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 0000086C         
  154 0000086C                 ]
  155 0000086C                 [                _type = _IMM
  157                          ]
  501 0000086C EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  502 00000870 EB40 0000       adc              r0,r0,r0
  503 00000874 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  504 00000878 EB48 0808       adc              cycles,cycles,cycles ;Set C
  505 0000087C                 writemem
  203 0000087C                 [                _type = _ABS
  205                          ]
  206 0000087C                 [                _type = _ZP
  208                          ]
  209 0000087C                 [                _type = _ZPI
  210 0000087C                 writememzpi
  194 0000087C         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 0000087C EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 00000880 F80B 0001       strb             r0,[cpu_zpage,r1]
  197 00000884         
  198 00000884         
  211 00000884                 ]
  824 00000884                 fetch            6
   70 00000884         ;//-----------------------------------------------------
                       ----------------
   71 00000884 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000888 F100 0006       add              r0,r0,#6
   73 0000088C F8CA 00A0       str              r0,clocksh
   74 00000890         
   75 00000890 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000894         ;//-----------------------------------------------------
                       --------------------
   77 00000894 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000898 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000089E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000089E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000008A2 F8DA F088       ldr              pc,nexttimeout
  825 000008A6         ;-------------------------------------------------------
                       ---------------------
  826 000008A6         _38                                  ;   SEC
  827 000008A6         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 45 


  828 000008A6 F048 0801       orr              cycles,cycles,#CYC_C
  829 000008AA                 fetch            2
   70 000008AA         ;//-----------------------------------------------------
                       ----------------
   71 000008AA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000008AE F100 0002       add              r0,r0,#2
   73 000008B2 F8CA 00A0       str              r0,clocksh
   74 000008B6         
   75 000008B6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000008BA         ;//-----------------------------------------------------
                       --------------------
   77 000008BA F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000008BE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000008C4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000008C4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000008C8 F8DA F088       ldr              pc,nexttimeout
  830 000008CC         ;-------------------------------------------------------
                       ---------------------
  831 000008CC         _39                                  ;   AND $nnnn,Y
  832 000008CC         ;-------------------------------------------------------
                       ---------------------
  833 000008CC                 doAIY
  284 000008CC 00000004 
                       _type   SETA             _ABS
  285 000008CC F819 CB01       ldrb             addy,[m6502_pc],#1
  286 000008D0 F819 0B01       ldrb             r0,[m6502_pc],#1
  287 000008D4 EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 000008D8 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 000008DC         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  834 000008DC                 opAND
  401 000008DC                 readmem
  146 000008DC                 [                _type = _ABS
  147 000008DC                 readmemabs
  107 000008DC F40C 4160       and              r1,addy,#0xE000
  108 000008E0 F20F 0E08       adr              lr,%F0
  109 000008E4         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000008E4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000008E8 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000008EC         
  113 000008EC         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000008EC                 ]
  149 000008EC                 [                _type = _ZP
  151                          ]
  152 000008EC                 [                _type = _ZPI



ARM Macro Assembler    Page 46 


  154                          ]
  155 000008EC                 [                _type = _IMM
  157                          ]
  402 000008EC EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 000008F0 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  835 000008F4                 fetch            4
   70 000008F4         ;//-----------------------------------------------------
                       ----------------
   71 000008F4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000008F8 F100 0004       add              r0,r0,#4
   73 000008FC F8CA 00A0       str              r0,clocksh
   74 00000900         
   75 00000900 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000904         ;//-----------------------------------------------------
                       --------------------
   77 00000904 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000908 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000090E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000090E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000912 F8DA F088       ldr              pc,nexttimeout
  836 00000916         ;-------------------------------------------------------
                       ---------------------
  837 00000916         _3D                                  ;   AND $nnnn,X
  838 00000916         ;-------------------------------------------------------
                       ---------------------
  839 00000916                 doAIX
  274 00000916 00000004 
                       _type   SETA             _ABS
  275 00000916 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 0000091A F819 0B01       ldrb             r0,[m6502_pc],#1
  277 0000091E EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00000922 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00000926         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  840 00000926                 opAND
  401 00000926                 readmem
  146 00000926                 [                _type = _ABS
  147 00000926                 readmemabs
  107 00000926 F40C 4160       and              r1,addy,#0xE000
  108 0000092A F20F 0E0A       adr              lr,%F0
  109 0000092E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000092E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000932 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000936         
  113 00000936         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions



ARM Macro Assembler    Page 47 


  148 00000936                 ]
  149 00000936                 [                _type = _ZP
  151                          ]
  152 00000936                 [                _type = _ZPI
  154                          ]
  155 00000936                 [                _type = _IMM
  157                          ]
  402 00000936 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  403 0000093A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  841 0000093E                 fetch            4
   70 0000093E         ;//-----------------------------------------------------
                       ----------------
   71 0000093E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000942 F100 0004       add              r0,r0,#4
   73 00000946 F8CA 00A0       str              r0,clocksh
   74 0000094A         
   75 0000094A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000094E         ;//-----------------------------------------------------
                       --------------------
   77 0000094E F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000952 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000958         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000958 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000095C F8DA F088       ldr              pc,nexttimeout
  842 00000960         ;-------------------------------------------------------
                       ---------------------
  843 00000960         _3E                                  ;   ROL $nnnn,X
  844 00000960         ;-------------------------------------------------------
                       ---------------------
  845 00000960                 doAIX
  274 00000960 00000004 
                       _type   SETA             _ABS
  275 00000960 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00000964 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00000968 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 0000096C EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00000970         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  846 00000970                 opROL
  500 00000970                 readmem
  146 00000970                 [                _type = _ABS
  147 00000970                 readmemabs
  107 00000970 F40C 4160       and              r1,addy,#0xE000
  108 00000974 F20F 0E08       adr              lr,%F0
  109 00000978         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000978 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 0000097C F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000980         
  113 00000980         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 48 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000980                 ]
  149 00000980                 [                _type = _ZP
  151                          ]
  152 00000980                 [                _type = _ZPI
  154                          ]
  155 00000980                 [                _type = _IMM
  157                          ]
  501 00000980 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  502 00000984 EB40 0000       adc              r0,r0,r0
  503 00000988 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  504 0000098C EB48 0808       adc              cycles,cycles,cycles ;Set C
  505 00000990                 writemem
  203 00000990                 [                _type = _ABS
  204 00000990                 writememabs
  177 00000990 F40C 4160       and              r1,addy,#0xe000
  178 00000994 F10A 0224       adr              r2,writemem_tbl
  179 00000998 F20F 0E08       adr              lr,%F0
  180 0000099C         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 0000099C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 000009A0 F852 F001       ldr              pc,[r2,r1]
  183 000009A4         
  184 000009A4         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 000009A4                 ]
  206 000009A4                 [                _type = _ZP
  208                          ]
  209 000009A4                 [                _type = _ZPI
  211                          ]
  847 000009A4                 fetch            7
   70 000009A4         ;//-----------------------------------------------------
                       ----------------
   71 000009A4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000009A8 F100 0007       add              r0,r0,#7
   73 000009AC F8CA 00A0       str              r0,clocksh
   74 000009B0         
   75 000009B0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000009B4         ;//-----------------------------------------------------
                       --------------------
   77 000009B4 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000009B8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000009BE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000009BE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000009C2 F8DA F088       ldr              pc,nexttimeout
  848 000009C6         ;-------------------------------------------------------



ARM Macro Assembler    Page 49 


                       ---------------------
  849 000009C6         _40                                  ;   RTI
  850 000009C6         ;-------------------------------------------------------
                       ---------------------
  851 000009C6                 pop8             r0          ;pop 6502 flags and
                                                             decode
  246 000009C6 F89A 2080       ldrb             r2,m6502_s
  247 000009CA F102 0201       add              r2,r2,#1
  248 000009CE F88A 2080       strb             r2,m6502_s
  249 000009D2 F442 7280       orr              r2,r2,#0x100
  250 000009D6 F91B 0002       ldrsb            r0,[cpu_zpage,r2] ;signed for P
                                                            LA & PLP
  251 000009DA         
  852 000009DA                 decodeP
   61 000009DA F028 084D       bic              cycles,cycles,#CYC_V+CYC_D+CYC_
I+CYC_C
   62 000009DE F000 014D       and              r1,r0,#V+D+I+C
   63 000009E2 EA48 0801       orr              cycles,cycles,r1 ;//VDIC
   64 000009E6 F020 03FD       bic              m6502_nz,r0,#0xFD 
                                                            ;//r0 is signed
   65 000009EA F083 0302       eor              m6502_nz,m6502_nz,#Z
  853 000009EE                 pop16                        ;pop the return add
                                                            ress
  234 000009EE F89A 2080       ldrb             r2,m6502_s
  235 000009F2 F102 0202       add              r2,r2,#2
  236 000009F6 F88A 2080       strb             r2,m6502_s
  237 000009FA F8DA 2080       ldr              r2,m6502_s
  238 000009FE F812 0901       ldrb             r0,[r2],#-1
  239 00000A02 F442 7280       orr              r2,r2,#0x100
  240 00000A06 F892 9000       ldrb             m6502_pc,[r2]
  241 00000A0A EA49 2900       orr              m6502_pc,m6502_pc,r0,lsl#8
  854 00000A0E                 encodePC
   39 00000A0E F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 00000A12 F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   41 00000A16         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 00000A16 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 00000A1A 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 00000A1C         
   45 00000A1C F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 00000A20 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  855 00000A22                 fetch            6
   70 00000A22         ;//-----------------------------------------------------
                       ----------------
   71 00000A22 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000A26 F100 0006       add              r0,r0,#6
   73 00000A2A F8CA 00A0       str              r0,clocksh
   74 00000A2E         
   75 00000A2E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000A32         ;//-----------------------------------------------------
                       --------------------
   77 00000A32 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2



ARM Macro Assembler    Page 50 


                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000A36 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000A3C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000A3C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000A40 F8DA F088       ldr              pc,nexttimeout
  856 00000A44         ;-------------------------------------------------------
                       ---------------------
  857 00000A44         _41                                  ;   EOR ($nn,X)
  858 00000A44         ;-------------------------------------------------------
                       ---------------------
  859 00000A44                 doIIX
  299 00000A44 00000004 
                       _type   SETA             _ABS
  300 00000A44 F819 0B01       ldrb             r0,[m6502_pc],#1
  301 00000A48 EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00000A4C         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00000A4C EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00000A50 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 00000A54         
  306 00000A54 F100 7080       add              r0,r0,#0x01000000
  307 00000A58         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00000A58 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00000A5C F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00000A60         
  311 00000A60 EA4C 2C01       orr              addy,addy,r1,lsl#8
  860 00000A64                 opEOR
  443 00000A64                 readmem
  146 00000A64                 [                _type = _ABS
  147 00000A64                 readmemabs
  107 00000A64 F40C 4160       and              r1,addy,#0xE000
  108 00000A68 F20F 0E08       adr              lr,%F0
  109 00000A6C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000A6C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000A70 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000A74         
  113 00000A74         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000A74                 ]
  149 00000A74                 [                _type = _ZP
  151                          ]
  152 00000A74                 [                _type = _ZPI
  154                          ]
  155 00000A74                 [                _type = _IMM
  157                          ]
  444 00000A74 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24



ARM Macro Assembler    Page 51 


  445 00000A78 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  861 00000A7C                 fetch            6
   70 00000A7C         ;//-----------------------------------------------------
                       ----------------
   71 00000A7C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000A80 F100 0006       add              r0,r0,#6
   73 00000A84 F8CA 00A0       str              r0,clocksh
   74 00000A88         
   75 00000A88 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000A8C         ;//-----------------------------------------------------
                       --------------------
   77 00000A8C F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000A90 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000A96         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000A96 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000A9A F8DA F088       ldr              pc,nexttimeout
  862 00000A9E         ;-------------------------------------------------------
                       ---------------------
  863 00000A9E         _45                                  ;   EOR $nn
  864 00000A9E         ;-------------------------------------------------------
                       ---------------------
  865 00000A9E                 doZ
  346 00000A9E 00000002 
                       _type   SETA             _ZP
  347 00000A9E F819 CB01       ldrb             addy,[m6502_pc],#1
  866 00000AA2                 opEOR
  443 00000AA2                 readmem
  146 00000AA2                 [                _type = _ABS
  148                          ]
  149 00000AA2                 [                _type = _ZP
  150 00000AA2                 readmemzp
  118 00000AA2 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00000AA6                 ]
  152 00000AA6                 [                _type = _ZPI
  154                          ]
  155 00000AA6                 [                _type = _IMM
  157                          ]
  444 00000AA6 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000AAA EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  867 00000AAE                 fetch            3
   70 00000AAE         ;//-----------------------------------------------------
                       ----------------
   71 00000AAE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000AB2 F100 0003       add              r0,r0,#3
   73 00000AB6 F8CA 00A0       str              r0,clocksh
   74 00000ABA         
   75 00000ABA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000ABE         ;//-----------------------------------------------------



ARM Macro Assembler    Page 52 


                       --------------------
   77 00000ABE F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000AC2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000AC8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000AC8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000ACC F8DA F088       ldr              pc,nexttimeout
  868 00000AD0         ;-------------------------------------------------------
                       ---------------------
  869 00000AD0         _46                                  ;   LSR $nn
  870 00000AD0         ;-------------------------------------------------------
                       ---------------------
  871 00000AD0                 doZ
  346 00000AD0 00000002 
                       _type   SETA             _ZP
  347 00000AD0 F819 CB01       ldrb             addy,[m6502_pc],#1
  872 00000AD4                 opLSR
  464 00000AD4                 [                _type = _ABS
  470                          ]
  471 00000AD4                 [                _type = _ZP
  472 00000AD4 F81B 300C       ldrb             m6502_nz,[cpu_zpage,addy]
  473 00000AD8 085B            movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  474 00000ADA F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  475 00000ADE F80B 300C       strb             m6502_nz,[cpu_zpage,addy]
  476 00000AE2                 ]
  477 00000AE2                 [                _type = _ZPI
  488                          ]
  873 00000AE2                 fetch_c          5
   86 00000AE2         ;//-----------------------------------------------------
                       ----------------
   87 00000AE2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000AE6 F100 0005       add              r0,r0,#5
   89 00000AEA F8CA 00A0       str              r0,clocksh
   90 00000AEE         
   91 00000AEE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000AF2         ;//-----------------------------------------------------
                       --------------------
   93 00000AF2 F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   94 00000AF6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000AFC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000AFC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000B00 F8DA F088       ldr              pc,nexttimeout
  874 00000B04         ;-------------------------------------------------------
                       ---------------------
  875 00000B04         _48                                  ;   PHA
  876 00000B04         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 53 


  877 00000B04 EA4F 6015       mov              r0,m6502_a,lsr#24
  878 00000B08                 push8            r0
  227 00000B08 F8DA 2080       ldr              r2,m6502_s
  228 00000B0C F802 0901       strb             r0,[r2],#-1
  229 00000B10 F88A 2080       strb             r2,m6502_s
  879 00000B14                 fetch            3
   70 00000B14         ;//-----------------------------------------------------
                       ----------------
   71 00000B14 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000B18 F100 0003       add              r0,r0,#3
   73 00000B1C F8CA 00A0       str              r0,clocksh
   74 00000B20         
   75 00000B20 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000B24         ;//-----------------------------------------------------
                       --------------------
   77 00000B24 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000B28 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000B2E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000B2E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000B32 F8DA F088       ldr              pc,nexttimeout
  880 00000B36         ;-------------------------------------------------------
                       ---------------------
  881 00000B36         _49                                  ;   EOR #$nn
  882 00000B36         ;-------------------------------------------------------
                       ---------------------
  883 00000B36                 doIMM
  294 00000B36 00000001 
                       _type   SETA             _IMM
  884 00000B36                 opEOR
  443 00000B36                 readmem
  146 00000B36                 [                _type = _ABS
  148                          ]
  149 00000B36                 [                _type = _ZP
  151                          ]
  152 00000B36                 [                _type = _ZPI
  154                          ]
  155 00000B36                 [                _type = _IMM
  156 00000B36                 readmemimm
  136 00000B36 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 00000B3A                 ]
  444 00000B3A EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000B3E EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  885 00000B42                 fetch            2
   70 00000B42         ;//-----------------------------------------------------
                       ----------------
   71 00000B42 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000B46 F100 0002       add              r0,r0,#2
   73 00000B4A F8CA 00A0       str              r0,clocksh
   74 00000B4E         



ARM Macro Assembler    Page 54 


   75 00000B4E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000B52         ;//-----------------------------------------------------
                       --------------------
   77 00000B52 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000B56 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000B5C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000B5C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000B60 F8DA F088       ldr              pc,nexttimeout
  886 00000B64         ;-------------------------------------------------------
                       ---------------------
  887 00000B64         _4A                                  ;   LSR
  888 00000B64         ;-------------------------------------------------------
                       ---------------------
  889 00000B64 0E6B            movs             m6502_nz,m6502_a,lsr#25 ;Z, N=0
                                                            
  890 00000B66 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24 ;result
                                                             without garbage
  891 00000B6A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  892 00000B6E                 fetch_c          2
   86 00000B6E         ;//-----------------------------------------------------
                       ----------------
   87 00000B6E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000B72 F100 0002       add              r0,r0,#2
   89 00000B76 F8CA 00A0       str              r0,clocksh
   90 00000B7A         
   91 00000B7A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000B7E         ;//-----------------------------------------------------
                       --------------------
   93 00000B7E F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 00000B82 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000B88         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000B88 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000B8C F8DA F088       ldr              pc,nexttimeout
  893 00000B90         ;-------------------------------------------------------
                       ---------------------
  894 00000B90         _4C                                  ;   JMP $nnnn
  895 00000B90         ;-------------------------------------------------------
                       ---------------------
  896 00000B90 F819 0B01       ldrb             r0,[m6502_pc],#1
  897 00000B94 F899 1000       ldrb             r1,[m6502_pc]
  898 00000B98 EA40 2901       orr              m6502_pc,r0,r1,lsl#8
  899 00000B9C                 encodePC
   39 00000B9C F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 00000BA0 F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2



ARM Macro Assembler    Page 55 


   41 00000BA4         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 00000BA4 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 00000BA8 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 00000BAA         
   45 00000BAA F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 00000BAE 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  900 00000BB0                 fetch            3
   70 00000BB0         ;//-----------------------------------------------------
                       ----------------
   71 00000BB0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000BB4 F100 0003       add              r0,r0,#3
   73 00000BB8 F8CA 00A0       str              r0,clocksh
   74 00000BBC         
   75 00000BBC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000BC0         ;//-----------------------------------------------------
                       --------------------
   77 00000BC0 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000BC4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000BCA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000BCA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000BCE F8DA F088       ldr              pc,nexttimeout
  901 00000BD2         ;-------------------------------------------------------
                       ---------------------
  902 00000BD2         _4D                                  ;   EOR $nnnn
  903 00000BD2         ;-------------------------------------------------------
                       ---------------------
  904 00000BD2                 doABS
  266 00000BD2 00000004 
                       _type   SETA             _ABS
  267 00000BD2 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00000BD6 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00000BDA EA4C 2C00       orr              addy,addy,r0,lsl#8
  905 00000BDE                 opEOR
  443 00000BDE                 readmem
  146 00000BDE                 [                _type = _ABS
  147 00000BDE                 readmemabs
  107 00000BDE F40C 4160       and              r1,addy,#0xE000
  108 00000BE2 F20F 0E0A       adr              lr,%F0
  109 00000BE6         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000BE6 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000BEA F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000BEE         
  113 00000BEE         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I



ARM Macro Assembler    Page 56 


                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000BEE                 ]
  149 00000BEE                 [                _type = _ZP
  151                          ]
  152 00000BEE                 [                _type = _ZPI
  154                          ]
  155 00000BEE                 [                _type = _IMM
  157                          ]
  444 00000BEE EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000BF2 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  906 00000BF6                 fetch            4
   70 00000BF6         ;//-----------------------------------------------------
                       ----------------
   71 00000BF6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000BFA F100 0004       add              r0,r0,#4
   73 00000BFE F8CA 00A0       str              r0,clocksh
   74 00000C02         
   75 00000C02 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000C06         ;//-----------------------------------------------------
                       --------------------
   77 00000C06 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000C0A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000C10         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000C10 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000C14 F8DA F088       ldr              pc,nexttimeout
  907 00000C18         ;-------------------------------------------------------
                       ---------------------
  908 00000C18         _4E                                  ;   LSR $nnnn
  909 00000C18         ;-------------------------------------------------------
                       ---------------------
  910 00000C18                 doABS
  266 00000C18 00000004 
                       _type   SETA             _ABS
  267 00000C18 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00000C1C F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00000C20 EA4C 2C00       orr              addy,addy,r0,lsl#8
  911 00000C24                 opLSR
  464 00000C24                 [                _type = _ABS
  465 00000C24                 readmemabs
  107 00000C24 F40C 4160       and              r1,addy,#0xE000
  108 00000C28 F20F 0E08       adr              lr,%F0
  109 00000C2C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000C2C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000C30 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000C34         
  113 00000C34         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 57 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  466 00000C34 0840            movs             r0,r0,lsr#1
  467 00000C36 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  468 00000C3A 4603            mov              m6502_nz,r0 ;Z, (N=0)
  469 00000C3C                 writememabs
  177 00000C3C F40C 4160       and              r1,addy,#0xe000
  178 00000C40 F10A 0224       adr              r2,writemem_tbl
  179 00000C44 F20F 0E08       adr              lr,%F0
  180 00000C48         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00000C48 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00000C4C F852 F001       ldr              pc,[r2,r1]
  183 00000C50         
  184 00000C50         0                                    ;out: r0,r1,r2,addy
                                                            =?
  470 00000C50                 ]
  471 00000C50                 [                _type = _ZP
  476                          ]
  477 00000C50                 [                _type = _ZPI
  488                          ]
  912 00000C50                 fetch_c          6
   86 00000C50         ;//-----------------------------------------------------
                       ----------------
   87 00000C50 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000C54 F100 0006       add              r0,r0,#6
   89 00000C58 F8CA 00A0       str              r0,clocksh
   90 00000C5C         
   91 00000C5C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000C60         ;//-----------------------------------------------------
                       --------------------
   93 00000C60 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 00000C64 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000C6A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000C6A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000C6E F8DA F088       ldr              pc,nexttimeout
  913 00000C72         ;-------------------------------------------------------
                       ---------------------
  914 00000C72         _50                                  ;   BVC *
  915 00000C72         ;-------------------------------------------------------
                       ---------------------
  916 00000C72 F018 0F40       tst              cycles,#CYC_V
  917 00000C76 F919 0B01       ldrsb            r0,[m6502_pc],#1
  918 00000C7A BF04 4481       addeq            m6502_pc,m6502_pc,r0
  919 00000C7E         ; subeq cycles,cycles,#3*CYCLE
  920 00000C7E F5A8 7880       subeq            cycles,cycles,#256
  921 00000C82                 fetch            2
   70 00000C82         ;//-----------------------------------------------------
                       ----------------
   71 00000C82 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý



ARM Macro Assembler    Page 58 


   72 00000C86 F100 0002       add              r0,r0,#2
   73 00000C8A F8CA 00A0       str              r0,clocksh
   74 00000C8E         
   75 00000C8E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000C92         ;//-----------------------------------------------------
                       --------------------
   77 00000C92 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000C96 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000C9C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000C9C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000CA0 F8DA F088       ldr              pc,nexttimeout
  922 00000CA4         ;-------------------------------------------------------
                       ---------------------
  923 00000CA4         _51                                  ;   EOR ($nn),Y
  924 00000CA4         ;-------------------------------------------------------
                       ---------------------
  925 00000CA4                 doIIY
  316 00000CA4 00000004 
                       _type   SETA             _ABS
  317 00000CA4 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 00000CA8         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 00000CA8         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 00000CA8 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 00000CAC 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 00000CAE         
  323 00000CAE         
  324 00000CAE 7841            ldrb             r1,[r0,#1]
  325 00000CB0 EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 00000CB4 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 00000CB8         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  926 00000CB8                 opEOR
  443 00000CB8                 readmem
  146 00000CB8                 [                _type = _ABS
  147 00000CB8                 readmemabs
  107 00000CB8 F40C 4160       and              r1,addy,#0xE000
  108 00000CBC F20F 0E08       adr              lr,%F0
  109 00000CC0         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000CC0 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000CC4 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000CC8         
  113 00000CC8         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000CC8                 ]



ARM Macro Assembler    Page 59 


  149 00000CC8                 [                _type = _ZP
  151                          ]
  152 00000CC8                 [                _type = _ZPI
  154                          ]
  155 00000CC8                 [                _type = _IMM
  157                          ]
  444 00000CC8 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000CCC EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  927 00000CD0                 fetch            5
   70 00000CD0         ;//-----------------------------------------------------
                       ----------------
   71 00000CD0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000CD4 F100 0005       add              r0,r0,#5
   73 00000CD8 F8CA 00A0       str              r0,clocksh
   74 00000CDC         
   75 00000CDC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000CE0         ;//-----------------------------------------------------
                       --------------------
   77 00000CE0 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000CE4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000CEA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000CEA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000CEE F8DA F088       ldr              pc,nexttimeout
  928 00000CF2         ;-------------------------------------------------------
                       ---------------------
  929 00000CF2         _55                                  ;   EOR $nn,X
  930 00000CF2         ;-------------------------------------------------------
                       ---------------------
  931 00000CF2                 doZIXf
  366 00000CF2 00000003 
                       _type   SETA             _ZPI
  367 00000CF2 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00000CF6 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  932 00000CFA                 opEOR
  443 00000CFA                 readmem
  146 00000CFA                 [                _type = _ABS
  148                          ]
  149 00000CFA                 [                _type = _ZP
  151                          ]
  152 00000CFA                 [                _type = _ZPI
  153 00000CFA                 readmemzpi
  123 00000CFA         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 00000CFA EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 00000CFE F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00000D02         
  154 00000D02                 ]
  155 00000D02                 [                _type = _IMM
  157                          ]
  444 00000D02 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000D06 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ



ARM Macro Assembler    Page 60 


  933 00000D0A                 fetch            4
   70 00000D0A         ;//-----------------------------------------------------
                       ----------------
   71 00000D0A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000D0E F100 0004       add              r0,r0,#4
   73 00000D12 F8CA 00A0       str              r0,clocksh
   74 00000D16         
   75 00000D16 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000D1A         ;//-----------------------------------------------------
                       --------------------
   77 00000D1A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000D1E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000D24         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000D24 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000D28 F8DA F088       ldr              pc,nexttimeout
  934 00000D2C         ;-------------------------------------------------------
                       ---------------------
  935 00000D2C         _56                                  ;   LSR $nn,X
  936 00000D2C         ;-------------------------------------------------------
                       ---------------------
  937 00000D2C                 doZIXf
  366 00000D2C 00000003 
                       _type   SETA             _ZPI
  367 00000D2C F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00000D30 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  938 00000D34                 opLSR
  464 00000D34                 [                _type = _ABS
  470                          ]
  471 00000D34                 [                _type = _ZP
  476                          ]
  477 00000D34                 [                _type = _ZPI
  478 00000D34         ;//  ldrb m6502_nz,[cpu_zpage,addy,lsr#24]
  479 00000D34 EA4F 631C       lsr              m6502_nz,addy,#24 
                                                            ;//¸Ä¹ý£¬¼Ó2ÐÐ
  480 00000D38 F81B 3003       ldrb             m6502_nz,[cpu_zpage,m6502_nz]
  481 00000D3C         
  482 00000D3C 085B            movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  483 00000D3E F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  484 00000D42         ;//  strb m6502_nz,[cpu_zpage,addy,lsr#24]
  485 00000D42 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ
  486 00000D46 F80B 3001       strb             m6502_nz,[cpu_zpage,r1]
  487 00000D4A         
  488 00000D4A                 ]
  939 00000D4A                 fetch_c          6
   86 00000D4A         ;//-----------------------------------------------------
                       ----------------
   87 00000D4A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý



ARM Macro Assembler    Page 61 


   88 00000D4E F100 0006       add              r0,r0,#6
   89 00000D52 F8CA 00A0       str              r0,clocksh
   90 00000D56         
   91 00000D56 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000D5A         ;//-----------------------------------------------------
                       --------------------
   93 00000D5A F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 00000D5E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000D64         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000D64 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000D68 F8DA F088       ldr              pc,nexttimeout
  940 00000D6C         ;-------------------------------------------------------
                       ---------------------
  941 00000D6C         _58                                  ;   CLI
  942 00000D6C         ;-------------------------------------------------------
                       ---------------------
  943 00000D6C F028 0804       bic              cycles,cycles,#CYC_I
  944 00000D70                 fetch            2
   70 00000D70         ;//-----------------------------------------------------
                       ----------------
   71 00000D70 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000D74 F100 0002       add              r0,r0,#2
   73 00000D78 F8CA 00A0       str              r0,clocksh
   74 00000D7C         
   75 00000D7C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000D80         ;//-----------------------------------------------------
                       --------------------
   77 00000D80 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000D84 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000D8A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000D8A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000D8E F8DA F088       ldr              pc,nexttimeout
  945 00000D92         ;-------------------------------------------------------
                       ---------------------
  946 00000D92         _59                                  ;   EOR $nnnn,Y
  947 00000D92         ;-------------------------------------------------------
                       ---------------------
  948 00000D92                 doAIY
  284 00000D92 00000004 
                       _type   SETA             _ABS
  285 00000D92 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 00000D96 F819 0B01       ldrb             r0,[m6502_pc],#1
  287 00000D9A EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 00000D9E EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 00000DA2         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  949 00000DA2                 opEOR
  443 00000DA2                 readmem



ARM Macro Assembler    Page 62 


  146 00000DA2                 [                _type = _ABS
  147 00000DA2                 readmemabs
  107 00000DA2 F40C 4160       and              r1,addy,#0xE000
  108 00000DA6 F20F 0E0A       adr              lr,%F0
  109 00000DAA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000DAA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000DAE F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000DB2         
  113 00000DB2         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000DB2                 ]
  149 00000DB2                 [                _type = _ZP
  151                          ]
  152 00000DB2                 [                _type = _ZPI
  154                          ]
  155 00000DB2                 [                _type = _IMM
  157                          ]
  444 00000DB2 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000DB6 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  950 00000DBA                 fetch            4
   70 00000DBA         ;//-----------------------------------------------------
                       ----------------
   71 00000DBA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000DBE F100 0004       add              r0,r0,#4
   73 00000DC2 F8CA 00A0       str              r0,clocksh
   74 00000DC6         
   75 00000DC6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000DCA         ;//-----------------------------------------------------
                       --------------------
   77 00000DCA F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000DCE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000DD4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000DD4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000DD8 F8DA F088       ldr              pc,nexttimeout
  951 00000DDC         ;-------------------------------------------------------
                       ---------------------
  952 00000DDC         _5D                                  ;   EOR $nnnn,X
  953 00000DDC         ;-------------------------------------------------------
                       ---------------------
  954 00000DDC                 doAIX
  274 00000DDC 00000004 
                       _type   SETA             _ABS
  275 00000DDC F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00000DE0 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00000DE4 EA4C 2C00       orr              addy,addy,r0,lsl#8



ARM Macro Assembler    Page 63 


  278 00000DE8 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00000DEC         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  955 00000DEC                 opEOR
  443 00000DEC                 readmem
  146 00000DEC                 [                _type = _ABS
  147 00000DEC                 readmemabs
  107 00000DEC F40C 4160       and              r1,addy,#0xE000
  108 00000DF0 F20F 0E08       adr              lr,%F0
  109 00000DF4         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000DF4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000DF8 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000DFC         
  113 00000DFC         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000DFC                 ]
  149 00000DFC                 [                _type = _ZP
  151                          ]
  152 00000DFC                 [                _type = _ZPI
  154                          ]
  155 00000DFC                 [                _type = _IMM
  157                          ]
  444 00000DFC EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  445 00000E00 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  956 00000E04                 fetch            4
   70 00000E04         ;//-----------------------------------------------------
                       ----------------
   71 00000E04 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000E08 F100 0004       add              r0,r0,#4
   73 00000E0C F8CA 00A0       str              r0,clocksh
   74 00000E10         
   75 00000E10 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000E14         ;//-----------------------------------------------------
                       --------------------
   77 00000E14 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000E18 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000E1E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000E1E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000E22 F8DA F088       ldr              pc,nexttimeout
  957 00000E26         ;-------------------------------------------------------
                       ---------------------
  958 00000E26         _5E                                  ;   LSR $nnnn,X
  959 00000E26         ;-------------------------------------------------------
                       ---------------------
  960 00000E26                 doAIX
  274 00000E26 00000004 



ARM Macro Assembler    Page 64 


                       _type   SETA             _ABS
  275 00000E26 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00000E2A F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00000E2E EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00000E32 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00000E36         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  961 00000E36                 opLSR
  464 00000E36                 [                _type = _ABS
  465 00000E36                 readmemabs
  107 00000E36 F40C 4160       and              r1,addy,#0xE000
  108 00000E3A F20F 0E0A       adr              lr,%F0
  109 00000E3E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000E3E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000E42 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000E46         
  113 00000E46         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  466 00000E46 0840            movs             r0,r0,lsr#1
  467 00000E48 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  468 00000E4C 4603            mov              m6502_nz,r0 ;Z, (N=0)
  469 00000E4E                 writememabs
  177 00000E4E F40C 4160       and              r1,addy,#0xe000
  178 00000E52 F10A 0224       adr              r2,writemem_tbl
  179 00000E56 F20F 0E0A       adr              lr,%F0
  180 00000E5A         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00000E5A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00000E5E F852 F001       ldr              pc,[r2,r1]
  183 00000E62         
  184 00000E62         0                                    ;out: r0,r1,r2,addy
                                                            =?
  470 00000E62                 ]
  471 00000E62                 [                _type = _ZP
  476                          ]
  477 00000E62                 [                _type = _ZPI
  488                          ]
  962 00000E62                 fetch_c          7
   86 00000E62         ;//-----------------------------------------------------
                       ----------------
   87 00000E62 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000E66 F100 0007       add              r0,r0,#7
   89 00000E6A F8CA 00A0       str              r0,clocksh
   90 00000E6E         
   91 00000E6E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000E72         ;//-----------------------------------------------------
                       --------------------
   93 00000E72 F578 68E0       sbcs             cycles,cycles,#7*256 
                                                            ;//CYCLE=256
   94 00000E76 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1



ARM Macro Assembler    Page 65 


   95 00000E7C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000E7C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000E80 F8DA F088       ldr              pc,nexttimeout
  963 00000E84         ;-------------------------------------------------------
                       ---------------------
  964 00000E84         _60                                  ;   RTS
  965 00000E84         ;-------------------------------------------------------
                       ---------------------
  966 00000E84                 pop16
  234 00000E84 F89A 2080       ldrb             r2,m6502_s
  235 00000E88 F102 0202       add              r2,r2,#2
  236 00000E8C F88A 2080       strb             r2,m6502_s
  237 00000E90 F8DA 2080       ldr              r2,m6502_s
  238 00000E94 F812 0901       ldrb             r0,[r2],#-1
  239 00000E98 F442 7280       orr              r2,r2,#0x100
  240 00000E9C F892 9000       ldrb             m6502_pc,[r2]
  241 00000EA0 EA49 2900       orr              m6502_pc,m6502_pc,r0,lsl#8
  967 00000EA4 F109 0901       add              m6502_pc,m6502_pc,#1
  968 00000EA8                 encodePC
   39 00000EA8 F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 00000EAC F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   41 00000EB0         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 00000EB0 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 00000EB4 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 00000EB6         
   45 00000EB6 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 00000EBA 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  969 00000EBC                 fetch            6
   70 00000EBC         ;//-----------------------------------------------------
                       ----------------
   71 00000EBC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000EC0 F100 0006       add              r0,r0,#6
   73 00000EC4 F8CA 00A0       str              r0,clocksh
   74 00000EC8         
   75 00000EC8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000ECC         ;//-----------------------------------------------------
                       --------------------
   77 00000ECC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000ED0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000ED6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000ED6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000EDA F8DA F088       ldr              pc,nexttimeout
  970 00000EDE         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 66 


  971 00000EDE         _61                                  ;   ADC ($nn,X)
  972 00000EDE         ;-------------------------------------------------------
                       ---------------------
  973 00000EDE                 doIIX
  299 00000EDE 00000004 
                       _type   SETA             _ABS
  300 00000EDE F819 0B01       ldrb             r0,[m6502_pc],#1
  301 00000EE2 EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00000EE6         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00000EE6 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00000EEA F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 00000EEE         
  306 00000EEE F100 7080       add              r0,r0,#0x01000000
  307 00000EF2         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00000EF2 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00000EF6 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00000EFA         
  311 00000EFA EA4C 2C01       orr              addy,addy,r1,lsl#8
  974 00000EFE                 opADC
  390 00000EFE                 readmem
  146 00000EFE                 [                _type = _ABS
  147 00000EFE                 readmemabs
  107 00000EFE F40C 4160       and              r1,addy,#0xE000
  108 00000F02 F20F 0E0A       adr              lr,%F0
  109 00000F06         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00000F06 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00000F0A F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00000F0E         
  113 00000F0E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00000F0E                 ]
  149 00000F0E                 [                _type = _ZP
  151                          ]
  152 00000F0E                 [                _type = _ZPI
  154                          ]
  155 00000F0E                 [                _type = _IMM
  157                          ]
  391 00000F0E EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00000F12 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 00000F18 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00000F1C EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00000F20 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 00000F24 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  975 00000F2A                 fetch_c          6
   86 00000F2A         ;//-----------------------------------------------------
                       ----------------
   87 00000F2A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý



ARM Macro Assembler    Page 67 


   88 00000F2E F100 0006       add              r0,r0,#6
   89 00000F32 F8CA 00A0       str              r0,clocksh
   90 00000F36         
   91 00000F36 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000F3A         ;//-----------------------------------------------------
                       --------------------
   93 00000F3A F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 00000F3E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000F44         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000F44 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000F48 F8DA F088       ldr              pc,nexttimeout
  976 00000F4C         ;-------------------------------------------------------
                       ---------------------
  977 00000F4C         _65                                  ;   ADC $nn
  978 00000F4C         ;-------------------------------------------------------
                       ---------------------
  979 00000F4C                 doZ
  346 00000F4C 00000002 
                       _type   SETA             _ZP
  347 00000F4C F819 CB01       ldrb             addy,[m6502_pc],#1
  980 00000F50                 opADC
  390 00000F50                 readmem
  146 00000F50                 [                _type = _ABS
  148                          ]
  149 00000F50                 [                _type = _ZP
  150 00000F50                 readmemzp
  118 00000F50 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00000F54                 ]
  152 00000F54                 [                _type = _ZPI
  154                          ]
  155 00000F54                 [                _type = _IMM
  157                          ]
  391 00000F54 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00000F58 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 00000F5E EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00000F62 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00000F66 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 00000F6A BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  981 00000F70                 fetch_c          3
   86 00000F70         ;//-----------------------------------------------------
                       ----------------
   87 00000F70 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00000F74 F100 0003       add              r0,r0,#3
   89 00000F78 F8CA 00A0       str              r0,clocksh
   90 00000F7C         
   91 00000F7C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00000F80         ;//-----------------------------------------------------
                       --------------------
   93 00000F80 F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   94 00000F84 BF5C F819 



ARM Macro Assembler    Page 68 


              0B01             ldrplb           r0,[m6502_pc],#1
   95 00000F8A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00000F8A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00000F8E F8DA F088       ldr              pc,nexttimeout
  982 00000F92         ;-------------------------------------------------------
                       ---------------------
  983 00000F92         _66                                  ;   ROR $nn
  984 00000F92         ;-------------------------------------------------------
                       ---------------------
  985 00000F92                 doZ
  346 00000F92 00000002 
                       _type   SETA             _ZP
  347 00000F92 F819 CB01       ldrb             addy,[m6502_pc],#1
  986 00000F96                 opROR
  510 00000F96                 readmem
  146 00000F96                 [                _type = _ABS
  148                          ]
  149 00000F96                 [                _type = _ZP
  150 00000F96                 readmemzp
  118 00000F96 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00000F9A                 ]
  152 00000F9A                 [                _type = _ZPI
  154                          ]
  155 00000F9A                 [                _type = _IMM
  157                          ]
  511 00000F9A EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  512 00000F9E BF28 F440 
              7080             orrcs            r0,r0,#0x100
  513 00000FA4 0840            movs             r0,r0,lsr#1
  514 00000FA6 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  515 00000FAA EB48 0808       adc              cycles,cycles,cycles ;Set C
  516 00000FAE                 writemem
  203 00000FAE                 [                _type = _ABS
  205                          ]
  206 00000FAE                 [                _type = _ZP
  207 00000FAE                 writememzp
  189 00000FAE F80B 000C       strb             r0,[cpu_zpage,addy]
  208 00000FB2                 ]
  209 00000FB2                 [                _type = _ZPI
  211                          ]
  987 00000FB2                 fetch            5
   70 00000FB2         ;//-----------------------------------------------------
                       ----------------
   71 00000FB2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000FB6 F100 0005       add              r0,r0,#5
   73 00000FBA F8CA 00A0       str              r0,clocksh
   74 00000FBE         
   75 00000FBE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000FC2         ;//-----------------------------------------------------
                       --------------------
   77 00000FC2 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000FC6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë



ARM Macro Assembler    Page 69 


   79 00000FCC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000FCC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000FD0 F8DA F088       ldr              pc,nexttimeout
  988 00000FD4         ;-------------------------------------------------------
                       ---------------------
  989 00000FD4         _68                                  ;   PLA
  990 00000FD4         ;-------------------------------------------------------
                       ---------------------
  991 00000FD4                 pop8             m6502_nz
  246 00000FD4 F89A 2080       ldrb             r2,m6502_s
  247 00000FD8 F102 0201       add              r2,r2,#1
  248 00000FDC F88A 2080       strb             r2,m6502_s
  249 00000FE0 F442 7280       orr              r2,r2,#0x100
  250 00000FE4 F91B 3002       ldrsb            m6502_nz,[cpu_zpage,r2] ;signed
                                                             for PLA & PLP
  251 00000FE8         
  992 00000FE8 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  993 00000FEC                 fetch            4
   70 00000FEC         ;//-----------------------------------------------------
                       ----------------
   71 00000FEC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000FF0 F100 0004       add              r0,r0,#4
   73 00000FF4 F8CA 00A0       str              r0,clocksh
   74 00000FF8         
   75 00000FF8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000FFC         ;//-----------------------------------------------------
                       --------------------
   77 00000FFC F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001000 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001006         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001006 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000100A F8DA F088       ldr              pc,nexttimeout
  994 0000100E         ;-------------------------------------------------------
                       ---------------------
  995 0000100E         _69                                  ;   ADC #$nn
  996 0000100E         ;-------------------------------------------------------
                       ---------------------
  997 0000100E                 doIMM
  294 0000100E 00000001 
                       _type   SETA             _IMM
  998 0000100E                 opADC
  390 0000100E                 readmem
  146 0000100E                 [                _type = _ABS
  148                          ]
  149 0000100E                 [                _type = _ZP
  151                          ]
  152 0000100E                 [                _type = _ZPI
  154                          ]



ARM Macro Assembler    Page 70 


  155 0000100E                 [                _type = _IMM
  156 0000100E                 readmemimm
  136 0000100E F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 00001012                 ]
  391 00001012 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00001016 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 0000101C EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00001020 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00001024 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 00001028 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  999 0000102E                 fetch_c          2
   86 0000102E         ;//-----------------------------------------------------
                       ----------------
   87 0000102E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001032 F100 0002       add              r0,r0,#2
   89 00001036 F8CA 00A0       str              r0,clocksh
   90 0000103A         
   91 0000103A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000103E         ;//-----------------------------------------------------
                       --------------------
   93 0000103E F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 00001042 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001048         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001048 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 0000104C F8DA F088       ldr              pc,nexttimeout
 1000 00001050         ;-------------------------------------------------------
                       ---------------------
 1001 00001050         _6A                                  ;   ROR
 1002 00001050         ;-------------------------------------------------------
                       ---------------------
 1003 00001050 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
 1004 00001054 EA4F 0535       mov              m6502_a,m6502_a,rrx
 1005 00001058 162B            movs             m6502_nz,m6502_a,asr#24 ;NZ
 1006 0000105A F005 457F       and              m6502_a,m6502_a,#0xff000000
 1007 0000105E EB48 0808       adc              cycles,cycles,cycles ;Set C
 1008 00001062                 fetch            2
   70 00001062         ;//-----------------------------------------------------
                       ----------------
   71 00001062 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001066 F100 0002       add              r0,r0,#2
   73 0000106A F8CA 00A0       str              r0,clocksh
   74 0000106E         
   75 0000106E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001072         ;//-----------------------------------------------------
                       --------------------
   77 00001072 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001076 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ



ARM Macro Assembler    Page 71 


                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000107C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000107C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001080 F8DA F088       ldr              pc,nexttimeout
 1009 00001084         ;-------------------------------------------------------
                       ---------------------
 1010 00001084         _6C                                  ;   JMP ($nnnn) JMP
                                                             ($data16) ¼ä½ÓÑ°Ö·
                                                             ******************
                                                            ***************
 1011 00001084         ;-------------------------------------------------------
                       ---------------------  
 1012 00001084                 doABS
  266 00001084 00000004 
                       _type   SETA             _ABS
  267 00001084 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001088 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 0000108C EA4C 2C00       orr              addy,addy,r0,lsl#8
 1013 00001090 F10A 0144       adr              r1,memmap_tbl
 1014 00001094 F40C 4260       and              r2,addy,#0xE000 ;    
 1015 00001098         ; ldr r1,[r1,r2,lsr#11]      ;>>11 addr&0x7FF
 1016 00001098 EA4F 20D2       lsr              r0,r2,#11
 1017 0000109C 5809            ldr              r1,[r1,r0]  ;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ
                                                            «ÒÆÁ¿¼Óµ½Rn ÖÐ,Æä½á
                                                            ¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´
                                                            ¢µØÖ·
 1018 0000109E         
 1019 0000109E F811 900C       ldrb             m6502_pc,[r1,addy] ;//ÈôÊ¹ÓÃºó×
                                                            º"!",Ôò½á¹ûÐ´»Øµ½Rn
                                                            ÖÐ
 1020 000010A2 4461            add              r1,r1,addy
 1021 000010A4         
 1022 000010A4 7848            ldrb             r0,[r1,#1]
 1023 000010A6 EA49 2900       orr              m6502_pc,m6502_pc,r0,lsl#8 ;m65
                                                            02_pc=r9Ê¹ÓÃORR Ö¸Á
                                                            î½«½üR9µÄ¸ß8 Î»Êý¾Ý
                                                            ÒÆÈëµ½R0µÍ8Î»
 1024 000010AA                 encodePC
   39 000010AA F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 000010AE F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   41 000010B2         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 000010B2 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 000010B6 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 000010B8         
   45 000010B8 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 000010BC 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
 1025 000010BE                 fetch            5
   70 000010BE         ;//-----------------------------------------------------
                       ----------------
   71 000010BE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 72 


                                                            ÓÊý
   72 000010C2 F100 0005       add              r0,r0,#5
   73 000010C6 F8CA 00A0       str              r0,clocksh
   74 000010CA         
   75 000010CA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000010CE         ;//-----------------------------------------------------
                       --------------------
   77 000010CE F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000010D2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000010D8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000010D8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000010DC F8DA F088       ldr              pc,nexttimeout
 1026 000010E0         ;-------------------------------------------------------
                       ---------------------
 1027 000010E0         _6D                                  ;   ADC $nnnn
 1028 000010E0         ;-------------------------------------------------------
                       ---------------------
 1029 000010E0                 doABS
  266 000010E0 00000004 
                       _type   SETA             _ABS
  267 000010E0 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000010E4 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000010E8 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1030 000010EC                 opADC
  390 000010EC                 readmem
  146 000010EC                 [                _type = _ABS
  147 000010EC                 readmemabs
  107 000010EC F40C 4160       and              r1,addy,#0xE000
  108 000010F0 F20F 0E08       adr              lr,%F0
  109 000010F4         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000010F4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000010F8 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000010FC         
  113 000010FC         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000010FC                 ]
  149 000010FC                 [                _type = _ZP
  151                          ]
  152 000010FC                 [                _type = _ZPI
  154                          ]
  155 000010FC                 [                _type = _IMM
  157                          ]
  391 000010FC EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00001100 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 00001106 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8



ARM Macro Assembler    Page 73 


  394 0000110A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 0000110E F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 00001112 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1031 00001118                 fetch_c          4
   86 00001118         ;//-----------------------------------------------------
                       ----------------
   87 00001118 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 0000111C F100 0004       add              r0,r0,#4
   89 00001120 F8CA 00A0       str              r0,clocksh
   90 00001124         
   91 00001124 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001128         ;//-----------------------------------------------------
                       --------------------
   93 00001128 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 0000112C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001132         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001132 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001136 F8DA F088       ldr              pc,nexttimeout
 1032 0000113A         ;-------------------------------------------------------
                       ---------------------
 1033 0000113A         _6E                                  ;   ROR $nnnn
 1034 0000113A         ;-------------------------------------------------------
                       ---------------------
 1035 0000113A                 doABS
  266 0000113A 00000004 
                       _type   SETA             _ABS
  267 0000113A F819 CB01       ldrb             addy,[m6502_pc],#1
  268 0000113E F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00001142 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1036 00001146                 opROR
  510 00001146                 readmem
  146 00001146                 [                _type = _ABS
  147 00001146                 readmemabs
  107 00001146 F40C 4160       and              r1,addy,#0xE000
  108 0000114A F20F 0E0A       adr              lr,%F0
  109 0000114E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000114E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001152 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001156         
  113 00001156         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00001156                 ]
  149 00001156                 [                _type = _ZP
  151                          ]
  152 00001156                 [                _type = _ZPI
  154                          ]
  155 00001156                 [                _type = _IMM
  157                          ]



ARM Macro Assembler    Page 74 


  511 00001156 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  512 0000115A BF28 F440 
              7080             orrcs            r0,r0,#0x100
  513 00001160 0840            movs             r0,r0,lsr#1
  514 00001162 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  515 00001166 EB48 0808       adc              cycles,cycles,cycles ;Set C
  516 0000116A                 writemem
  203 0000116A                 [                _type = _ABS
  204 0000116A                 writememabs
  177 0000116A F40C 4160       and              r1,addy,#0xe000
  178 0000116E F10A 0224       adr              r2,writemem_tbl
  179 00001172 F20F 0E0A       adr              lr,%F0
  180 00001176         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00001176 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 0000117A F852 F001       ldr              pc,[r2,r1]
  183 0000117E         
  184 0000117E         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 0000117E                 ]
  206 0000117E                 [                _type = _ZP
  208                          ]
  209 0000117E                 [                _type = _ZPI
  211                          ]
 1037 0000117E                 fetch            6
   70 0000117E         ;//-----------------------------------------------------
                       ----------------
   71 0000117E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001182 F100 0006       add              r0,r0,#6
   73 00001186 F8CA 00A0       str              r0,clocksh
   74 0000118A         
   75 0000118A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000118E         ;//-----------------------------------------------------
                       --------------------
   77 0000118E F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001192 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001198         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001198 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000119C F8DA F088       ldr              pc,nexttimeout
 1038 000011A0         ;-------------------------------------------------------
                       ---------------------
 1039 000011A0         _70                                  ;   BVS *
 1040 000011A0         ;-------------------------------------------------------
                       ---------------------
 1041 000011A0 F018 0F40       tst              cycles,#CYC_V
 1042 000011A4 F919 0B01       ldrsb            r0,[m6502_pc],#1
 1043 000011A8 BF1C 4481       addne            m6502_pc,m6502_pc,r0
 1044 000011AC         ; subne cycles,cycles,#3*CYCLE
 1045 000011AC F5A8 7880       subne            cycles,cycles,#256



ARM Macro Assembler    Page 75 


 1046 000011B0                 fetch            2
   70 000011B0         ;//-----------------------------------------------------
                       ----------------
   71 000011B0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000011B4 F100 0002       add              r0,r0,#2
   73 000011B8 F8CA 00A0       str              r0,clocksh
   74 000011BC         
   75 000011BC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000011C0         ;//-----------------------------------------------------
                       --------------------
   77 000011C0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000011C4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000011CA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000011CA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000011CE F8DA F088       ldr              pc,nexttimeout
 1047 000011D2         ;-------------------------------------------------------
                       ---------------------
 1048 000011D2         _71                                  ;   ADC ($nn),Y
 1049 000011D2         ;-------------------------------------------------------
                       ---------------------
 1050 000011D2                 doIIY
  316 000011D2 00000004 
                       _type   SETA             _ABS
  317 000011D2 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 000011D6         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 000011D6         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 000011D6 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 000011DA 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 000011DC         
  323 000011DC         
  324 000011DC 7841            ldrb             r1,[r0,#1]
  325 000011DE EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 000011E2 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 000011E6         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
 1051 000011E6                 opADC
  390 000011E6                 readmem
  146 000011E6                 [                _type = _ABS
  147 000011E6                 readmemabs
  107 000011E6 F40C 4160       and              r1,addy,#0xE000
  108 000011EA F20F 0E0A       adr              lr,%F0
  109 000011EE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000011EE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000011F2 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000011F6         
  113 000011F6         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 76 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000011F6                 ]
  149 000011F6                 [                _type = _ZP
  151                          ]
  152 000011F6                 [                _type = _ZPI
  154                          ]
  155 000011F6                 [                _type = _IMM
  157                          ]
  391 000011F6 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 000011FA BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 00001200 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00001204 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00001208 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 0000120C BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1052 00001212                 fetch_c          5
   86 00001212         ;//-----------------------------------------------------
                       ----------------
   87 00001212 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001216 F100 0005       add              r0,r0,#5
   89 0000121A F8CA 00A0       str              r0,clocksh
   90 0000121E         
   91 0000121E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001222         ;//-----------------------------------------------------
                       --------------------
   93 00001222 F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   94 00001226 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 0000122C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 0000122C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001230 F8DA F088       ldr              pc,nexttimeout
 1053 00001234         ;-------------------------------------------------------
                       ---------------------
 1054 00001234         _75                                  ;   ADC $nn,X
 1055 00001234         ;-------------------------------------------------------
                       ---------------------
 1056 00001234                 doZIXf
  366 00001234 00000003 
                       _type   SETA             _ZPI
  367 00001234 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00001238 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1057 0000123C                 opADC
  390 0000123C                 readmem
  146 0000123C                 [                _type = _ABS
  148                          ]
  149 0000123C                 [                _type = _ZP
  151                          ]
  152 0000123C                 [                _type = _ZPI
  153 0000123C                 readmemzpi
  123 0000123C         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 0000123C EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ



ARM Macro Assembler    Page 77 


  125 00001240 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00001244         
  154 00001244                 ]
  155 00001244                 [                _type = _IMM
  157                          ]
  391 00001244 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00001248 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 0000124E EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00001252 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00001256 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 0000125A BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1058 00001260                 fetch_c          4
   86 00001260         ;//-----------------------------------------------------
                       ----------------
   87 00001260 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001264 F100 0004       add              r0,r0,#4
   89 00001268 F8CA 00A0       str              r0,clocksh
   90 0000126C         
   91 0000126C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001270         ;//-----------------------------------------------------
                       --------------------
   93 00001270 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 00001274 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 0000127A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 0000127A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 0000127E F8DA F088       ldr              pc,nexttimeout
 1059 00001282         ;-------------------------------------------------------
                       ---------------------
 1060 00001282         _76                                  ;   ROR $nn,X
 1061 00001282         ;-------------------------------------------------------
                       ---------------------
 1062 00001282                 doZIXf
  366 00001282 00000003 
                       _type   SETA             _ZPI
  367 00001282 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00001286 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1063 0000128A                 opROR
  510 0000128A                 readmem
  146 0000128A                 [                _type = _ABS
  148                          ]
  149 0000128A                 [                _type = _ZP
  151                          ]
  152 0000128A                 [                _type = _ZPI
  153 0000128A                 readmemzpi
  123 0000128A         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 0000128A EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 0000128E F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00001292         
  154 00001292                 ]
  155 00001292                 [                _type = _IMM
  157                          ]
  511 00001292 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C



ARM Macro Assembler    Page 78 


  512 00001296 BF28 F440 
              7080             orrcs            r0,r0,#0x100
  513 0000129C 0840            movs             r0,r0,lsr#1
  514 0000129E EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  515 000012A2 EB48 0808       adc              cycles,cycles,cycles ;Set C
  516 000012A6                 writemem
  203 000012A6                 [                _type = _ABS
  205                          ]
  206 000012A6                 [                _type = _ZP
  208                          ]
  209 000012A6                 [                _type = _ZPI
  210 000012A6                 writememzpi
  194 000012A6         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 000012A6 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 000012AA F80B 0001       strb             r0,[cpu_zpage,r1]
  197 000012AE         
  198 000012AE         
  211 000012AE                 ]
 1064 000012AE                 fetch            6
   70 000012AE         ;//-----------------------------------------------------
                       ----------------
   71 000012AE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000012B2 F100 0006       add              r0,r0,#6
   73 000012B6 F8CA 00A0       str              r0,clocksh
   74 000012BA         
   75 000012BA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000012BE         ;//-----------------------------------------------------
                       --------------------
   77 000012BE F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000012C2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000012C8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000012C8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000012CC F8DA F088       ldr              pc,nexttimeout
 1065 000012D0         ;-------------------------------------------------------
                       ---------------------
 1066 000012D0         _78                                  ;   SEI
 1067 000012D0         ;-------------------------------------------------------
                       ---------------------
 1068 000012D0 F048 0804       orr              cycles,cycles,#CYC_I
 1069 000012D4                 fetch            2
   70 000012D4         ;//-----------------------------------------------------
                       ----------------
   71 000012D4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000012D8 F100 0002       add              r0,r0,#2
   73 000012DC F8CA 00A0       str              r0,clocksh
   74 000012E0         
   75 000012E0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 79 


   76 000012E4         ;//-----------------------------------------------------
                       --------------------
   77 000012E4 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000012E8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000012EE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000012EE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000012F2 F8DA F088       ldr              pc,nexttimeout
 1070 000012F6         ;-------------------------------------------------------
                       ---------------------
 1071 000012F6         _79                                  ;   ADC $nnnn,Y
 1072 000012F6         ;-------------------------------------------------------
                       ---------------------
 1073 000012F6                 doAIY
  284 000012F6 00000004 
                       _type   SETA             _ABS
  285 000012F6 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 000012FA F819 0B01       ldrb             r0,[m6502_pc],#1
  287 000012FE EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 00001302 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 00001306         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1074 00001306                 opADC
  390 00001306                 readmem
  146 00001306                 [                _type = _ABS
  147 00001306                 readmemabs
  107 00001306 F40C 4160       and              r1,addy,#0xE000
  108 0000130A F20F 0E0A       adr              lr,%F0
  109 0000130E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000130E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001312 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001316         
  113 00001316         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00001316                 ]
  149 00001316                 [                _type = _ZP
  151                          ]
  152 00001316                 [                _type = _ZPI
  154                          ]
  155 00001316                 [                _type = _IMM
  157                          ]
  391 00001316 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 0000131A BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 00001320 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00001324 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00001328 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 0000132C BF78 F028 



ARM Macro Assembler    Page 80 


              0840             bicvc            cycles,cycles,#CYC_V ;V
 1075 00001332                 fetch_c          4
   86 00001332         ;//-----------------------------------------------------
                       ----------------
   87 00001332 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001336 F100 0004       add              r0,r0,#4
   89 0000133A F8CA 00A0       str              r0,clocksh
   90 0000133E         
   91 0000133E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001342         ;//-----------------------------------------------------
                       --------------------
   93 00001342 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 00001346 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 0000134C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 0000134C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001350 F8DA F088       ldr              pc,nexttimeout
 1076 00001354         ;-------------------------------------------------------
                       ---------------------
 1077 00001354         _7D                                  ;   ADC $nnnn,X
 1078 00001354         ;-------------------------------------------------------
                       ---------------------
 1079 00001354                 doAIX
  274 00001354 00000004 
                       _type   SETA             _ABS
  275 00001354 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00001358 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 0000135C EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00001360 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00001364         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1080 00001364                 opADC
  390 00001364                 readmem
  146 00001364                 [                _type = _ABS
  147 00001364                 readmemabs
  107 00001364 F40C 4160       and              r1,addy,#0xE000
  108 00001368 F20F 0E08       adr              lr,%F0
  109 0000136C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000136C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001370 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001374         
  113 00001374         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00001374                 ]
  149 00001374                 [                _type = _ZP
  151                          ]
  152 00001374                 [                _type = _ZPI
  154                          ]
  155 00001374                 [                _type = _IMM
  157                          ]
  391 00001374 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00001378 BF28 F5A0 



ARM Macro Assembler    Page 81 


              7080             subcs            r0,r0,#0x00000100
  393 0000137E EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 00001382 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00001386 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 0000138A BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1081 00001390                 fetch_c          4
   86 00001390         ;//-----------------------------------------------------
                       ----------------
   87 00001390 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001394 F100 0004       add              r0,r0,#4
   89 00001398 F8CA 00A0       str              r0,clocksh
   90 0000139C         
   91 0000139C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000013A0         ;//-----------------------------------------------------
                       --------------------
   93 000013A0 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 000013A4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000013AA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000013AA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000013AE F8DA F088       ldr              pc,nexttimeout
 1082 000013B2         ;-------------------------------------------------------
                       ---------------------
 1083 000013B2         _7E                                  ;   ROR $nnnn,X
 1084 000013B2         ;-------------------------------------------------------
                       ---------------------
 1085 000013B2                 doAIX
  274 000013B2 00000004 
                       _type   SETA             _ABS
  275 000013B2 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 000013B6 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 000013BA EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 000013BE EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 000013C2         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1086 000013C2                 opROR
  510 000013C2                 readmem
  146 000013C2                 [                _type = _ABS
  147 000013C2                 readmemabs
  107 000013C2 F40C 4160       and              r1,addy,#0xE000
  108 000013C6 F20F 0E0A       adr              lr,%F0
  109 000013CA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000013CA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000013CE F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000013D2         
  113 000013D2         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000013D2                 ]
  149 000013D2                 [                _type = _ZP
  151                          ]



ARM Macro Assembler    Page 82 


  152 000013D2                 [                _type = _ZPI
  154                          ]
  155 000013D2                 [                _type = _IMM
  157                          ]
  511 000013D2 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  512 000013D6 BF28 F440 
              7080             orrcs            r0,r0,#0x100
  513 000013DC 0840            movs             r0,r0,lsr#1
  514 000013DE EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  515 000013E2 EB48 0808       adc              cycles,cycles,cycles ;Set C
  516 000013E6                 writemem
  203 000013E6                 [                _type = _ABS
  204 000013E6                 writememabs
  177 000013E6 F40C 4160       and              r1,addy,#0xe000
  178 000013EA F10A 0224       adr              r2,writemem_tbl
  179 000013EE F20F 0E0A       adr              lr,%F0
  180 000013F2         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 000013F2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 000013F6 F852 F001       ldr              pc,[r2,r1]
  183 000013FA         
  184 000013FA         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 000013FA                 ]
  206 000013FA                 [                _type = _ZP
  208                          ]
  209 000013FA                 [                _type = _ZPI
  211                          ]
 1087 000013FA                 fetch            7
   70 000013FA         ;//-----------------------------------------------------
                       ----------------
   71 000013FA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000013FE F100 0007       add              r0,r0,#7
   73 00001402 F8CA 00A0       str              r0,clocksh
   74 00001406         
   75 00001406 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000140A         ;//-----------------------------------------------------
                       --------------------
   77 0000140A F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000140E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001414         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001414 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001418 F8DA F088       ldr              pc,nexttimeout
 1088 0000141C         ;-------------------------------------------------------
                       ---------------------
 1089 0000141C         _81                                  ;   STA ($nn,X)
 1090 0000141C         ;-------------------------------------------------------
                       ---------------------
 1091 0000141C                 doIIX



ARM Macro Assembler    Page 83 


  299 0000141C 00000004 
                       _type   SETA             _ABS
  300 0000141C F819 0B01       ldrb             r0,[m6502_pc],#1
  301 00001420 EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00001424         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00001424 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00001428 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 0000142C         
  306 0000142C F100 7080       add              r0,r0,#0x01000000
  307 00001430         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00001430 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00001434 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00001438         
  311 00001438 EA4C 2C01       orr              addy,addy,r1,lsl#8
 1092 0000143C                 opSTORE          m6502_a
  532 0000143C EA4F 6015       mov              r0,m6502_a,lsr#24
  533 00001440                 writemem
  203 00001440                 [                _type = _ABS
  204 00001440                 writememabs
  177 00001440 F40C 4160       and              r1,addy,#0xe000
  178 00001444 F10A 0224       adr              r2,writemem_tbl
  179 00001448 F20F 0E08       adr              lr,%F0
  180 0000144C         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 0000144C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00001450 F852 F001       ldr              pc,[r2,r1]
  183 00001454         
  184 00001454         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00001454                 ]
  206 00001454                 [                _type = _ZP
  208                          ]
  209 00001454                 [                _type = _ZPI
  211                          ]
 1093 00001454                 fetch            6
   70 00001454         ;//-----------------------------------------------------
                       ----------------
   71 00001454 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001458 F100 0006       add              r0,r0,#6
   73 0000145C F8CA 00A0       str              r0,clocksh
   74 00001460         
   75 00001460 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001464         ;//-----------------------------------------------------
                       --------------------
   77 00001464 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001468 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000146E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************



ARM Macro Assembler    Page 84 


                       *
   80 0000146E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001472 F8DA F088       ldr              pc,nexttimeout
 1094 00001476         ;-------------------------------------------------------
                       ---------------------
 1095 00001476         _84                                  ;   STY $nn
 1096 00001476         ;-------------------------------------------------------
                       ---------------------
 1097 00001476                 doZ
  346 00001476 00000002 
                       _type   SETA             _ZP
  347 00001476 F819 CB01       ldrb             addy,[m6502_pc],#1
 1098 0000147A                 opSTORE          m6502_y
  532 0000147A EA4F 6017       mov              r0,m6502_y,lsr#24
  533 0000147E                 writemem
  203 0000147E                 [                _type = _ABS
  205                          ]
  206 0000147E                 [                _type = _ZP
  207 0000147E                 writememzp
  189 0000147E F80B 000C       strb             r0,[cpu_zpage,addy]
  208 00001482                 ]
  209 00001482                 [                _type = _ZPI
  211                          ]
 1099 00001482                 fetch            3
   70 00001482         ;//-----------------------------------------------------
                       ----------------
   71 00001482 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001486 F100 0003       add              r0,r0,#3
   73 0000148A F8CA 00A0       str              r0,clocksh
   74 0000148E         
   75 0000148E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001492         ;//-----------------------------------------------------
                       --------------------
   77 00001492 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001496 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000149C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000149C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000014A0 F8DA F088       ldr              pc,nexttimeout
 1100 000014A4         ;-------------------------------------------------------
                       ---------------------
 1101 000014A4         _85                                  ;   STA $nn
 1102 000014A4         ;-------------------------------------------------------
                       ---------------------
 1103 000014A4                 doZ
  346 000014A4 00000002 
                       _type   SETA             _ZP
  347 000014A4 F819 CB01       ldrb             addy,[m6502_pc],#1
 1104 000014A8                 opSTORE          m6502_a
  532 000014A8 EA4F 6015       mov              r0,m6502_a,lsr#24
  533 000014AC                 writemem



ARM Macro Assembler    Page 85 


  203 000014AC                 [                _type = _ABS
  205                          ]
  206 000014AC                 [                _type = _ZP
  207 000014AC                 writememzp
  189 000014AC F80B 000C       strb             r0,[cpu_zpage,addy]
  208 000014B0                 ]
  209 000014B0                 [                _type = _ZPI
  211                          ]
 1105 000014B0                 fetch            3
   70 000014B0         ;//-----------------------------------------------------
                       ----------------
   71 000014B0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000014B4 F100 0003       add              r0,r0,#3
   73 000014B8 F8CA 00A0       str              r0,clocksh
   74 000014BC         
   75 000014BC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000014C0         ;//-----------------------------------------------------
                       --------------------
   77 000014C0 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000014C4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000014CA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000014CA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000014CE F8DA F088       ldr              pc,nexttimeout
 1106 000014D2         ;-------------------------------------------------------
                       ---------------------
 1107 000014D2         _86                                  ;   STX $nn
 1108 000014D2         ;-------------------------------------------------------
                       ---------------------
 1109 000014D2                 doZ
  346 000014D2 00000002 
                       _type   SETA             _ZP
  347 000014D2 F819 CB01       ldrb             addy,[m6502_pc],#1
 1110 000014D6                 opSTORE          m6502_x
  532 000014D6 EA4F 6016       mov              r0,m6502_x,lsr#24
  533 000014DA                 writemem
  203 000014DA                 [                _type = _ABS
  205                          ]
  206 000014DA                 [                _type = _ZP
  207 000014DA                 writememzp
  189 000014DA F80B 000C       strb             r0,[cpu_zpage,addy]
  208 000014DE                 ]
  209 000014DE                 [                _type = _ZPI
  211                          ]
 1111 000014DE                 fetch            3
   70 000014DE         ;//-----------------------------------------------------
                       ----------------
   71 000014DE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000014E2 F100 0003       add              r0,r0,#3
   73 000014E6 F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 86 


   74 000014EA         
   75 000014EA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000014EE         ;//-----------------------------------------------------
                       --------------------
   77 000014EE F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000014F2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000014F8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000014F8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000014FC F8DA F088       ldr              pc,nexttimeout
 1112 00001500         ;-------------------------------------------------------
                       ---------------------
 1113 00001500         _88                                  ;   DEY
 1114 00001500         ;-------------------------------------------------------
                       ---------------------
 1115 00001500 F1A7 7780       sub              m6502_y,m6502_y,#0x01000000
 1116 00001504 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
 1117 00001508                 fetch            2
   70 00001508         ;//-----------------------------------------------------
                       ----------------
   71 00001508 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000150C F100 0002       add              r0,r0,#2
   73 00001510 F8CA 00A0       str              r0,clocksh
   74 00001514         
   75 00001514 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001518         ;//-----------------------------------------------------
                       --------------------
   77 00001518 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000151C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001522         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001522 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001526 F8DA F088       ldr              pc,nexttimeout
 1118 0000152A         ;-------------------------------------------------------
                       ---------------------
 1119 0000152A         _8A                                  ;   TXA
 1120 0000152A         ;-------------------------------------------------------
                       ---------------------
 1121 0000152A 4635            mov              m6502_a,m6502_x
 1122 0000152C EA4F 6326       mov              m6502_nz,m6502_x,asr#24
 1123 00001530                 fetch            2
   70 00001530         ;//-----------------------------------------------------
                       ----------------
   71 00001530 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 87 


                                                            ÓÊý
   72 00001534 F100 0002       add              r0,r0,#2
   73 00001538 F8CA 00A0       str              r0,clocksh
   74 0000153C         
   75 0000153C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001540         ;//-----------------------------------------------------
                       --------------------
   77 00001540 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001544 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000154A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000154A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000154E F8DA F088       ldr              pc,nexttimeout
 1124 00001552         ;-------------------------------------------------------
                       ---------------------
 1125 00001552         _8C                                  ;   STY $nnnn
 1126 00001552         ;-------------------------------------------------------
                       ---------------------
 1127 00001552                 doABS
  266 00001552 00000004 
                       _type   SETA             _ABS
  267 00001552 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001556 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 0000155A EA4C 2C00       orr              addy,addy,r0,lsl#8
 1128 0000155E                 opSTORE          m6502_y
  532 0000155E EA4F 6017       mov              r0,m6502_y,lsr#24
  533 00001562                 writemem
  203 00001562                 [                _type = _ABS
  204 00001562                 writememabs
  177 00001562 F40C 4160       and              r1,addy,#0xe000
  178 00001566 F10A 0224       adr              r2,writemem_tbl
  179 0000156A F20F 0E0A       adr              lr,%F0
  180 0000156E         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 0000156E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00001572 F852 F001       ldr              pc,[r2,r1]
  183 00001576         
  184 00001576         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00001576                 ]
  206 00001576                 [                _type = _ZP
  208                          ]
  209 00001576                 [                _type = _ZPI
  211                          ]
 1129 00001576                 fetch            4
   70 00001576         ;//-----------------------------------------------------
                       ----------------
   71 00001576 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000157A F100 0004       add              r0,r0,#4
   73 0000157E F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 88 


   74 00001582         
   75 00001582 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001586         ;//-----------------------------------------------------
                       --------------------
   77 00001586 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000158A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001590         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001590 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001594 F8DA F088       ldr              pc,nexttimeout
 1130 00001598         ;-------------------------------------------------------
                       ---------------------
 1131 00001598         _8D                                  ;   STA $nnnn
 1132 00001598         ;-------------------------------------------------------
                       ---------------------
 1133 00001598                 doABS
  266 00001598 00000004 
                       _type   SETA             _ABS
  267 00001598 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 0000159C F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000015A0 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1134 000015A4                 opSTORE          m6502_a
  532 000015A4 EA4F 6015       mov              r0,m6502_a,lsr#24
  533 000015A8                 writemem
  203 000015A8                 [                _type = _ABS
  204 000015A8                 writememabs
  177 000015A8 F40C 4160       and              r1,addy,#0xe000
  178 000015AC F10A 0224       adr              r2,writemem_tbl
  179 000015B0 F20F 0E08       adr              lr,%F0
  180 000015B4         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 000015B4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 000015B8 F852 F001       ldr              pc,[r2,r1]
  183 000015BC         
  184 000015BC         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 000015BC                 ]
  206 000015BC                 [                _type = _ZP
  208                          ]
  209 000015BC                 [                _type = _ZPI
  211                          ]
 1135 000015BC                 fetch            4
   70 000015BC         ;//-----------------------------------------------------
                       ----------------
   71 000015BC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000015C0 F100 0004       add              r0,r0,#4
   73 000015C4 F8CA 00A0       str              r0,clocksh
   74 000015C8         
   75 000015C8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 89 


   76 000015CC         ;//-----------------------------------------------------
                       --------------------
   77 000015CC F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000015D0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000015D6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000015D6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000015DA F8DA F088       ldr              pc,nexttimeout
 1136 000015DE         ;-------------------------------------------------------
                       ---------------------
 1137 000015DE         _8E                                  ;   STX $nnnn
 1138 000015DE         ;-------------------------------------------------------
                       ---------------------
 1139 000015DE                 doABS
  266 000015DE 00000004 
                       _type   SETA             _ABS
  267 000015DE F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000015E2 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000015E6 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1140 000015EA                 opSTORE          m6502_x
  532 000015EA EA4F 6016       mov              r0,m6502_x,lsr#24
  533 000015EE                 writemem
  203 000015EE                 [                _type = _ABS
  204 000015EE                 writememabs
  177 000015EE F40C 4160       and              r1,addy,#0xe000
  178 000015F2 F10A 0224       adr              r2,writemem_tbl
  179 000015F6 F20F 0E0A       adr              lr,%F0
  180 000015FA         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 000015FA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 000015FE F852 F001       ldr              pc,[r2,r1]
  183 00001602         
  184 00001602         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00001602                 ]
  206 00001602                 [                _type = _ZP
  208                          ]
  209 00001602                 [                _type = _ZPI
  211                          ]
 1141 00001602                 fetch            4
   70 00001602         ;//-----------------------------------------------------
                       ----------------
   71 00001602 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001606 F100 0004       add              r0,r0,#4
   73 0000160A F8CA 00A0       str              r0,clocksh
   74 0000160E         
   75 0000160E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001612         ;//-----------------------------------------------------
                       --------------------
   77 00001612 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2



ARM Macro Assembler    Page 90 


                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001616 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000161C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000161C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001620 F8DA F088       ldr              pc,nexttimeout
 1142 00001624         ;-------------------------------------------------------
                       ---------------------
 1143 00001624         _90                                  ;   BCC *
 1144 00001624         ;-------------------------------------------------------
                       ---------------------
 1145 00001624 F018 0F01       tst              cycles,#CYC_C ;Test Carry
 1146 00001628 F919 0B01       ldrsb            r0,[m6502_pc],#1
 1147 0000162C BF04 4481       addeq            m6502_pc,m6502_pc,r0
 1148 00001630         ; subeq cycles,cycles,#3*CYCLE
 1149 00001630 F5A8 7880       subeq            cycles,cycles,#256
 1150 00001634                 fetch            2
   70 00001634         ;//-----------------------------------------------------
                       ----------------
   71 00001634 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001638 F100 0002       add              r0,r0,#2
   73 0000163C F8CA 00A0       str              r0,clocksh
   74 00001640         
   75 00001640 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001644         ;//-----------------------------------------------------
                       --------------------
   77 00001644 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001648 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000164E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000164E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001652 F8DA F088       ldr              pc,nexttimeout
 1151 00001656         ;-------------------------------------------------------
                       ---------------------
 1152 00001656         _91                                  ;   STA ($nn),Y
 1153 00001656         ;-------------------------------------------------------
                       ---------------------
 1154 00001656                 doIIY
  316 00001656 00000004 
                       _type   SETA             _ABS
  317 00001656 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 0000165A         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 0000165A         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 0000165A F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 0000165E 4458            add              r0,r0,cpu_zpage ;//////////////



ARM Macro Assembler    Page 91 


                                                            ///////////////////
                                                            /////
  322 00001660         
  323 00001660         
  324 00001660 7841            ldrb             r1,[r0,#1]
  325 00001662 EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 00001666 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 0000166A         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
 1155 0000166A                 opSTORE          m6502_a
  532 0000166A EA4F 6015       mov              r0,m6502_a,lsr#24
  533 0000166E                 writemem
  203 0000166E                 [                _type = _ABS
  204 0000166E                 writememabs
  177 0000166E F40C 4160       and              r1,addy,#0xe000
  178 00001672 F10A 0224       adr              r2,writemem_tbl
  179 00001676 F20F 0E0A       adr              lr,%F0
  180 0000167A         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 0000167A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 0000167E F852 F001       ldr              pc,[r2,r1]
  183 00001682         
  184 00001682         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00001682                 ]
  206 00001682                 [                _type = _ZP
  208                          ]
  209 00001682                 [                _type = _ZPI
  211                          ]
 1156 00001682                 fetch            6
   70 00001682         ;//-----------------------------------------------------
                       ----------------
   71 00001682 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001686 F100 0006       add              r0,r0,#6
   73 0000168A F8CA 00A0       str              r0,clocksh
   74 0000168E         
   75 0000168E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001692         ;//-----------------------------------------------------
                       --------------------
   77 00001692 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001696 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000169C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000169C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000016A0 F8DA F088       ldr              pc,nexttimeout
 1157 000016A4         ;-------------------------------------------------------
                       ---------------------
 1158 000016A4         _94                                  ;   STY $nn,X
 1159 000016A4         ;-------------------------------------------------------
                       ---------------------
 1160 000016A4                 doZIXf



ARM Macro Assembler    Page 92 


  366 000016A4 00000003 
                       _type   SETA             _ZPI
  367 000016A4 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 000016A8 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1161 000016AC                 opSTORE          m6502_y
  532 000016AC EA4F 6017       mov              r0,m6502_y,lsr#24
  533 000016B0                 writemem
  203 000016B0                 [                _type = _ABS
  205                          ]
  206 000016B0                 [                _type = _ZP
  208                          ]
  209 000016B0                 [                _type = _ZPI
  210 000016B0                 writememzpi
  194 000016B0         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 000016B0 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 000016B4 F80B 0001       strb             r0,[cpu_zpage,r1]
  197 000016B8         
  198 000016B8         
  211 000016B8                 ]
 1162 000016B8                 fetch            4
   70 000016B8         ;//-----------------------------------------------------
                       ----------------
   71 000016B8 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000016BC F100 0004       add              r0,r0,#4
   73 000016C0 F8CA 00A0       str              r0,clocksh
   74 000016C4         
   75 000016C4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000016C8         ;//-----------------------------------------------------
                       --------------------
   77 000016C8 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000016CC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000016D2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000016D2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000016D6 F8DA F088       ldr              pc,nexttimeout
 1163 000016DA         ;-------------------------------------------------------
                       ---------------------
 1164 000016DA         _95                                  ;   STA $nn,X
 1165 000016DA         ;-------------------------------------------------------
                       ---------------------
 1166 000016DA                 doZIXf
  366 000016DA 00000003 
                       _type   SETA             _ZPI
  367 000016DA F819 CB01       ldrb             addy,[m6502_pc],#1
  368 000016DE EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1167 000016E2                 opSTORE          m6502_a
  532 000016E2 EA4F 6015       mov              r0,m6502_a,lsr#24
  533 000016E6                 writemem
  203 000016E6                 [                _type = _ABS
  205                          ]



ARM Macro Assembler    Page 93 


  206 000016E6                 [                _type = _ZP
  208                          ]
  209 000016E6                 [                _type = _ZPI
  210 000016E6                 writememzpi
  194 000016E6         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 000016E6 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 000016EA F80B 0001       strb             r0,[cpu_zpage,r1]
  197 000016EE         
  198 000016EE         
  211 000016EE                 ]
 1168 000016EE                 fetch            4
   70 000016EE         ;//-----------------------------------------------------
                       ----------------
   71 000016EE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000016F2 F100 0004       add              r0,r0,#4
   73 000016F6 F8CA 00A0       str              r0,clocksh
   74 000016FA         
   75 000016FA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000016FE         ;//-----------------------------------------------------
                       --------------------
   77 000016FE F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001702 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001708         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001708 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000170C F8DA F088       ldr              pc,nexttimeout
 1169 00001710         ;-------------------------------------------------------
                       ---------------------
 1170 00001710         _96                                  ;   STX $nn,Y
 1171 00001710         ;-------------------------------------------------------
                       ---------------------
 1172 00001710                 doZIYf
  381 00001710 00000003 
                       _type   SETA             _ZPI
  382 00001710 F819 CB01       ldrb             addy,[m6502_pc],#1
  383 00001714 EB07 6C0C       add              addy,m6502_y,addy,lsl#24
 1173 00001718                 opSTORE          m6502_x
  532 00001718 EA4F 6016       mov              r0,m6502_x,lsr#24
  533 0000171C                 writemem
  203 0000171C                 [                _type = _ABS
  205                          ]
  206 0000171C                 [                _type = _ZP
  208                          ]
  209 0000171C                 [                _type = _ZPI
  210 0000171C                 writememzpi
  194 0000171C         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 0000171C EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 00001720 F80B 0001       strb             r0,[cpu_zpage,r1]
  197 00001724         



ARM Macro Assembler    Page 94 


  198 00001724         
  211 00001724                 ]
 1174 00001724                 fetch            4
   70 00001724         ;//-----------------------------------------------------
                       ----------------
   71 00001724 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001728 F100 0004       add              r0,r0,#4
   73 0000172C F8CA 00A0       str              r0,clocksh
   74 00001730         
   75 00001730 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001734         ;//-----------------------------------------------------
                       --------------------
   77 00001734 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001738 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000173E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000173E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001742 F8DA F088       ldr              pc,nexttimeout
 1175 00001746         ;-------------------------------------------------------
                       ---------------------
 1176 00001746         _98                                  ;   TYA
 1177 00001746         ;-------------------------------------------------------
                       ---------------------
 1178 00001746 463D            mov              m6502_a,m6502_y
 1179 00001748 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
 1180 0000174C                 fetch            2
   70 0000174C         ;//-----------------------------------------------------
                       ----------------
   71 0000174C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001750 F100 0002       add              r0,r0,#2
   73 00001754 F8CA 00A0       str              r0,clocksh
   74 00001758         
   75 00001758 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000175C         ;//-----------------------------------------------------
                       --------------------
   77 0000175C F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001760 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001766         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001766 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000176A F8DA F088       ldr              pc,nexttimeout
 1181 0000176E         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 95 


 1182 0000176E         _99                                  ;   STA $nnnn,Y
 1183 0000176E         ;-------------------------------------------------------
                       ---------------------
 1184 0000176E                 doAIY
  284 0000176E 00000004 
                       _type   SETA             _ABS
  285 0000176E F819 CB01       ldrb             addy,[m6502_pc],#1
  286 00001772 F819 0B01       ldrb             r0,[m6502_pc],#1
  287 00001776 EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 0000177A EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 0000177E         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1185 0000177E                 opSTORE          m6502_a
  532 0000177E EA4F 6015       mov              r0,m6502_a,lsr#24
  533 00001782                 writemem
  203 00001782                 [                _type = _ABS
  204 00001782                 writememabs
  177 00001782 F40C 4160       and              r1,addy,#0xe000
  178 00001786 F10A 0224       adr              r2,writemem_tbl
  179 0000178A F20F 0E0A       adr              lr,%F0
  180 0000178E         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 0000178E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00001792 F852 F001       ldr              pc,[r2,r1]
  183 00001796         
  184 00001796         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00001796                 ]
  206 00001796                 [                _type = _ZP
  208                          ]
  209 00001796                 [                _type = _ZPI
  211                          ]
 1186 00001796                 fetch            5
   70 00001796         ;//-----------------------------------------------------
                       ----------------
   71 00001796 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000179A F100 0005       add              r0,r0,#5
   73 0000179E F8CA 00A0       str              r0,clocksh
   74 000017A2         
   75 000017A2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000017A6         ;//-----------------------------------------------------
                       --------------------
   77 000017A6 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000017AA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000017B0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000017B0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000017B4 F8DA F088       ldr              pc,nexttimeout
 1187 000017B8         ;-------------------------------------------------------
                       ---------------------
 1188 000017B8         _9A                                  ;   TXS



ARM Macro Assembler    Page 96 


 1189 000017B8         ;-------------------------------------------------------
                       ---------------------
 1190 000017B8 EA4F 6016       mov              r0,m6502_x,lsr#24
 1191 000017BC F88A 0080       strb             r0,m6502_s
 1192 000017C0                 fetch            2
   70 000017C0         ;//-----------------------------------------------------
                       ----------------
   71 000017C0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000017C4 F100 0002       add              r0,r0,#2
   73 000017C8 F8CA 00A0       str              r0,clocksh
   74 000017CC         
   75 000017CC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000017D0         ;//-----------------------------------------------------
                       --------------------
   77 000017D0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000017D4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000017DA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000017DA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000017DE F8DA F088       ldr              pc,nexttimeout
 1193 000017E2         ;-------------------------------------------------------
                       ---------------------
 1194 000017E2         _9D                                  ;   STA $nnnn,X
 1195 000017E2         ;-------------------------------------------------------
                       ---------------------
 1196 000017E2                 doAIX
  274 000017E2 00000004 
                       _type   SETA             _ABS
  275 000017E2 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 000017E6 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 000017EA EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 000017EE EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 000017F2         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1197 000017F2                 opSTORE          m6502_a
  532 000017F2 EA4F 6015       mov              r0,m6502_a,lsr#24
  533 000017F6                 writemem
  203 000017F6                 [                _type = _ABS
  204 000017F6                 writememabs
  177 000017F6 F40C 4160       and              r1,addy,#0xe000
  178 000017FA F10A 0224       adr              r2,writemem_tbl
  179 000017FE F20F 0E0A       adr              lr,%F0
  180 00001802         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00001802 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00001806 F852 F001       ldr              pc,[r2,r1]
  183 0000180A         
  184 0000180A         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 0000180A                 ]
  206 0000180A                 [                _type = _ZP



ARM Macro Assembler    Page 97 


  208                          ]
  209 0000180A                 [                _type = _ZPI
  211                          ]
 1198 0000180A                 fetch            5
   70 0000180A         ;//-----------------------------------------------------
                       ----------------
   71 0000180A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000180E F100 0005       add              r0,r0,#5
   73 00001812 F8CA 00A0       str              r0,clocksh
   74 00001816         
   75 00001816 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000181A         ;//-----------------------------------------------------
                       --------------------
   77 0000181A F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000181E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001824         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001824 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001828 F8DA F088       ldr              pc,nexttimeout
 1199 0000182C         ;-------------------------------------------------------
                       ---------------------
 1200 0000182C         _A0                                  ;   LDY #$nn
 1201 0000182C         ;-------------------------------------------------------
                       ---------------------
 1202 0000182C                 doIMM
  294 0000182C 00000001 
                       _type   SETA             _IMM
 1203 0000182C                 opLOAD           m6502_y
  458 0000182C                 readmems
  162 0000182C                 [                _type = _ABS
  165                          ]
  166 0000182C                 [                _type = _ZP
  168                          ]
  169 0000182C                 [                _type = _IMM
  170 0000182C                 readmemimms
  141 0000182C F919 3B01       ldrsb            m6502_nz,[m6502_pc],#1
  171 00001830                 ]
  459 00001830 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
 1204 00001834                 fetch            2
   70 00001834         ;//-----------------------------------------------------
                       ----------------
   71 00001834 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001838 F100 0002       add              r0,r0,#2
   73 0000183C F8CA 00A0       str              r0,clocksh
   74 00001840         
   75 00001840 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001844         ;//-----------------------------------------------------
                       --------------------
   77 00001844 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2



ARM Macro Assembler    Page 98 


                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001848 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000184E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000184E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001852 F8DA F088       ldr              pc,nexttimeout
 1205 00001856         ;-------------------------------------------------------
                       ---------------------
 1206 00001856         _A1                                  ;   LDA ($nn,X)
 1207 00001856         ;-------------------------------------------------------
                       ---------------------
 1208 00001856                 doIIX
  299 00001856 00000004 
                       _type   SETA             _ABS
  300 00001856 F819 0B01       ldrb             r0,[m6502_pc],#1
  301 0000185A EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 0000185E         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 0000185E EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00001862 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 00001866         
  306 00001866 F100 7080       add              r0,r0,#0x01000000
  307 0000186A         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 0000186A EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 0000186E F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00001872         
  311 00001872 EA4C 2C01       orr              addy,addy,r1,lsl#8
 1209 00001876                 opLOAD           m6502_a
  458 00001876                 readmems
  162 00001876                 [                _type = _ABS
  163 00001876                 readmemabs
  107 00001876 F40C 4160       and              r1,addy,#0xE000
  108 0000187A F20F 0E0A       adr              lr,%F0
  109 0000187E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000187E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001882 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001886         
  113 00001886         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001886 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 0000188A                 ]
  166 0000188A                 [                _type = _ZP
  168                          ]
  169 0000188A                 [                _type = _IMM
  171                          ]
  459 0000188A EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1210 0000188E                 fetch            6



ARM Macro Assembler    Page 99 


   70 0000188E         ;//-----------------------------------------------------
                       ----------------
   71 0000188E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001892 F100 0006       add              r0,r0,#6
   73 00001896 F8CA 00A0       str              r0,clocksh
   74 0000189A         
   75 0000189A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000189E         ;//-----------------------------------------------------
                       --------------------
   77 0000189E F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000018A2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000018A8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000018A8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000018AC F8DA F088       ldr              pc,nexttimeout
 1211 000018B0         ;-------------------------------------------------------
                       ---------------------
 1212 000018B0         _A2                                  ;   LDX #$nn
 1213 000018B0         ;-------------------------------------------------------
                       ---------------------
 1214 000018B0                 doIMM
  294 000018B0 00000001 
                       _type   SETA             _IMM
 1215 000018B0                 opLOAD           m6502_x
  458 000018B0                 readmems
  162 000018B0                 [                _type = _ABS
  165                          ]
  166 000018B0                 [                _type = _ZP
  168                          ]
  169 000018B0                 [                _type = _IMM
  170 000018B0                 readmemimms
  141 000018B0 F919 3B01       ldrsb            m6502_nz,[m6502_pc],#1
  171 000018B4                 ]
  459 000018B4 EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
 1216 000018B8                 fetch            2
   70 000018B8         ;//-----------------------------------------------------
                       ----------------
   71 000018B8 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000018BC F100 0002       add              r0,r0,#2
   73 000018C0 F8CA 00A0       str              r0,clocksh
   74 000018C4         
   75 000018C4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000018C8         ;//-----------------------------------------------------
                       --------------------
   77 000018C8 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000018CC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ



ARM Macro Assembler    Page 100 


                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000018D2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000018D2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000018D6 F8DA F088       ldr              pc,nexttimeout
 1217 000018DA         ;-------------------------------------------------------
                       ---------------------
 1218 000018DA         _A4                                  ;   LDY $nn
 1219 000018DA         ;-------------------------------------------------------
                       ---------------------
 1220 000018DA                 doZ
  346 000018DA 00000002 
                       _type   SETA             _ZP
  347 000018DA F819 CB01       ldrb             addy,[m6502_pc],#1
 1221 000018DE                 opLOAD           m6502_y
  458 000018DE                 readmems
  162 000018DE                 [                _type = _ABS
  165                          ]
  166 000018DE                 [                _type = _ZP
  167 000018DE                 readmemzps
  131 000018DE F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  168 000018E2                 ]
  169 000018E2                 [                _type = _IMM
  171                          ]
  459 000018E2 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
 1222 000018E6                 fetch            3
   70 000018E6         ;//-----------------------------------------------------
                       ----------------
   71 000018E6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000018EA F100 0003       add              r0,r0,#3
   73 000018EE F8CA 00A0       str              r0,clocksh
   74 000018F2         
   75 000018F2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000018F6         ;//-----------------------------------------------------
                       --------------------
   77 000018F6 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000018FA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001900         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001900 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001904 F8DA F088       ldr              pc,nexttimeout
 1223 00001908         ;-------------------------------------------------------
                       ---------------------
 1224 00001908         _A5                                  ;   LDA $nn
 1225 00001908         ;-------------------------------------------------------
                       ---------------------
 1226 00001908                 doZ
  346 00001908 00000002 
                       _type   SETA             _ZP



ARM Macro Assembler    Page 101 


  347 00001908 F819 CB01       ldrb             addy,[m6502_pc],#1
 1227 0000190C                 opLOAD           m6502_a
  458 0000190C                 readmems
  162 0000190C                 [                _type = _ABS
  165                          ]
  166 0000190C                 [                _type = _ZP
  167 0000190C                 readmemzps
  131 0000190C F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  168 00001910                 ]
  169 00001910                 [                _type = _IMM
  171                          ]
  459 00001910 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1228 00001914                 fetch            3
   70 00001914         ;//-----------------------------------------------------
                       ----------------
   71 00001914 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001918 F100 0003       add              r0,r0,#3
   73 0000191C F8CA 00A0       str              r0,clocksh
   74 00001920         
   75 00001920 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001924         ;//-----------------------------------------------------
                       --------------------
   77 00001924 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001928 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000192E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000192E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001932 F8DA F088       ldr              pc,nexttimeout
 1229 00001936         ;-------------------------------------------------------
                       ---------------------
 1230 00001936         _A6                                  ;   LDX $nn
 1231 00001936         ;-------------------------------------------------------
                       ---------------------
 1232 00001936                 doZ
  346 00001936 00000002 
                       _type   SETA             _ZP
  347 00001936 F819 CB01       ldrb             addy,[m6502_pc],#1
 1233 0000193A                 opLOAD           m6502_x
  458 0000193A                 readmems
  162 0000193A                 [                _type = _ABS
  165                          ]
  166 0000193A                 [                _type = _ZP
  167 0000193A                 readmemzps
  131 0000193A F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  168 0000193E                 ]
  169 0000193E                 [                _type = _IMM
  171                          ]
  459 0000193E EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
 1234 00001942                 fetch            3
   70 00001942         ;//-----------------------------------------------------
                       ----------------



ARM Macro Assembler    Page 102 


   71 00001942 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001946 F100 0003       add              r0,r0,#3
   73 0000194A F8CA 00A0       str              r0,clocksh
   74 0000194E         
   75 0000194E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001952         ;//-----------------------------------------------------
                       --------------------
   77 00001952 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001956 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000195C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000195C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001960 F8DA F088       ldr              pc,nexttimeout
 1235 00001964         ;-------------------------------------------------------
                       ---------------------
 1236 00001964         _A8                                  ;   TAY
 1237 00001964         ;-------------------------------------------------------
                       ---------------------
 1238 00001964 462F            mov              m6502_y,m6502_a
 1239 00001966 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
 1240 0000196A                 fetch            2
   70 0000196A         ;//-----------------------------------------------------
                       ----------------
   71 0000196A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000196E F100 0002       add              r0,r0,#2
   73 00001972 F8CA 00A0       str              r0,clocksh
   74 00001976         
   75 00001976 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000197A         ;//-----------------------------------------------------
                       --------------------
   77 0000197A F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000197E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001984         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001984 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001988 F8DA F088       ldr              pc,nexttimeout
 1241 0000198C         ;-------------------------------------------------------
                       ---------------------
 1242 0000198C         _A9                                  ;   LDA #$nn
 1243 0000198C         ;-------------------------------------------------------
                       ---------------------
 1244 0000198C                 doIMM
  294 0000198C 00000001 



ARM Macro Assembler    Page 103 


                       _type   SETA             _IMM
 1245 0000198C                 opLOAD           m6502_a
  458 0000198C                 readmems
  162 0000198C                 [                _type = _ABS
  165                          ]
  166 0000198C                 [                _type = _ZP
  168                          ]
  169 0000198C                 [                _type = _IMM
  170 0000198C                 readmemimms
  141 0000198C F919 3B01       ldrsb            m6502_nz,[m6502_pc],#1
  171 00001990                 ]
  459 00001990 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1246 00001994                 fetch            2
   70 00001994         ;//-----------------------------------------------------
                       ----------------
   71 00001994 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001998 F100 0002       add              r0,r0,#2
   73 0000199C F8CA 00A0       str              r0,clocksh
   74 000019A0         
   75 000019A0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000019A4         ;//-----------------------------------------------------
                       --------------------
   77 000019A4 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000019A8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000019AE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000019AE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000019B2 F8DA F088       ldr              pc,nexttimeout
 1247 000019B6         ;-------------------------------------------------------
                       ---------------------
 1248 000019B6         _AA                                  ;   TAX
 1249 000019B6         ;-------------------------------------------------------
                       ---------------------
 1250 000019B6 462E            mov              m6502_x,m6502_a
 1251 000019B8 EA4F 6326       mov              m6502_nz,m6502_x,asr#24
 1252 000019BC                 fetch            2
   70 000019BC         ;//-----------------------------------------------------
                       ----------------
   71 000019BC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000019C0 F100 0002       add              r0,r0,#2
   73 000019C4 F8CA 00A0       str              r0,clocksh
   74 000019C8         
   75 000019C8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000019CC         ;//-----------------------------------------------------
                       --------------------
   77 000019CC F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000019D0 BF5C F819 



ARM Macro Assembler    Page 104 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000019D6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000019D6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000019DA F8DA F088       ldr              pc,nexttimeout
 1253 000019DE         ;-------------------------------------------------------
                       ---------------------
 1254 000019DE         _AC                                  ;   LDY $nnnn
 1255 000019DE         ;-------------------------------------------------------
                       ---------------------
 1256 000019DE                 doABS
  266 000019DE 00000004 
                       _type   SETA             _ABS
  267 000019DE F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000019E2 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000019E6 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1257 000019EA                 opLOAD           m6502_y
  458 000019EA                 readmems
  162 000019EA                 [                _type = _ABS
  163 000019EA                 readmemabs
  107 000019EA F40C 4160       and              r1,addy,#0xE000
  108 000019EE F20F 0E0A       adr              lr,%F0
  109 000019F2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000019F2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000019F6 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000019FA         
  113 000019FA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 000019FA EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 000019FE                 ]
  166 000019FE                 [                _type = _ZP
  168                          ]
  169 000019FE                 [                _type = _IMM
  171                          ]
  459 000019FE EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
 1258 00001A02                 fetch            4
   70 00001A02         ;//-----------------------------------------------------
                       ----------------
   71 00001A02 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001A06 F100 0004       add              r0,r0,#4
   73 00001A0A F8CA 00A0       str              r0,clocksh
   74 00001A0E         
   75 00001A0E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001A12         ;//-----------------------------------------------------
                       --------------------
   77 00001A12 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001A16 BF5C F819 



ARM Macro Assembler    Page 105 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001A1C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001A1C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001A20 F8DA F088       ldr              pc,nexttimeout
 1259 00001A24         ;-------------------------------------------------------
                       ---------------------
 1260 00001A24         _AD                                  ;   LDA $nnnn
 1261 00001A24         ;-------------------------------------------------------
                       ---------------------
 1262 00001A24                 doABS
  266 00001A24 00000004 
                       _type   SETA             _ABS
  267 00001A24 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001A28 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00001A2C EA4C 2C00       orr              addy,addy,r0,lsl#8
 1263 00001A30                 opLOAD           m6502_a
  458 00001A30                 readmems
  162 00001A30                 [                _type = _ABS
  163 00001A30                 readmemabs
  107 00001A30 F40C 4160       and              r1,addy,#0xE000
  108 00001A34 F20F 0E08       adr              lr,%F0
  109 00001A38         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001A38 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001A3C F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001A40         
  113 00001A40         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001A40 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001A44                 ]
  166 00001A44                 [                _type = _ZP
  168                          ]
  169 00001A44                 [                _type = _IMM
  171                          ]
  459 00001A44 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1264 00001A48                 fetch            4
   70 00001A48         ;//-----------------------------------------------------
                       ----------------
   71 00001A48 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001A4C F100 0004       add              r0,r0,#4
   73 00001A50 F8CA 00A0       str              r0,clocksh
   74 00001A54         
   75 00001A54 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001A58         ;//-----------------------------------------------------
                       --------------------
   77 00001A58 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001A5C BF5C F819 



ARM Macro Assembler    Page 106 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001A62         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001A62 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001A66 F8DA F088       ldr              pc,nexttimeout
 1265 00001A6A         ;-------------------------------------------------------
                       ---------------------
 1266 00001A6A         _AE                                  ;   LDX $nnnn
 1267 00001A6A         ;-------------------------------------------------------
                       ---------------------
 1268 00001A6A                 doABS
  266 00001A6A 00000004 
                       _type   SETA             _ABS
  267 00001A6A F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001A6E F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00001A72 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1269 00001A76                 opLOAD           m6502_x
  458 00001A76                 readmems
  162 00001A76                 [                _type = _ABS
  163 00001A76                 readmemabs
  107 00001A76 F40C 4160       and              r1,addy,#0xE000
  108 00001A7A F20F 0E0A       adr              lr,%F0
  109 00001A7E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001A7E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001A82 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001A86         
  113 00001A86         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001A86 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001A8A                 ]
  166 00001A8A                 [                _type = _ZP
  168                          ]
  169 00001A8A                 [                _type = _IMM
  171                          ]
  459 00001A8A EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
 1270 00001A8E                 fetch            4
   70 00001A8E         ;//-----------------------------------------------------
                       ----------------
   71 00001A8E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001A92 F100 0004       add              r0,r0,#4
   73 00001A96 F8CA 00A0       str              r0,clocksh
   74 00001A9A         
   75 00001A9A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001A9E         ;//-----------------------------------------------------
                       --------------------
   77 00001A9E F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001AA2 BF5C F819 



ARM Macro Assembler    Page 107 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001AA8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001AA8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001AAC F8DA F088       ldr              pc,nexttimeout
 1271 00001AB0         ;-------------------------------------------------------
                       ---------------------
 1272 00001AB0         _B0                                  ;   BCS *
 1273 00001AB0         ;-------------------------------------------------------
                       ---------------------
 1274 00001AB0 F018 0F01       tst              cycles,#CYC_C ;Test Carry
 1275 00001AB4 F919 0B01       ldrsb            r0,[m6502_pc],#1
 1276 00001AB8 BF1C 4481       addne            m6502_pc,m6502_pc,r0
 1277 00001ABC         ; subne cycles,cycles,#3*CYCLE
 1278 00001ABC F5A8 7880       subne            cycles,cycles,#256
 1279 00001AC0                 fetch            2
   70 00001AC0         ;//-----------------------------------------------------
                       ----------------
   71 00001AC0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001AC4 F100 0002       add              r0,r0,#2
   73 00001AC8 F8CA 00A0       str              r0,clocksh
   74 00001ACC         
   75 00001ACC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001AD0         ;//-----------------------------------------------------
                       --------------------
   77 00001AD0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001AD4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001ADA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001ADA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001ADE F8DA F088       ldr              pc,nexttimeout
 1280 00001AE2         ;-------------------------------------------------------
                       ---------------------
 1281 00001AE2         _B1                                  ;   LDA ($nn),Y
 1282 00001AE2         ;-------------------------------------------------------
                       ---------------------
 1283 00001AE2                 doIIY
  316 00001AE2 00000004 
                       _type   SETA             _ABS
  317 00001AE2 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 00001AE6         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 00001AE6         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 00001AE6 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 00001AEA 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 00001AEC         



ARM Macro Assembler    Page 108 


  323 00001AEC         
  324 00001AEC 7841            ldrb             r1,[r0,#1]
  325 00001AEE EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 00001AF2 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 00001AF6         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
 1284 00001AF6                 opLOAD           m6502_a
  458 00001AF6                 readmems
  162 00001AF6                 [                _type = _ABS
  163 00001AF6                 readmemabs
  107 00001AF6 F40C 4160       and              r1,addy,#0xE000
  108 00001AFA F20F 0E0A       adr              lr,%F0
  109 00001AFE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001AFE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001B02 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001B06         
  113 00001B06         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001B06 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001B0A                 ]
  166 00001B0A                 [                _type = _ZP
  168                          ]
  169 00001B0A                 [                _type = _IMM
  171                          ]
  459 00001B0A EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1285 00001B0E                 fetch            5
   70 00001B0E         ;//-----------------------------------------------------
                       ----------------
   71 00001B0E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001B12 F100 0005       add              r0,r0,#5
   73 00001B16 F8CA 00A0       str              r0,clocksh
   74 00001B1A         
   75 00001B1A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001B1E         ;//-----------------------------------------------------
                       --------------------
   77 00001B1E F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001B22 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001B28         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001B28 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001B2C F8DA F088       ldr              pc,nexttimeout
 1286 00001B30         ;-------------------------------------------------------
                       ---------------------
 1287 00001B30         _B4                                  ;   LDY $nn,X
 1288 00001B30         ;-------------------------------------------------------
                       ---------------------
 1289 00001B30                 doZIX



ARM Macro Assembler    Page 109 


  358 00001B30 00000002 
                       _type   SETA             _ZP
  359 00001B30 F819 CB01       ldrb             addy,[m6502_pc],#1
  360 00001B34 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  361 00001B38 F00C 0CFF       and              addy,addy,#0xff 
                                                            ;Rygar needs this
 1290 00001B3C                 opLOAD           m6502_y
  458 00001B3C                 readmems
  162 00001B3C                 [                _type = _ABS
  165                          ]
  166 00001B3C                 [                _type = _ZP
  167 00001B3C                 readmemzps
  131 00001B3C F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  168 00001B40                 ]
  169 00001B40                 [                _type = _IMM
  171                          ]
  459 00001B40 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
 1291 00001B44                 fetch            4
   70 00001B44         ;//-----------------------------------------------------
                       ----------------
   71 00001B44 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001B48 F100 0004       add              r0,r0,#4
   73 00001B4C F8CA 00A0       str              r0,clocksh
   74 00001B50         
   75 00001B50 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001B54         ;//-----------------------------------------------------
                       --------------------
   77 00001B54 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001B58 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001B5E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001B5E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001B62 F8DA F088       ldr              pc,nexttimeout
 1292 00001B66         ;-------------------------------------------------------
                       ---------------------
 1293 00001B66         _B5                                  ;   LDA $nn,X
 1294 00001B66         ;-------------------------------------------------------
                       ---------------------
 1295 00001B66                 doZIX
  358 00001B66 00000002 
                       _type   SETA             _ZP
  359 00001B66 F819 CB01       ldrb             addy,[m6502_pc],#1
  360 00001B6A EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  361 00001B6E F00C 0CFF       and              addy,addy,#0xff 
                                                            ;Rygar needs this
 1296 00001B72                 opLOAD           m6502_a
  458 00001B72                 readmems
  162 00001B72                 [                _type = _ABS
  165                          ]
  166 00001B72                 [                _type = _ZP
  167 00001B72                 readmemzps



ARM Macro Assembler    Page 110 


  131 00001B72 F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  168 00001B76                 ]
  169 00001B76                 [                _type = _IMM
  171                          ]
  459 00001B76 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1297 00001B7A                 fetch            4
   70 00001B7A         ;//-----------------------------------------------------
                       ----------------
   71 00001B7A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001B7E F100 0004       add              r0,r0,#4
   73 00001B82 F8CA 00A0       str              r0,clocksh
   74 00001B86         
   75 00001B86 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001B8A         ;//-----------------------------------------------------
                       --------------------
   77 00001B8A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001B8E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001B94         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001B94 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001B98 F8DA F088       ldr              pc,nexttimeout
 1298 00001B9C         ;-------------------------------------------------------
                       ---------------------
 1299 00001B9C         _B6                                  ;   LDX $nn,Y
 1300 00001B9C         ;-------------------------------------------------------
                       ---------------------
 1301 00001B9C                 doZIY
  373 00001B9C 00000002 
                       _type   SETA             _ZP
  374 00001B9C F819 CB01       ldrb             addy,[m6502_pc],#1
  375 00001BA0 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  376 00001BA4 F00C 0CFF       and              addy,addy,#0xff
 1302 00001BA8                 opLOAD           m6502_x
  458 00001BA8                 readmems
  162 00001BA8                 [                _type = _ABS
  165                          ]
  166 00001BA8                 [                _type = _ZP
  167 00001BA8                 readmemzps
  131 00001BA8 F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  168 00001BAC                 ]
  169 00001BAC                 [                _type = _IMM
  171                          ]
  459 00001BAC EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
 1303 00001BB0                 fetch            4
   70 00001BB0         ;//-----------------------------------------------------
                       ----------------
   71 00001BB0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001BB4 F100 0004       add              r0,r0,#4
   73 00001BB8 F8CA 00A0       str              r0,clocksh
   74 00001BBC         



ARM Macro Assembler    Page 111 


   75 00001BBC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001BC0         ;//-----------------------------------------------------
                       --------------------
   77 00001BC0 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001BC4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001BCA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001BCA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001BCE F8DA F088       ldr              pc,nexttimeout
 1304 00001BD2         ;-------------------------------------------------------
                       ---------------------
 1305 00001BD2         _B8                                  ;   CLV
 1306 00001BD2         ;-------------------------------------------------------
                       ---------------------
 1307 00001BD2 F028 0840       bic              cycles,cycles,#CYC_V
 1308 00001BD6                 fetch            2
   70 00001BD6         ;//-----------------------------------------------------
                       ----------------
   71 00001BD6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001BDA F100 0002       add              r0,r0,#2
   73 00001BDE F8CA 00A0       str              r0,clocksh
   74 00001BE2         
   75 00001BE2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001BE6         ;//-----------------------------------------------------
                       --------------------
   77 00001BE6 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001BEA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001BF0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001BF0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001BF4 F8DA F088       ldr              pc,nexttimeout
 1309 00001BF8         ;-------------------------------------------------------
                       ---------------------
 1310 00001BF8         _B9                                  ;   LDA $nnnn,Y
 1311 00001BF8         ;-------------------------------------------------------
                       ---------------------
 1312 00001BF8                 doAIY
  284 00001BF8 00000004 
                       _type   SETA             _ABS
  285 00001BF8 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 00001BFC F819 0B01       ldrb             r0,[m6502_pc],#1
  287 00001C00 EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 00001C04 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 00001C08         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this



ARM Macro Assembler    Page 112 


 1313 00001C08                 opLOAD           m6502_a
  458 00001C08                 readmems
  162 00001C08                 [                _type = _ABS
  163 00001C08                 readmemabs
  107 00001C08 F40C 4160       and              r1,addy,#0xE000
  108 00001C0C F20F 0E08       adr              lr,%F0
  109 00001C10         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001C10 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001C14 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001C18         
  113 00001C18         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001C18 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001C1C                 ]
  166 00001C1C                 [                _type = _ZP
  168                          ]
  169 00001C1C                 [                _type = _IMM
  171                          ]
  459 00001C1C EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1314 00001C20                 fetch            4
   70 00001C20         ;//-----------------------------------------------------
                       ----------------
   71 00001C20 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001C24 F100 0004       add              r0,r0,#4
   73 00001C28 F8CA 00A0       str              r0,clocksh
   74 00001C2C         
   75 00001C2C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001C30         ;//-----------------------------------------------------
                       --------------------
   77 00001C30 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001C34 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001C3A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001C3A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001C3E F8DA F088       ldr              pc,nexttimeout
 1315 00001C42         ;-------------------------------------------------------
                       ---------------------
 1316 00001C42         _BA                                  ;   TSX
 1317 00001C42         ;-------------------------------------------------------
                       ---------------------
 1318 00001C42 F89A 6080       ldrb             m6502_x,m6502_s
 1319 00001C46 EA4F 6606       mov              m6502_x,m6502_x,lsl#24
 1320 00001C4A EA4F 6326       mov              m6502_nz,m6502_x,asr#24
 1321 00001C4E                 fetch            2
   70 00001C4E         ;//-----------------------------------------------------
                       ----------------



ARM Macro Assembler    Page 113 


   71 00001C4E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001C52 F100 0002       add              r0,r0,#2
   73 00001C56 F8CA 00A0       str              r0,clocksh
   74 00001C5A         
   75 00001C5A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001C5E         ;//-----------------------------------------------------
                       --------------------
   77 00001C5E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001C62 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001C68         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001C68 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001C6C F8DA F088       ldr              pc,nexttimeout
 1322 00001C70         ;-------------------------------------------------------
                       ---------------------
 1323 00001C70         _BC                                  ;   LDY $nnnn,X
 1324 00001C70         ;-------------------------------------------------------
                       ---------------------
 1325 00001C70                 doAIX
  274 00001C70 00000004 
                       _type   SETA             _ABS
  275 00001C70 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00001C74 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00001C78 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00001C7C EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00001C80         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1326 00001C80                 opLOAD           m6502_y
  458 00001C80                 readmems
  162 00001C80                 [                _type = _ABS
  163 00001C80                 readmemabs
  107 00001C80 F40C 4160       and              r1,addy,#0xE000
  108 00001C84 F20F 0E08       adr              lr,%F0
  109 00001C88         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001C88 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001C8C F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001C90         
  113 00001C90         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001C90 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001C94                 ]
  166 00001C94                 [                _type = _ZP
  168                          ]
  169 00001C94                 [                _type = _IMM
  171                          ]
  459 00001C94 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
 1327 00001C98                 fetch            4



ARM Macro Assembler    Page 114 


   70 00001C98         ;//-----------------------------------------------------
                       ----------------
   71 00001C98 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001C9C F100 0004       add              r0,r0,#4
   73 00001CA0 F8CA 00A0       str              r0,clocksh
   74 00001CA4         
   75 00001CA4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001CA8         ;//-----------------------------------------------------
                       --------------------
   77 00001CA8 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001CAC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001CB2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001CB2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001CB6 F8DA F088       ldr              pc,nexttimeout
 1328 00001CBA         ;-------------------------------------------------------
                       ---------------------
 1329 00001CBA         _BD                                  ;   LDA $nnnn,X
 1330 00001CBA         ;-------------------------------------------------------
                       ---------------------
 1331 00001CBA                 doAIX
  274 00001CBA 00000004 
                       _type   SETA             _ABS
  275 00001CBA F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00001CBE F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00001CC2 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00001CC6 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 00001CCA         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1332 00001CCA                 opLOAD           m6502_a
  458 00001CCA                 readmems
  162 00001CCA                 [                _type = _ABS
  163 00001CCA                 readmemabs
  107 00001CCA F40C 4160       and              r1,addy,#0xE000
  108 00001CCE F20F 0E0A       adr              lr,%F0
  109 00001CD2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001CD2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001CD6 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001CDA         
  113 00001CDA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001CDA EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001CDE                 ]
  166 00001CDE                 [                _type = _ZP
  168                          ]
  169 00001CDE                 [                _type = _IMM
  171                          ]



ARM Macro Assembler    Page 115 


  459 00001CDE EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
 1333 00001CE2                 fetch            4
   70 00001CE2         ;//-----------------------------------------------------
                       ----------------
   71 00001CE2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001CE6 F100 0004       add              r0,r0,#4
   73 00001CEA F8CA 00A0       str              r0,clocksh
   74 00001CEE         
   75 00001CEE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001CF2         ;//-----------------------------------------------------
                       --------------------
   77 00001CF2 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001CF6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001CFC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001CFC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001D00 F8DA F088       ldr              pc,nexttimeout
 1334 00001D04         ;-------------------------------------------------------
                       ---------------------
 1335 00001D04         _BE                                  ;   LDX $nnnn,Y
 1336 00001D04         ;-------------------------------------------------------
                       ---------------------
 1337 00001D04                 doAIY
  284 00001D04 00000004 
                       _type   SETA             _ABS
  285 00001D04 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 00001D08 F819 0B01       ldrb             r0,[m6502_pc],#1
  287 00001D0C EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 00001D10 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 00001D14         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1338 00001D14                 opLOAD           m6502_x
  458 00001D14                 readmems
  162 00001D14                 [                _type = _ABS
  163 00001D14                 readmemabs
  107 00001D14 F40C 4160       and              r1,addy,#0xE000
  108 00001D18 F20F 0E08       adr              lr,%F0
  109 00001D1C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001D1C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001D20 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001D24         
  113 00001D24         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  164 00001D24 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  165 00001D28                 ]
  166 00001D28                 [                _type = _ZP
  168                          ]



ARM Macro Assembler    Page 116 


  169 00001D28                 [                _type = _IMM
  171                          ]
  459 00001D28 EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
 1339 00001D2C                 fetch            4
   70 00001D2C         ;//-----------------------------------------------------
                       ----------------
   71 00001D2C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001D30 F100 0004       add              r0,r0,#4
   73 00001D34 F8CA 00A0       str              r0,clocksh
   74 00001D38         
   75 00001D38 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001D3C         ;//-----------------------------------------------------
                       --------------------
   77 00001D3C F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001D40 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001D46         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001D46 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001D4A F8DA F088       ldr              pc,nexttimeout
 1340 00001D4E         ;-------------------------------------------------------
                       ---------------------
 1341 00001D4E         _C0                                  ;   CPY #$nn
 1342 00001D4E         ;-------------------------------------------------------
                       ---------------------
 1343 00001D4E                 doIMM
  294 00001D4E 00000001 
                       _type   SETA             _IMM
 1344 00001D4E                 opCOMP           m6502_y
  427 00001D4E                 readmem
  146 00001D4E                 [                _type = _ABS
  148                          ]
  149 00001D4E                 [                _type = _ZP
  151                          ]
  152 00001D4E                 [                _type = _ZPI
  154                          ]
  155 00001D4E                 [                _type = _IMM
  156 00001D4E                 readmemimm
  136 00001D4E F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 00001D52                 ]
  428 00001D52 EBB7 6300       subs             m6502_nz,m6502_y,r0,lsl#24
  429 00001D56 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001D5A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1345 00001D5E                 fetch_c          2
   86 00001D5E         ;//-----------------------------------------------------
                       ----------------
   87 00001D5E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001D62 F100 0002       add              r0,r0,#2
   89 00001D66 F8CA 00A0       str              r0,clocksh
   90 00001D6A         



ARM Macro Assembler    Page 117 


   91 00001D6A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001D6E         ;//-----------------------------------------------------
                       --------------------
   93 00001D6E F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 00001D72 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001D78         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001D78 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001D7C F8DA F088       ldr              pc,nexttimeout
 1346 00001D80         ;-------------------------------------------------------
                       ---------------------
 1347 00001D80         _C1                                  ;   CMP ($nn,X)
 1348 00001D80         ;-------------------------------------------------------
                       ---------------------
 1349 00001D80                 doIIX
  299 00001D80 00000004 
                       _type   SETA             _ABS
  300 00001D80 F819 0B01       ldrb             r0,[m6502_pc],#1
  301 00001D84 EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00001D88         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00001D88 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00001D8C F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 00001D90         
  306 00001D90 F100 7080       add              r0,r0,#0x01000000
  307 00001D94         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00001D94 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00001D98 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00001D9C         
  311 00001D9C EA4C 2C01       orr              addy,addy,r1,lsl#8
 1350 00001DA0                 opCOMP           m6502_a
  427 00001DA0                 readmem
  146 00001DA0                 [                _type = _ABS
  147 00001DA0                 readmemabs
  107 00001DA0 F40C 4160       and              r1,addy,#0xE000
  108 00001DA4 F20F 0E08       adr              lr,%F0
  109 00001DA8         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001DA8 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001DAC F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001DB0         
  113 00001DB0         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00001DB0                 ]
  149 00001DB0                 [                _type = _ZP
  151                          ]
  152 00001DB0                 [                _type = _ZPI
  154                          ]
  155 00001DB0                 [                _type = _IMM
  157                          ]
  428 00001DB0 EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24



ARM Macro Assembler    Page 118 


  429 00001DB4 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001DB8 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1351 00001DBC                 fetch_c          6
   86 00001DBC         ;//-----------------------------------------------------
                       ----------------
   87 00001DBC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001DC0 F100 0006       add              r0,r0,#6
   89 00001DC4 F8CA 00A0       str              r0,clocksh
   90 00001DC8         
   91 00001DC8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001DCC         ;//-----------------------------------------------------
                       --------------------
   93 00001DCC F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 00001DD0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001DD6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001DD6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001DDA F8DA F088       ldr              pc,nexttimeout
 1352 00001DDE         ;-------------------------------------------------------
                       ---------------------
 1353 00001DDE         _C4                                  ;   CPY $nn
 1354 00001DDE         ;-------------------------------------------------------
                       ---------------------
 1355 00001DDE                 doZ
  346 00001DDE 00000002 
                       _type   SETA             _ZP
  347 00001DDE F819 CB01       ldrb             addy,[m6502_pc],#1
 1356 00001DE2                 opCOMP           m6502_y
  427 00001DE2                 readmem
  146 00001DE2                 [                _type = _ABS
  148                          ]
  149 00001DE2                 [                _type = _ZP
  150 00001DE2                 readmemzp
  118 00001DE2 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00001DE6                 ]
  152 00001DE6                 [                _type = _ZPI
  154                          ]
  155 00001DE6                 [                _type = _IMM
  157                          ]
  428 00001DE6 EBB7 6300       subs             m6502_nz,m6502_y,r0,lsl#24
  429 00001DEA EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001DEE F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1357 00001DF2                 fetch_c          3
   86 00001DF2         ;//-----------------------------------------------------
                       ----------------
   87 00001DF2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001DF6 F100 0003       add              r0,r0,#3
   89 00001DFA F8CA 00A0       str              r0,clocksh
   90 00001DFE         
   91 00001DFE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001E02         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 119 


   93 00001E02 F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   94 00001E06 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001E0C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001E0C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001E10 F8DA F088       ldr              pc,nexttimeout
 1358 00001E14         ;-------------------------------------------------------
                       ---------------------
 1359 00001E14         _C5                                  ;   CMP $nn
 1360 00001E14         ;-------------------------------------------------------
                       ---------------------
 1361 00001E14                 doZ
  346 00001E14 00000002 
                       _type   SETA             _ZP
  347 00001E14 F819 CB01       ldrb             addy,[m6502_pc],#1
 1362 00001E18                 opCOMP           m6502_a
  427 00001E18                 readmem
  146 00001E18                 [                _type = _ABS
  148                          ]
  149 00001E18                 [                _type = _ZP
  150 00001E18                 readmemzp
  118 00001E18 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00001E1C                 ]
  152 00001E1C                 [                _type = _ZPI
  154                          ]
  155 00001E1C                 [                _type = _IMM
  157                          ]
  428 00001E1C EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 00001E20 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001E24 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1363 00001E28                 fetch_c          3
   86 00001E28         ;//-----------------------------------------------------
                       ----------------
   87 00001E28 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001E2C F100 0003       add              r0,r0,#3
   89 00001E30 F8CA 00A0       str              r0,clocksh
   90 00001E34         
   91 00001E34 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001E38         ;//-----------------------------------------------------
                       --------------------
   93 00001E38 F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   94 00001E3C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001E42         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001E42 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001E46 F8DA F088       ldr              pc,nexttimeout
 1364 00001E4A         ;-------------------------------------------------------
                       ---------------------
 1365 00001E4A         _C6                                  ;   DEC $nn
 1366 00001E4A         ;-------------------------------------------------------
                       ---------------------
 1367 00001E4A                 doZ
  346 00001E4A 00000002 
                       _type   SETA             _ZP



ARM Macro Assembler    Page 120 


  347 00001E4A F819 CB01       ldrb             addy,[m6502_pc],#1
 1368 00001E4E                 opDEC
  435 00001E4E                 readmem
  146 00001E4E                 [                _type = _ABS
  148                          ]
  149 00001E4E                 [                _type = _ZP
  150 00001E4E                 readmemzp
  118 00001E4E F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00001E52                 ]
  152 00001E52                 [                _type = _ZPI
  154                          ]
  155 00001E52                 [                _type = _IMM
  157                          ]
  436 00001E52 F1A0 0001       sub              r0,r0,#1
  437 00001E56 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  438 00001E5A                 writemem
  203 00001E5A                 [                _type = _ABS
  205                          ]
  206 00001E5A                 [                _type = _ZP
  207 00001E5A                 writememzp
  189 00001E5A F80B 000C       strb             r0,[cpu_zpage,addy]
  208 00001E5E                 ]
  209 00001E5E                 [                _type = _ZPI
  211                          ]
 1369 00001E5E                 fetch            5
   70 00001E5E         ;//-----------------------------------------------------
                       ----------------
   71 00001E5E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001E62 F100 0005       add              r0,r0,#5
   73 00001E66 F8CA 00A0       str              r0,clocksh
   74 00001E6A         
   75 00001E6A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001E6E         ;//-----------------------------------------------------
                       --------------------
   77 00001E6E F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001E72 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001E78         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001E78 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001E7C F8DA F088       ldr              pc,nexttimeout
 1370 00001E80         ;-------------------------------------------------------
                       ---------------------
 1371 00001E80         _C8                                  ;   INY
 1372 00001E80         ;-------------------------------------------------------
                       ---------------------
 1373 00001E80 F107 7780       add              m6502_y,m6502_y,#0x01000000
 1374 00001E84 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
 1375 00001E88                 fetch            2
   70 00001E88         ;//-----------------------------------------------------
                       ----------------
   71 00001E88 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 121 


                                                            ÓÊý
   72 00001E8C F100 0002       add              r0,r0,#2
   73 00001E90 F8CA 00A0       str              r0,clocksh
   74 00001E94         
   75 00001E94 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001E98         ;//-----------------------------------------------------
                       --------------------
   77 00001E98 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001E9C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001EA2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001EA2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001EA6 F8DA F088       ldr              pc,nexttimeout
 1376 00001EAA         ;-------------------------------------------------------
                       ---------------------
 1377 00001EAA         _C9                                  ;   CMP #$nn
 1378 00001EAA         ;-------------------------------------------------------
                       ---------------------
 1379 00001EAA                 doIMM
  294 00001EAA 00000001 
                       _type   SETA             _IMM
 1380 00001EAA                 opCOMP           m6502_a
  427 00001EAA                 readmem
  146 00001EAA                 [                _type = _ABS
  148                          ]
  149 00001EAA                 [                _type = _ZP
  151                          ]
  152 00001EAA                 [                _type = _ZPI
  154                          ]
  155 00001EAA                 [                _type = _IMM
  156 00001EAA                 readmemimm
  136 00001EAA F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 00001EAE                 ]
  428 00001EAE EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 00001EB2 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001EB6 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1381 00001EBA                 fetch_c          2
   86 00001EBA         ;//-----------------------------------------------------
                       ----------------
   87 00001EBA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001EBE F100 0002       add              r0,r0,#2
   89 00001EC2 F8CA 00A0       str              r0,clocksh
   90 00001EC6         
   91 00001EC6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001ECA         ;//-----------------------------------------------------
                       --------------------
   93 00001ECA F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 00001ECE BF5C F819 



ARM Macro Assembler    Page 122 


              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001ED4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001ED4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001ED8 F8DA F088       ldr              pc,nexttimeout
 1382 00001EDC         ;-------------------------------------------------------
                       ---------------------
 1383 00001EDC         _CA                                  ;   DEX
 1384 00001EDC         ;-------------------------------------------------------
                       ---------------------
 1385 00001EDC F1A6 7680       sub              m6502_x,m6502_x,#0x01000000
 1386 00001EE0 EA4F 6326       mov              m6502_nz,m6502_x,asr#24
 1387 00001EE4                 fetch            2
   70 00001EE4         ;//-----------------------------------------------------
                       ----------------
   71 00001EE4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001EE8 F100 0002       add              r0,r0,#2
   73 00001EEC F8CA 00A0       str              r0,clocksh
   74 00001EF0         
   75 00001EF0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001EF4         ;//-----------------------------------------------------
                       --------------------
   77 00001EF4 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001EF8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001EFE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001EFE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001F02 F8DA F088       ldr              pc,nexttimeout
 1388 00001F06         ;-------------------------------------------------------
                       ---------------------
 1389 00001F06         _CC                                  ;   CPY $nnnn
 1390 00001F06         ;-------------------------------------------------------
                       ---------------------
 1391 00001F06                 doABS
  266 00001F06 00000004 
                       _type   SETA             _ABS
  267 00001F06 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001F0A F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00001F0E EA4C 2C00       orr              addy,addy,r0,lsl#8
 1392 00001F12                 opCOMP           m6502_y
  427 00001F12                 readmem
  146 00001F12                 [                _type = _ABS
  147 00001F12                 readmemabs
  107 00001F12 F40C 4160       and              r1,addy,#0xE000
  108 00001F16 F20F 0E0A       adr              lr,%F0
  109 00001F1A         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001F1A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001F1E F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001F22         
  113 00001F22         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 123 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00001F22                 ]
  149 00001F22                 [                _type = _ZP
  151                          ]
  152 00001F22                 [                _type = _ZPI
  154                          ]
  155 00001F22                 [                _type = _IMM
  157                          ]
  428 00001F22 EBB7 6300       subs             m6502_nz,m6502_y,r0,lsl#24
  429 00001F26 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001F2A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1393 00001F2E                 fetch_c          4
   86 00001F2E         ;//-----------------------------------------------------
                       ----------------
   87 00001F2E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001F32 F100 0004       add              r0,r0,#4
   89 00001F36 F8CA 00A0       str              r0,clocksh
   90 00001F3A         
   91 00001F3A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001F3E         ;//-----------------------------------------------------
                       --------------------
   93 00001F3E F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 00001F42 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001F48         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001F48 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001F4C F8DA F088       ldr              pc,nexttimeout
 1394 00001F50         ;-------------------------------------------------------
                       ---------------------
 1395 00001F50         _CD                                  ;   CMP $nnnn
 1396 00001F50         ;-------------------------------------------------------
                       ---------------------
 1397 00001F50                 doABS
  266 00001F50 00000004 
                       _type   SETA             _ABS
  267 00001F50 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001F54 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00001F58 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1398 00001F5C                 opCOMP           m6502_a
  427 00001F5C                 readmem
  146 00001F5C                 [                _type = _ABS
  147 00001F5C                 readmemabs
  107 00001F5C F40C 4160       and              r1,addy,#0xE000
  108 00001F60 F20F 0E08       adr              lr,%F0
  109 00001F64         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001F64 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001F68 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001F6C         
  113 00001F6C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I



ARM Macro Assembler    Page 124 


                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00001F6C                 ]
  149 00001F6C                 [                _type = _ZP
  151                          ]
  152 00001F6C                 [                _type = _ZPI
  154                          ]
  155 00001F6C                 [                _type = _IMM
  157                          ]
  428 00001F6C EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 00001F70 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00001F74 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1399 00001F78                 fetch_c          4
   86 00001F78         ;//-----------------------------------------------------
                       ----------------
   87 00001F78 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00001F7C F100 0004       add              r0,r0,#4
   89 00001F80 F8CA 00A0       str              r0,clocksh
   90 00001F84         
   91 00001F84 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00001F88         ;//-----------------------------------------------------
                       --------------------
   93 00001F88 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 00001F8C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00001F92         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00001F92 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00001F96 F8DA F088       ldr              pc,nexttimeout
 1400 00001F9A         ;-------------------------------------------------------
                       ---------------------
 1401 00001F9A         _CE                                  ;   DEC $nnnn
 1402 00001F9A         ;-------------------------------------------------------
                       ---------------------
 1403 00001F9A                 doABS
  266 00001F9A 00000004 
                       _type   SETA             _ABS
  267 00001F9A F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00001F9E F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00001FA2 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1404 00001FA6                 opDEC
  435 00001FA6                 readmem
  146 00001FA6                 [                _type = _ABS
  147 00001FA6                 readmemabs
  107 00001FA6 F40C 4160       and              r1,addy,#0xE000
  108 00001FAA F20F 0E0A       adr              lr,%F0
  109 00001FAE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00001FAE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00001FB2 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00001FB6         
  113 00001FB6         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 



ARM Macro Assembler    Page 125 


                                                            preserved for RMW i
                                                            nstructions
  148 00001FB6                 ]
  149 00001FB6                 [                _type = _ZP
  151                          ]
  152 00001FB6                 [                _type = _ZPI
  154                          ]
  155 00001FB6                 [                _type = _IMM
  157                          ]
  436 00001FB6 F1A0 0001       sub              r0,r0,#1
  437 00001FBA EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  438 00001FBE                 writemem
  203 00001FBE                 [                _type = _ABS
  204 00001FBE                 writememabs
  177 00001FBE F40C 4160       and              r1,addy,#0xe000
  178 00001FC2 F10A 0224       adr              r2,writemem_tbl
  179 00001FC6 F20F 0E0A       adr              lr,%F0
  180 00001FCA         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00001FCA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00001FCE F852 F001       ldr              pc,[r2,r1]
  183 00001FD2         
  184 00001FD2         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00001FD2                 ]
  206 00001FD2                 [                _type = _ZP
  208                          ]
  209 00001FD2                 [                _type = _ZPI
  211                          ]
 1405 00001FD2                 fetch            6
   70 00001FD2         ;//-----------------------------------------------------
                       ----------------
   71 00001FD2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00001FD6 F100 0006       add              r0,r0,#6
   73 00001FDA F8CA 00A0       str              r0,clocksh
   74 00001FDE         
   75 00001FDE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00001FE2         ;//-----------------------------------------------------
                       --------------------
   77 00001FE2 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00001FE6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00001FEC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00001FEC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00001FF0 F8DA F088       ldr              pc,nexttimeout
 1406 00001FF4         ;-------------------------------------------------------
                       ---------------------
 1407 00001FF4         _D0                                  ;   BNE *
 1408 00001FF4         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 126 


 1409 00001FF4 F013 0FFF       tst              m6502_nz,#0xff
 1410 00001FF8 F919 0B01       ldrsb            r0,[m6502_pc],#1
 1411 00001FFC BF1C 4481       addne            m6502_pc,m6502_pc,r0
 1412 00002000         ; subne cycles,cycles,#3*CYCLE
 1413 00002000 F5A8 7880       subne            cycles,cycles,#256
 1414 00002004                 fetch            2
   70 00002004         ;//-----------------------------------------------------
                       ----------------
   71 00002004 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002008 F100 0002       add              r0,r0,#2
   73 0000200C F8CA 00A0       str              r0,clocksh
   74 00002010         
   75 00002010 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002014         ;//-----------------------------------------------------
                       --------------------
   77 00002014 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002018 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000201E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000201E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00002022 F8DA F088       ldr              pc,nexttimeout
 1415 00002026         ;-------------------------------------------------------
                       ---------------------
 1416 00002026         _D1                                  ;   CMP ($nn),Y
 1417 00002026         ;-------------------------------------------------------
                       ---------------------
 1418 00002026                 doIIY
  316 00002026 00000004 
                       _type   SETA             _ABS
  317 00002026 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 0000202A         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 0000202A         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 0000202A F810 C00B       ldrb             addy,[r0,cpu_zpage]
  321 0000202E 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 00002030         
  323 00002030         
  324 00002030 7841            ldrb             r1,[r0,#1]
  325 00002032 EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 00002036 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 0000203A         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
 1419 0000203A                 opCOMP           m6502_a
  427 0000203A                 readmem
  146 0000203A                 [                _type = _ABS
  147 0000203A                 readmemabs
  107 0000203A F40C 4160       and              r1,addy,#0xE000
  108 0000203E F20F 0E0A       adr              lr,%F0
  109 00002042         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)



ARM Macro Assembler    Page 127 


  110 00002042 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002046 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000204A         
  113 0000204A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000204A                 ]
  149 0000204A                 [                _type = _ZP
  151                          ]
  152 0000204A                 [                _type = _ZPI
  154                          ]
  155 0000204A                 [                _type = _IMM
  157                          ]
  428 0000204A EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 0000204E EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00002052 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1420 00002056                 fetch_c          5
   86 00002056         ;//-----------------------------------------------------
                       ----------------
   87 00002056 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 0000205A F100 0005       add              r0,r0,#5
   89 0000205E F8CA 00A0       str              r0,clocksh
   90 00002062         
   91 00002062 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00002066         ;//-----------------------------------------------------
                       --------------------
   93 00002066 F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   94 0000206A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00002070         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002070 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00002074 F8DA F088       ldr              pc,nexttimeout
 1421 00002078         ;-------------------------------------------------------
                       ---------------------
 1422 00002078         _D5                                  ;   CMP $nn,X
 1423 00002078         ;-------------------------------------------------------
                       ---------------------
 1424 00002078                 doZIXf
  366 00002078 00000003 
                       _type   SETA             _ZPI
  367 00002078 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 0000207C EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1425 00002080                 opCOMP           m6502_a
  427 00002080                 readmem
  146 00002080                 [                _type = _ABS
  148                          ]
  149 00002080                 [                _type = _ZP
  151                          ]
  152 00002080                 [                _type = _ZPI
  153 00002080                 readmemzpi
  123 00002080         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 00002080 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ



ARM Macro Assembler    Page 128 


  125 00002084 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00002088         
  154 00002088                 ]
  155 00002088                 [                _type = _IMM
  157                          ]
  428 00002088 EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 0000208C EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00002090 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1426 00002094                 fetch_c          4
   86 00002094         ;//-----------------------------------------------------
                       ----------------
   87 00002094 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00002098 F100 0004       add              r0,r0,#4
   89 0000209C F8CA 00A0       str              r0,clocksh
   90 000020A0         
   91 000020A0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000020A4         ;//-----------------------------------------------------
                       --------------------
   93 000020A4 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 000020A8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000020AE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000020AE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000020B2 F8DA F088       ldr              pc,nexttimeout
 1427 000020B6         ;-------------------------------------------------------
                       ---------------------
 1428 000020B6         _D6                                  ;   DEC $nn,X
 1429 000020B6         ;-------------------------------------------------------
                       ---------------------
 1430 000020B6                 doZIXf
  366 000020B6 00000003 
                       _type   SETA             _ZPI
  367 000020B6 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 000020BA EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1431 000020BE                 opDEC
  435 000020BE                 readmem
  146 000020BE                 [                _type = _ABS
  148                          ]
  149 000020BE                 [                _type = _ZP
  151                          ]
  152 000020BE                 [                _type = _ZPI
  153 000020BE                 readmemzpi
  123 000020BE         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 000020BE EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 000020C2 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 000020C6         
  154 000020C6                 ]
  155 000020C6                 [                _type = _IMM
  157                          ]
  436 000020C6 F1A0 0001       sub              r0,r0,#1
  437 000020CA EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  438 000020CE                 writemem
  203 000020CE                 [                _type = _ABS
  205                          ]
  206 000020CE                 [                _type = _ZP



ARM Macro Assembler    Page 129 


  208                          ]
  209 000020CE                 [                _type = _ZPI
  210 000020CE                 writememzpi
  194 000020CE         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 000020CE EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 000020D2 F80B 0001       strb             r0,[cpu_zpage,r1]
  197 000020D6         
  198 000020D6         
  211 000020D6                 ]
 1432 000020D6                 fetch            6
   70 000020D6         ;//-----------------------------------------------------
                       ----------------
   71 000020D6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000020DA F100 0006       add              r0,r0,#6
   73 000020DE F8CA 00A0       str              r0,clocksh
   74 000020E2         
   75 000020E2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000020E6         ;//-----------------------------------------------------
                       --------------------
   77 000020E6 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000020EA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000020F0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000020F0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000020F4 F8DA F088       ldr              pc,nexttimeout
 1433 000020F8         ;-------------------------------------------------------
                       ---------------------
 1434 000020F8         _D8                                  ;   CLD
 1435 000020F8         ;-------------------------------------------------------
                       ---------------------
 1436 000020F8 F028 0808       bic              cycles,cycles,#CYC_D
 1437 000020FC                 fetch            2
   70 000020FC         ;//-----------------------------------------------------
                       ----------------
   71 000020FC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002100 F100 0002       add              r0,r0,#2
   73 00002104 F8CA 00A0       str              r0,clocksh
   74 00002108         
   75 00002108 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000210C         ;//-----------------------------------------------------
                       --------------------
   77 0000210C F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002110 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë



ARM Macro Assembler    Page 130 


   79 00002116         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002116 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000211A F8DA F088       ldr              pc,nexttimeout
 1438 0000211E         ;-------------------------------------------------------
                       ---------------------
 1439 0000211E         _D9                                  ;   CMP $nnnn,Y
 1440 0000211E         ;-------------------------------------------------------
                       ---------------------
 1441 0000211E                 doAIY
  284 0000211E 00000004 
                       _type   SETA             _ABS
  285 0000211E F819 CB01       ldrb             addy,[m6502_pc],#1
  286 00002122 F819 0B01       ldrb             r0,[m6502_pc],#1
  287 00002126 EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 0000212A EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 0000212E         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1442 0000212E                 opCOMP           m6502_a
  427 0000212E                 readmem
  146 0000212E                 [                _type = _ABS
  147 0000212E                 readmemabs
  107 0000212E F40C 4160       and              r1,addy,#0xE000
  108 00002132 F20F 0E0A       adr              lr,%F0
  109 00002136         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002136 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 0000213A F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000213E         
  113 0000213E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000213E                 ]
  149 0000213E                 [                _type = _ZP
  151                          ]
  152 0000213E                 [                _type = _ZPI
  154                          ]
  155 0000213E                 [                _type = _IMM
  157                          ]
  428 0000213E EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 00002142 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00002146 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1443 0000214A                 fetch_c          4
   86 0000214A         ;//-----------------------------------------------------
                       ----------------
   87 0000214A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 0000214E F100 0004       add              r0,r0,#4
   89 00002152 F8CA 00A0       str              r0,clocksh
   90 00002156         
   91 00002156 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000215A         ;//-----------------------------------------------------
                       --------------------
   93 0000215A F578 6880       sbcs             cycles,cycles,#4*256 



ARM Macro Assembler    Page 131 


                                                            ;//CYCLE=256
   94 0000215E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00002164         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002164 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00002168 F8DA F088       ldr              pc,nexttimeout
 1444 0000216C         ;-------------------------------------------------------
                       ---------------------
 1445 0000216C         _DD                                  ;   CMP $nnnn,X
 1446 0000216C         ;-------------------------------------------------------
                       ---------------------
 1447 0000216C                 doAIX
  274 0000216C 00000004 
                       _type   SETA             _ABS
  275 0000216C F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00002170 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00002174 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00002178 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 0000217C         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1448 0000217C                 opCOMP           m6502_a
  427 0000217C                 readmem
  146 0000217C                 [                _type = _ABS
  147 0000217C                 readmemabs
  107 0000217C F40C 4160       and              r1,addy,#0xE000
  108 00002180 F20F 0E08       adr              lr,%F0
  109 00002184         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002184 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002188 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000218C         
  113 0000218C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000218C                 ]
  149 0000218C                 [                _type = _ZP
  151                          ]
  152 0000218C                 [                _type = _ZPI
  154                          ]
  155 0000218C                 [                _type = _IMM
  157                          ]
  428 0000218C EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  429 00002190 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00002194 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1449 00002198                 fetch_c          4
   86 00002198         ;//-----------------------------------------------------
                       ----------------
   87 00002198 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 0000219C F100 0004       add              r0,r0,#4
   89 000021A0 F8CA 00A0       str              r0,clocksh
   90 000021A4         
   91 000021A4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000021A8         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 132 


   93 000021A8 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 000021AC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000021B2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000021B2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000021B6 F8DA F088       ldr              pc,nexttimeout
 1450 000021BA         ;-------------------------------------------------------
                       ---------------------
 1451 000021BA         _DE                                  ;   DEC $nnnn,X
 1452 000021BA         ;-------------------------------------------------------
                       ---------------------
 1453 000021BA                 doAIX
  274 000021BA 00000004 
                       _type   SETA             _ABS
  275 000021BA F819 CB01       ldrb             addy,[m6502_pc],#1
  276 000021BE F819 0B01       ldrb             r0,[m6502_pc],#1
  277 000021C2 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 000021C6 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 000021CA         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1454 000021CA                 opDEC
  435 000021CA                 readmem
  146 000021CA                 [                _type = _ABS
  147 000021CA                 readmemabs
  107 000021CA F40C 4160       and              r1,addy,#0xE000
  108 000021CE F20F 0E0A       adr              lr,%F0
  109 000021D2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000021D2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000021D6 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000021DA         
  113 000021DA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000021DA                 ]
  149 000021DA                 [                _type = _ZP
  151                          ]
  152 000021DA                 [                _type = _ZPI
  154                          ]
  155 000021DA                 [                _type = _IMM
  157                          ]
  436 000021DA F1A0 0001       sub              r0,r0,#1
  437 000021DE EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  438 000021E2                 writemem
  203 000021E2                 [                _type = _ABS
  204 000021E2                 writememabs
  177 000021E2 F40C 4160       and              r1,addy,#0xe000
  178 000021E6 F10A 0224       adr              r2,writemem_tbl
  179 000021EA F20F 0E0A       adr              lr,%F0
  180 000021EE         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 000021EE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 000021F2 F852 F001       ldr              pc,[r2,r1]
  183 000021F6         
  184 000021F6         0                                    ;out: r0,r1,r2,addy



ARM Macro Assembler    Page 133 


                                                            =?
  205 000021F6                 ]
  206 000021F6                 [                _type = _ZP
  208                          ]
  209 000021F6                 [                _type = _ZPI
  211                          ]
 1455 000021F6                 fetch            7
   70 000021F6         ;//-----------------------------------------------------
                       ----------------
   71 000021F6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000021FA F100 0007       add              r0,r0,#7
   73 000021FE F8CA 00A0       str              r0,clocksh
   74 00002202         
   75 00002202 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002206         ;//-----------------------------------------------------
                       --------------------
   77 00002206 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000220A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002210         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002210 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00002214 F8DA F088       ldr              pc,nexttimeout
 1456 00002218         ;-------------------------------------------------------
                       ---------------------
 1457 00002218         _E0                                  ;   CPX #$nn
 1458 00002218         ;-------------------------------------------------------
                       ---------------------
 1459 00002218                 doIMM
  294 00002218 00000001 
                       _type   SETA             _IMM
 1460 00002218                 opCOMP           m6502_x
  427 00002218                 readmem
  146 00002218                 [                _type = _ABS
  148                          ]
  149 00002218                 [                _type = _ZP
  151                          ]
  152 00002218                 [                _type = _ZPI
  154                          ]
  155 00002218                 [                _type = _IMM
  156 00002218                 readmemimm
  136 00002218 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 0000221C                 ]
  428 0000221C EBB6 6300       subs             m6502_nz,m6502_x,r0,lsl#24
  429 00002220 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00002224 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1461 00002228                 fetch_c          2
   86 00002228         ;//-----------------------------------------------------
                       ----------------
   87 00002228 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý



ARM Macro Assembler    Page 134 


   88 0000222C F100 0002       add              r0,r0,#2
   89 00002230 F8CA 00A0       str              r0,clocksh
   90 00002234         
   91 00002234 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00002238         ;//-----------------------------------------------------
                       --------------------
   93 00002238 F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 0000223C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00002242         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002242 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00002246 F8DA F088       ldr              pc,nexttimeout
 1462 0000224A         ;-------------------------------------------------------
                       ---------------------
 1463 0000224A         _E1                                  ;   SBC ($nn,X)
 1464 0000224A         ;-------------------------------------------------------
                       ---------------------
 1465 0000224A                 doIIX
  299 0000224A 00000004 
                       _type   SETA             _ABS
  300 0000224A F819 0B01       ldrb             r0,[m6502_pc],#1
  301 0000224E EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00002252         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00002252 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 00002256 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 0000225A         
  306 0000225A F100 7080       add              r0,r0,#0x01000000
  307 0000225E         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 0000225E EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00002262 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 00002266         
  311 00002266 EA4C 2C01       orr              addy,addy,r1,lsl#8
 1466 0000226A                 opSBC
  521 0000226A                 readmem
  146 0000226A                 [                _type = _ABS
  147 0000226A                 readmemabs
  107 0000226A F40C 4160       and              r1,addy,#0xE000
  108 0000226E F20F 0E0A       adr              lr,%F0
  109 00002272         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002272 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002276 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000227A         
  113 0000227A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000227A                 ]
  149 0000227A                 [                _type = _ZP
  151                          ]
  152 0000227A                 [                _type = _ZPI
  154                          ]



ARM Macro Assembler    Page 135 


  155 0000227A                 [                _type = _IMM
  157                          ]
  522 0000227A EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 0000227E EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 00002282 F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 00002286 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 0000228A F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 0000228E BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1467 00002294                 fetch_c          6
   86 00002294         ;//-----------------------------------------------------
                       ----------------
   87 00002294 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00002298 F100 0006       add              r0,r0,#6
   89 0000229C F8CA 00A0       str              r0,clocksh
   90 000022A0         
   91 000022A0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000022A4         ;//-----------------------------------------------------
                       --------------------
   93 000022A4 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   94 000022A8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000022AE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000022AE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000022B2 F8DA F088       ldr              pc,nexttimeout
 1468 000022B6         ;-------------------------------------------------------
                       ---------------------
 1469 000022B6         _E4                                  ;   CPX $nn
 1470 000022B6         ;-------------------------------------------------------
                       ---------------------
 1471 000022B6                 doZ
  346 000022B6 00000002 
                       _type   SETA             _ZP
  347 000022B6 F819 CB01       ldrb             addy,[m6502_pc],#1
 1472 000022BA                 opCOMP           m6502_x
  427 000022BA                 readmem
  146 000022BA                 [                _type = _ABS
  148                          ]
  149 000022BA                 [                _type = _ZP
  150 000022BA                 readmemzp
  118 000022BA F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 000022BE                 ]
  152 000022BE                 [                _type = _ZPI
  154                          ]
  155 000022BE                 [                _type = _IMM
  157                          ]
  428 000022BE EBB6 6300       subs             m6502_nz,m6502_x,r0,lsl#24
  429 000022C2 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 000022C6 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1473 000022CA                 fetch_c          3
   86 000022CA         ;//-----------------------------------------------------
                       ----------------
   87 000022CA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý



ARM Macro Assembler    Page 136 


   88 000022CE F100 0003       add              r0,r0,#3
   89 000022D2 F8CA 00A0       str              r0,clocksh
   90 000022D6         
   91 000022D6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000022DA         ;//-----------------------------------------------------
                       --------------------
   93 000022DA F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   94 000022DE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000022E4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000022E4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000022E8 F8DA F088       ldr              pc,nexttimeout
 1474 000022EC         ;-------------------------------------------------------
                       ---------------------
 1475 000022EC         _E5                                  ;   SBC $nn
 1476 000022EC         ;-------------------------------------------------------
                       ---------------------
 1477 000022EC                 doZ
  346 000022EC 00000002 
                       _type   SETA             _ZP
  347 000022EC F819 CB01       ldrb             addy,[m6502_pc],#1
 1478 000022F0                 opSBC
  521 000022F0                 readmem
  146 000022F0                 [                _type = _ABS
  148                          ]
  149 000022F0                 [                _type = _ZP
  150 000022F0                 readmemzp
  118 000022F0 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 000022F4                 ]
  152 000022F4                 [                _type = _ZPI
  154                          ]
  155 000022F4                 [                _type = _IMM
  157                          ]
  522 000022F4 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 000022F8 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 000022FC F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 00002300 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 00002304 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 00002308 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1479 0000230E                 fetch_c          3
   86 0000230E         ;//-----------------------------------------------------
                       ----------------
   87 0000230E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00002312 F100 0003       add              r0,r0,#3
   89 00002316 F8CA 00A0       str              r0,clocksh
   90 0000231A         
   91 0000231A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000231E         ;//-----------------------------------------------------
                       --------------------
   93 0000231E F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   94 00002322 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1



ARM Macro Assembler    Page 137 


   95 00002328         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002328 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 0000232C F8DA F088       ldr              pc,nexttimeout
 1480 00002330         ;-------------------------------------------------------
                       ---------------------
 1481 00002330         _E6                                  ;   INC $nn
 1482 00002330         ;-------------------------------------------------------
                       ---------------------
 1483 00002330                 doZ
  346 00002330 00000002 
                       _type   SETA             _ZP
  347 00002330 F819 CB01       ldrb             addy,[m6502_pc],#1
 1484 00002334                 opINC
  450 00002334                 readmem
  146 00002334                 [                _type = _ABS
  148                          ]
  149 00002334                 [                _type = _ZP
  150 00002334                 readmemzp
  118 00002334 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00002338                 ]
  152 00002338                 [                _type = _ZPI
  154                          ]
  155 00002338                 [                _type = _IMM
  157                          ]
  451 00002338 F100 0001       add              r0,r0,#1
  452 0000233C EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  453 00002340                 writemem
  203 00002340                 [                _type = _ABS
  205                          ]
  206 00002340                 [                _type = _ZP
  207 00002340                 writememzp
  189 00002340 F80B 000C       strb             r0,[cpu_zpage,addy]
  208 00002344                 ]
  209 00002344                 [                _type = _ZPI
  211                          ]
 1485 00002344                 fetch            5
   70 00002344         ;//-----------------------------------------------------
                       ----------------
   71 00002344 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002348 F100 0005       add              r0,r0,#5
   73 0000234C F8CA 00A0       str              r0,clocksh
   74 00002350         
   75 00002350 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002354         ;//-----------------------------------------------------
                       --------------------
   77 00002354 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002358 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000235E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000235E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00002362 F8DA F088       ldr              pc,nexttimeout



ARM Macro Assembler    Page 138 


 1486 00002366         ;-------------------------------------------------------
                       ---------------------
 1487 00002366         _E8                                  ;   INX
 1488 00002366         ;-------------------------------------------------------
                       ---------------------
 1489 00002366 F106 7680       add              m6502_x,m6502_x,#0x01000000
 1490 0000236A EA4F 6326       mov              m6502_nz,m6502_x,asr#24
 1491 0000236E                 fetch            2
   70 0000236E         ;//-----------------------------------------------------
                       ----------------
   71 0000236E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002372 F100 0002       add              r0,r0,#2
   73 00002376 F8CA 00A0       str              r0,clocksh
   74 0000237A         
   75 0000237A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000237E         ;//-----------------------------------------------------
                       --------------------
   77 0000237E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002382 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002388         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002388 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000238C F8DA F088       ldr              pc,nexttimeout
 1492 00002390         ;-------------------------------------------------------
                       ---------------------
 1493 00002390         _E9                                  ;   SBC #$nn
 1494 00002390         ;-------------------------------------------------------
                       ---------------------
 1495 00002390                 doIMM
  294 00002390 00000001 
                       _type   SETA             _IMM
 1496 00002390                 opSBC
  521 00002390                 readmem
  146 00002390                 [                _type = _ABS
  148                          ]
  149 00002390                 [                _type = _ZP
  151                          ]
  152 00002390                 [                _type = _ZPI
  154                          ]
  155 00002390                 [                _type = _IMM
  156 00002390                 readmemimm
  136 00002390 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  157 00002394                 ]
  522 00002394 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 00002398 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 0000239C F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 000023A0 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 000023A4 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 000023A8 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V



ARM Macro Assembler    Page 139 


 1497 000023AE                 fetch_c          2
   86 000023AE         ;//-----------------------------------------------------
                       ----------------
   87 000023AE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 000023B2 F100 0002       add              r0,r0,#2
   89 000023B6 F8CA 00A0       str              r0,clocksh
   90 000023BA         
   91 000023BA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000023BE         ;//-----------------------------------------------------
                       --------------------
   93 000023BE F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   94 000023C2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000023C8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000023C8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000023CC F8DA F088       ldr              pc,nexttimeout
 1498 000023D0         ;-------------------------------------------------------
                       ---------------------
 1499 000023D0         _EA                                  ;   NOP
 1500 000023D0         ;-------------------------------------------------------
                       ---------------------
 1501 000023D0                 fetch            2
   70 000023D0         ;//-----------------------------------------------------
                       ----------------
   71 000023D0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000023D4 F100 0002       add              r0,r0,#2
   73 000023D8 F8CA 00A0       str              r0,clocksh
   74 000023DC         
   75 000023DC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000023E0         ;//-----------------------------------------------------
                       --------------------
   77 000023E0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000023E4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000023EA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000023EA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000023EE F8DA F088       ldr              pc,nexttimeout
 1502 000023F2         ;-------------------------------------------------------
                       ---------------------
 1503 000023F2         _EC                                  ;   CPX $nnnn
 1504 000023F2         ;-------------------------------------------------------
                       ---------------------
 1505 000023F2                 doABS
  266 000023F2 00000004 
                       _type   SETA             _ABS
  267 000023F2 F819 CB01       ldrb             addy,[m6502_pc],#1
  268 000023F6 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 000023FA EA4C 2C00       orr              addy,addy,r0,lsl#8



ARM Macro Assembler    Page 140 


 1506 000023FE                 opCOMP           m6502_x
  427 000023FE                 readmem
  146 000023FE                 [                _type = _ABS
  147 000023FE                 readmemabs
  107 000023FE F40C 4160       and              r1,addy,#0xE000
  108 00002402 F20F 0E0A       adr              lr,%F0
  109 00002406         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002406 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 0000240A F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000240E         
  113 0000240E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000240E                 ]
  149 0000240E                 [                _type = _ZP
  151                          ]
  152 0000240E                 [                _type = _ZPI
  154                          ]
  155 0000240E                 [                _type = _IMM
  157                          ]
  428 0000240E EBB6 6300       subs             m6502_nz,m6502_x,r0,lsl#24
  429 00002412 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  430 00002416 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
 1507 0000241A                 fetch_c          4
   86 0000241A         ;//-----------------------------------------------------
                       ----------------
   87 0000241A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 0000241E F100 0004       add              r0,r0,#4
   89 00002422 F8CA 00A0       str              r0,clocksh
   90 00002426         
   91 00002426 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000242A         ;//-----------------------------------------------------
                       --------------------
   93 0000242A F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 0000242E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00002434         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002434 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00002438 F8DA F088       ldr              pc,nexttimeout
 1508 0000243C         ;-------------------------------------------------------
                       ---------------------
 1509 0000243C         _ED                                  ;   SBC $nnnn
 1510 0000243C         ;-------------------------------------------------------
                       ---------------------
 1511 0000243C                 doABS
  266 0000243C 00000004 
                       _type   SETA             _ABS
  267 0000243C F819 CB01       ldrb             addy,[m6502_pc],#1
  268 00002440 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 00002444 EA4C 2C00       orr              addy,addy,r0,lsl#8
 1512 00002448                 opSBC



ARM Macro Assembler    Page 141 


  521 00002448                 readmem
  146 00002448                 [                _type = _ABS
  147 00002448                 readmemabs
  107 00002448 F40C 4160       and              r1,addy,#0xE000
  108 0000244C F20F 0E08       adr              lr,%F0
  109 00002450         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002450 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002454 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00002458         
  113 00002458         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00002458                 ]
  149 00002458                 [                _type = _ZP
  151                          ]
  152 00002458                 [                _type = _ZPI
  154                          ]
  155 00002458                 [                _type = _IMM
  157                          ]
  522 00002458 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 0000245C EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 00002460 F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 00002464 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 00002468 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 0000246C BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1513 00002472                 fetch_c          4
   86 00002472         ;//-----------------------------------------------------
                       ----------------
   87 00002472 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00002476 F100 0004       add              r0,r0,#4
   89 0000247A F8CA 00A0       str              r0,clocksh
   90 0000247E         
   91 0000247E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 00002482         ;//-----------------------------------------------------
                       --------------------
   93 00002482 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 00002486 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 0000248C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 0000248C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 00002490 F8DA F088       ldr              pc,nexttimeout
 1514 00002494         ;-------------------------------------------------------
                       ---------------------
 1515 00002494         _EE                                  ;   INC $nnnn
 1516 00002494         ;-------------------------------------------------------
                       ---------------------
 1517 00002494                 doABS
  266 00002494 00000004 
                       _type   SETA             _ABS
  267 00002494 F819 CB01       ldrb             addy,[m6502_pc],#1



ARM Macro Assembler    Page 142 


  268 00002498 F819 0B01       ldrb             r0,[m6502_pc],#1
  269 0000249C EA4C 2C00       orr              addy,addy,r0,lsl#8
 1518 000024A0                 opINC
  450 000024A0                 readmem
  146 000024A0                 [                _type = _ABS
  147 000024A0                 readmemabs
  107 000024A0 F40C 4160       and              r1,addy,#0xE000
  108 000024A4 F20F 0E08       adr              lr,%F0
  109 000024A8         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000024A8 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000024AC F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000024B0         
  113 000024B0         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000024B0                 ]
  149 000024B0                 [                _type = _ZP
  151                          ]
  152 000024B0                 [                _type = _ZPI
  154                          ]
  155 000024B0                 [                _type = _IMM
  157                          ]
  451 000024B0 F100 0001       add              r0,r0,#1
  452 000024B4 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  453 000024B8                 writemem
  203 000024B8                 [                _type = _ABS
  204 000024B8                 writememabs
  177 000024B8 F40C 4160       and              r1,addy,#0xe000
  178 000024BC F10A 0224       adr              r2,writemem_tbl
  179 000024C0 F20F 0E08       adr              lr,%F0
  180 000024C4         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 000024C4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 000024C8 F852 F001       ldr              pc,[r2,r1]
  183 000024CC         
  184 000024CC         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 000024CC                 ]
  206 000024CC                 [                _type = _ZP
  208                          ]
  209 000024CC                 [                _type = _ZPI
  211                          ]
 1519 000024CC                 fetch            6
   70 000024CC         ;//-----------------------------------------------------
                       ----------------
   71 000024CC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000024D0 F100 0006       add              r0,r0,#6
   73 000024D4 F8CA 00A0       str              r0,clocksh
   74 000024D8         
   75 000024D8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000024DC         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 143 


   77 000024DC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000024E0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000024E6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000024E6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000024EA F8DA F088       ldr              pc,nexttimeout
 1520 000024EE         ;-------------------------------------------------------
                       ---------------------
 1521 000024EE         _F0                                  ;   BEQ *
 1522 000024EE         ;-------------------------------------------------------
                       ---------------------
 1523 000024EE F013 0FFF       tst              m6502_nz,#0xff
 1524 000024F2 F919 0B01       ldrsb            r0,[m6502_pc],#1
 1525 000024F6 BF04 4481       addeq            m6502_pc,m6502_pc,r0
 1526 000024FA         ; subeq cycles,cycles,#3*CYCLE
 1527 000024FA F5A8 7880       subeq            cycles,cycles,#256
 1528 000024FE                 fetch            2
   70 000024FE         ;//-----------------------------------------------------
                       ----------------
   71 000024FE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002502 F100 0002       add              r0,r0,#2
   73 00002506 F8CA 00A0       str              r0,clocksh
   74 0000250A         
   75 0000250A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000250E         ;//-----------------------------------------------------
                       --------------------
   77 0000250E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002512 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002518         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002518 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000251C F8DA F088       ldr              pc,nexttimeout
 1529 00002520         ;-------------------------------------------------------
                       ---------------------
 1530 00002520         _F1                                  ;   SBC ($nn),Y
 1531 00002520         ;-------------------------------------------------------
                       ---------------------
 1532 00002520                 doIIY
  316 00002520 00000004 
                       _type   SETA             _ABS
  317 00002520 F819 0B01       ldrb             r0,[m6502_pc],#1
  318 00002524         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  319 00002524         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  320 00002524 F810 C00B       ldrb             addy,[r0,cpu_zpage]



ARM Macro Assembler    Page 144 


  321 00002528 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  322 0000252A         
  323 0000252A         
  324 0000252A 7841            ldrb             r1,[r0,#1]
  325 0000252C EA4C 2C01       orr              addy,addy,r1,lsl#8
  326 00002530 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  327 00002534         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
 1533 00002534                 opSBC
  521 00002534                 readmem
  146 00002534                 [                _type = _ABS
  147 00002534                 readmemabs
  107 00002534 F40C 4160       and              r1,addy,#0xE000
  108 00002538 F20F 0E08       adr              lr,%F0
  109 0000253C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000253C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002540 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00002544         
  113 00002544         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 00002544                 ]
  149 00002544                 [                _type = _ZP
  151                          ]
  152 00002544                 [                _type = _ZPI
  154                          ]
  155 00002544                 [                _type = _IMM
  157                          ]
  522 00002544 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 00002548 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 0000254C F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 00002550 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 00002554 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 00002558 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1534 0000255E                 fetch_c          5
   86 0000255E         ;//-----------------------------------------------------
                       ----------------
   87 0000255E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00002562 F100 0005       add              r0,r0,#5
   89 00002566 F8CA 00A0       str              r0,clocksh
   90 0000256A         
   91 0000256A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000256E         ;//-----------------------------------------------------
                       --------------------
   93 0000256E F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   94 00002572 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00002578         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002578 F851 F020       ldrpl            pc,[r1,r0,lsl#2]



ARM Macro Assembler    Page 145 


   97 0000257C F8DA F088       ldr              pc,nexttimeout
 1535 00002580         ;-------------------------------------------------------
                       ---------------------
 1536 00002580         _F5                                  ;   SBC $nn,X
 1537 00002580         ;-------------------------------------------------------
                       ---------------------
 1538 00002580                 doZIXf
  366 00002580 00000003 
                       _type   SETA             _ZPI
  367 00002580 F819 CB01       ldrb             addy,[m6502_pc],#1
  368 00002584 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1539 00002588                 opSBC
  521 00002588                 readmem
  146 00002588                 [                _type = _ABS
  148                          ]
  149 00002588                 [                _type = _ZP
  151                          ]
  152 00002588                 [                _type = _ZPI
  153 00002588                 readmemzpi
  123 00002588         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 00002588 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 0000258C F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 00002590         
  154 00002590                 ]
  155 00002590                 [                _type = _IMM
  157                          ]
  522 00002590 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 00002594 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 00002598 F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 0000259C EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 000025A0 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 000025A4 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1540 000025AA                 fetch_c          4
   86 000025AA         ;//-----------------------------------------------------
                       ----------------
   87 000025AA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 000025AE F100 0004       add              r0,r0,#4
   89 000025B2 F8CA 00A0       str              r0,clocksh
   90 000025B6         
   91 000025B6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000025BA         ;//-----------------------------------------------------
                       --------------------
   93 000025BA F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 000025BE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000025C4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000025C4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000025C8 F8DA F088       ldr              pc,nexttimeout
 1541 000025CC         ;-------------------------------------------------------
                       ---------------------
 1542 000025CC         _F6                                  ;   INC $nn,X
 1543 000025CC         ;-------------------------------------------------------
                       ---------------------
 1544 000025CC                 doZIXf



ARM Macro Assembler    Page 146 


  366 000025CC 00000003 
                       _type   SETA             _ZPI
  367 000025CC F819 CB01       ldrb             addy,[m6502_pc],#1
  368 000025D0 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1545 000025D4                 opINC
  450 000025D4                 readmem
  146 000025D4                 [                _type = _ABS
  148                          ]
  149 000025D4                 [                _type = _ZP
  151                          ]
  152 000025D4                 [                _type = _ZPI
  153 000025D4                 readmemzpi
  123 000025D4         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  124 000025D4 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  125 000025D8 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  126 000025DC         
  154 000025DC                 ]
  155 000025DC                 [                _type = _IMM
  157                          ]
  451 000025DC F100 0001       add              r0,r0,#1
  452 000025E0 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  453 000025E4                 writemem
  203 000025E4                 [                _type = _ABS
  205                          ]
  206 000025E4                 [                _type = _ZP
  208                          ]
  209 000025E4                 [                _type = _ZPI
  210 000025E4                 writememzpi
  194 000025E4         ;// strb r0,[cpu_zpage,addy,lsr#24]
  195 000025E4 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  196 000025E8 F80B 0001       strb             r0,[cpu_zpage,r1]
  197 000025EC         
  198 000025EC         
  211 000025EC                 ]
 1546 000025EC                 fetch            6
   70 000025EC         ;//-----------------------------------------------------
                       ----------------
   71 000025EC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000025F0 F100 0006       add              r0,r0,#6
   73 000025F4 F8CA 00A0       str              r0,clocksh
   74 000025F8         
   75 000025F8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000025FC         ;//-----------------------------------------------------
                       --------------------
   77 000025FC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002600 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002606         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002606 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000260A F8DA F088       ldr              pc,nexttimeout



ARM Macro Assembler    Page 147 


 1547 0000260E         ;-------------------------------------------------------
                       ---------------------
 1548 0000260E         _F8                                  ;   SED
 1549 0000260E         ;-------------------------------------------------------
                       ---------------------
 1550 0000260E F048 0808       orr              cycles,cycles,#CYC_D
 1551 00002612                 fetch            2
   70 00002612         ;//-----------------------------------------------------
                       ----------------
   71 00002612 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002616 F100 0002       add              r0,r0,#2
   73 0000261A F8CA 00A0       str              r0,clocksh
   74 0000261E         
   75 0000261E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002622         ;//-----------------------------------------------------
                       --------------------
   77 00002622 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002626 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000262C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000262C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00002630 F8DA F088       ldr              pc,nexttimeout
 1552 00002634         ;-------------------------------------------------------
                       ---------------------
 1553 00002634         _F9                                  ;   SBC $nnnn,Y
 1554 00002634         ;-------------------------------------------------------
                       ---------------------
 1555 00002634                 doAIY
  284 00002634 00000004 
                       _type   SETA             _ABS
  285 00002634 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 00002638 F819 0B01       ldrb             r0,[m6502_pc],#1
  287 0000263C EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 00002640 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 00002644         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1556 00002644                 opSBC
  521 00002644                 readmem
  146 00002644                 [                _type = _ABS
  147 00002644                 readmemabs
  107 00002644 F40C 4160       and              r1,addy,#0xE000
  108 00002648 F20F 0E08       adr              lr,%F0
  109 0000264C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 0000264C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002650 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 00002654         
  113 00002654         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i



ARM Macro Assembler    Page 148 


                                                            nstructions
  148 00002654                 ]
  149 00002654                 [                _type = _ZP
  151                          ]
  152 00002654                 [                _type = _ZPI
  154                          ]
  155 00002654                 [                _type = _IMM
  157                          ]
  522 00002654 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 00002658 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 0000265C F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 00002660 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 00002664 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 00002668 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1557 0000266E                 fetch_c          4
   86 0000266E         ;//-----------------------------------------------------
                       ----------------
   87 0000266E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 00002672 F100 0004       add              r0,r0,#4
   89 00002676 F8CA 00A0       str              r0,clocksh
   90 0000267A         
   91 0000267A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 0000267E         ;//-----------------------------------------------------
                       --------------------
   93 0000267E F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 00002682 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 00002688         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 00002688 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 0000268C F8DA F088       ldr              pc,nexttimeout
 1558 00002690         ;-------------------------------------------------------
                       ---------------------
 1559 00002690         _FD                                  ;   SBC $nnnn,X
 1560 00002690         ;-------------------------------------------------------
                       ---------------------
 1561 00002690                 doAIX
  274 00002690 00000004 
                       _type   SETA             _ABS
  275 00002690 F819 CB01       ldrb             addy,[m6502_pc],#1
  276 00002694 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00002698 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 0000269C EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 000026A0         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1562 000026A0                 opSBC
  521 000026A0                 readmem
  146 000026A0                 [                _type = _ABS
  147 000026A0                 readmemabs
  107 000026A0 F40C 4160       and              r1,addy,#0xE000
  108 000026A4 F20F 0E08       adr              lr,%F0
  109 000026A8         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000026A8 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000026AC F854 F001       ldr              pc,[m6502_rmem,r1]



ARM Macro Assembler    Page 149 


  112 000026B0         
  113 000026B0         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000026B0                 ]
  149 000026B0                 [                _type = _ZP
  151                          ]
  152 000026B0                 [                _type = _ZPI
  154                          ]
  155 000026B0                 [                _type = _IMM
  157                          ]
  522 000026B0 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 000026B4 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 000026B8 F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 000026BC EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 000026C0 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 000026C4 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1563 000026CA                 fetch_c          4
   86 000026CA         ;//-----------------------------------------------------
                       ----------------
   87 000026CA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   88 000026CE F100 0004       add              r0,r0,#4
   89 000026D2 F8CA 00A0       str              r0,clocksh
   90 000026D6         
   91 000026D6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   92 000026DA         ;//-----------------------------------------------------
                       --------------------
   93 000026DA F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   94 000026DE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   95 000026E4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   96 000026E4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   97 000026E8 F8DA F088       ldr              pc,nexttimeout
 1564 000026EC         ;-------------------------------------------------------
                       ---------------------
 1565 000026EC         _FE                                  ;   INC $nnnn,X
 1566 000026EC         ;-------------------------------------------------------
                       ---------------------
 1567 000026EC                 doAIX
  274 000026EC 00000004 
                       _type   SETA             _ABS
  275 000026EC F819 CB01       ldrb             addy,[m6502_pc],#1
  276 000026F0 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 000026F4 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 000026F8 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 000026FC         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1568 000026FC                 opINC
  450 000026FC                 readmem
  146 000026FC                 [                _type = _ABS
  147 000026FC                 readmemabs
  107 000026FC F40C 4160       and              r1,addy,#0xE000
  108 00002700 F20F 0E08       adr              lr,%F0



ARM Macro Assembler    Page 150 


  109 00002704         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002704 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002708 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000270C         
  113 0000270C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000270C                 ]
  149 0000270C                 [                _type = _ZP
  151                          ]
  152 0000270C                 [                _type = _ZPI
  154                          ]
  155 0000270C                 [                _type = _IMM
  157                          ]
  451 0000270C F100 0001       add              r0,r0,#1
  452 00002710 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  453 00002714                 writemem
  203 00002714                 [                _type = _ABS
  204 00002714                 writememabs
  177 00002714 F40C 4160       and              r1,addy,#0xe000
  178 00002718 F10A 0224       adr              r2,writemem_tbl
  179 0000271C F20F 0E08       adr              lr,%F0
  180 00002720         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  181 00002720 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  182 00002724 F852 F001       ldr              pc,[r2,r1]
  183 00002728         
  184 00002728         0                                    ;out: r0,r1,r2,addy
                                                            =?
  205 00002728                 ]
  206 00002728                 [                _type = _ZP
  208                          ]
  209 00002728                 [                _type = _ZPI
  211                          ]
 1569 00002728                 fetch            7
   70 00002728         ;//-----------------------------------------------------
                       ----------------
   71 00002728 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000272C F100 0007       add              r0,r0,#7
   73 00002730 F8CA 00A0       str              r0,clocksh
   74 00002734         
   75 00002734 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002738         ;//-----------------------------------------------------
                       --------------------
   77 00002738 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000273C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002742         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0



ARM Macro Assembler    Page 151 


                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002742 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00002746 F8DA F088       ldr              pc,nexttimeout
 1570 0000274A         ;*******************************************************
                       ****ÒÔÏÂÖ¸ÁîÊÇÒ»Ð©HACKÓÎÏ·ÐèÒª******************
 1571 0000274A         _FF                                  ;  ISB $????,X  ¼Óµ
                                                            Ä£¬²»È·¶¨ÕýÈ·    ¼¤
                                                            ¹êÈÌÕß´«2ÎÞµÐHACKÐè
                                                            Òª
 1572 0000274A         ;-------------------------------------------------------
                       ------------
 1573 0000274A                 doAIX                        ;MR_AX();
  274 0000274A 00000004 
                       _type   SETA             _ABS
  275 0000274A F819 CB01       ldrb             addy,[m6502_pc],#1
  276 0000274E F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00002752 EA4C 2C00       orr              addy,addy,r0,lsl#8
  278 00002756 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  279 0000275A         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1574 0000275A                 opSBC                        ;ISB(); 
  521 0000275A                 readmem
  146 0000275A                 [                _type = _ABS
  147 0000275A                 readmemabs
  107 0000275A F40C 4160       and              r1,addy,#0xE000
  108 0000275E F20F 0E0A       adr              lr,%F0
  109 00002762         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 00002762 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 00002766 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 0000276A         
  113 0000276A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 0000276A                 ]
  149 0000276A                 [                _type = _ZP
  151                          ]
  152 0000276A                 [                _type = _ZPI
  154                          ]
  155 0000276A                 [                _type = _IMM
  157                          ]
  522 0000276A EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 0000276E EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 00002772 F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 00002776 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 0000277A F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 0000277E BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1575 00002784         ;MW_EA();  #define MW_EA()  WR6502(EA,DT)  // EA .... EF
                       FECTIVE ADDRESS
 1576 00002784                 fetch            5           ;ADD_CYCLE(5);     
                                                                               
                                                                      // DT ...
                                                            . DATA
   70 00002784         ;//-----------------------------------------------------



ARM Macro Assembler    Page 152 


                       ----------------
   71 00002784 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002788 F100 0005       add              r0,r0,#5
   73 0000278C F8CA 00A0       str              r0,clocksh
   74 00002790         
   75 00002790 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002794         ;//-----------------------------------------------------
                       --------------------
   77 00002794 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002798 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000279E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000279E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000027A2 F8DA F088       ldr              pc,nexttimeout
 1577 000027A6         ;-------------------------------------------------------
                       -----------------
 1578 000027A6         _FB                                  ;  ISB $????,X  ¼Óµ
                                                            Ä£¬²»È·¶¨ÕýÈ·    ¼¤
                                                            ¹êÈÌÕß´«2ÎÞµÐHACKÐè
                                                            Òª
 1579 000027A6         ;-------------------------------------------------------
                       ------------
 1580 000027A6                 doAIY                        ;MR_AY();
  284 000027A6 00000004 
                       _type   SETA             _ABS
  285 000027A6 F819 CB01       ldrb             addy,[m6502_pc],#1
  286 000027AA F819 0B01       ldrb             r0,[m6502_pc],#1
  287 000027AE EA4C 2C00       orr              addy,addy,r0,lsl#8
  288 000027B2 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  289 000027B6         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1581 000027B6                 opSBC                        ;ISB(); 
  521 000027B6                 readmem
  146 000027B6                 [                _type = _ABS
  147 000027B6                 readmemabs
  107 000027B6 F40C 4160       and              r1,addy,#0xE000
  108 000027BA F20F 0E0A       adr              lr,%F0
  109 000027BE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
  110 000027BE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
  111 000027C2 F854 F001       ldr              pc,[m6502_rmem,r1]
  112 000027C6         
  113 000027C6         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  148 000027C6                 ]
  149 000027C6                 [                _type = _ZP
  151                          ]
  152 000027C6                 [                _type = _ZPI



ARM Macro Assembler    Page 153 


  154                          ]
  155 000027C6                 [                _type = _IMM
  157                          ]
  522 000027C6 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  523 000027CA EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  524 000027CE F005 457F       and              m6502_a,m6502_a,#0xff000000
  525 000027D2 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  526 000027D6 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  527 000027DA BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1582 000027E0         ;MW_EA();  
 1583 000027E0                 fetch            5           ;ADD_CYCLE(5);     
                                                                               
                                                                      
   70 000027E0         ;//-----------------------------------------------------
                       ----------------
   71 000027E0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000027E4 F100 0005       add              r0,r0,#5
   73 000027E8 F8CA 00A0       str              r0,clocksh
   74 000027EC         
   75 000027EC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000027F0         ;//-----------------------------------------------------
                       --------------------
   77 000027F0 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000027F4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000027FA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000027FA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000027FE F8DA F088       ldr              pc,nexttimeout
 1584 00002802         ;-------------------------------------------------------
                       -----------------
 1585 00002802         _14                                  ;      ¼ÓµÄ£¬²»È·¶¨
                                                            ÕýÈ·          ¼¤¹êÈ
                                                            ÌÕß´«2ÎÞµÐHACKÐèÒª
 1586 00002802         ;-------------------------------------------------------
                       ------------
 1587 00002802 F109 0901       add              m6502_pc,m6502_pc,#1 ;R.PC++;
 1588 00002806                 fetch            4           ;ADD_CYCLE(4);     
                                                                               
                                                               
   70 00002806         ;//-----------------------------------------------------
                       ----------------
   71 00002806 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 0000280A F100 0004       add              r0,r0,#4
   73 0000280E F8CA 00A0       str              r0,clocksh
   74 00002812         
   75 00002812 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00002816         ;//-----------------------------------------------------



ARM Macro Assembler    Page 154 


                       --------------------
   77 00002816 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 0000281A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002820         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002820 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00002824 F8DA F088       ldr              pc,nexttimeout
 1589 00002828         ;-------------------------------------------------------
                       ------------
 1590 00002828         _67                                  ; // RRA $??       
                                                                      µÛ¹úÕ½»úÎ
                                                            ÞµÐHACKÐèÒª
 1591 00002828         ;-------------------------------------------------------
                       ------------
 1592 00002828                 doZ                          ;MR_ZP(); 
  346 00002828 00000002 
                       _type   SETA             _ZP
  347 00002828 F819 CB01       ldrb             addy,[m6502_pc],#1
 1593 0000282C                 opADC                        ;RRA(); 
  390 0000282C                 readmem
  146 0000282C                 [                _type = _ABS
  148                          ]
  149 0000282C                 [                _type = _ZP
  150 0000282C                 readmemzp
  118 0000282C F81B 000C       ldrb             r0,[cpu_zpage,addy]
  151 00002830                 ]
  152 00002830                 [                _type = _ZPI
  154                          ]
  155 00002830                 [                _type = _IMM
  157                          ]
  391 00002830 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  392 00002834 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  393 0000283A EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  394 0000283E EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  395 00002842 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  396 00002846 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1594 0000284C         ;MW_ZP();
 1595 0000284C                 fetch            5           ;ADD_CYCLE(5);    
   70 0000284C         ;//-----------------------------------------------------
                       ----------------
   71 0000284C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002850 F100 0005       add              r0,r0,#5
   73 00002854 F8CA 00A0       str              r0,clocksh
   74 00002858         
   75 00002858 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000285C         ;//-----------------------------------------------------
                       --------------------
   77 0000285C F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2



ARM Macro Assembler    Page 155 


                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00002860 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00002866         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00002866 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000286A F8DA F088       ldr              pc,nexttimeout
 1596 0000286E         ;-------------------------------------------------------
                       -------------
 1597 0000286E         _03                                  ; // SLO ($??,X)   
                                                                       µÛ¹úÕ½»ú
                                                            ÎÞµÐHACKÐèÒª
 1598 0000286E         ;-------------------------------------------------------
                       ------------
 1599 0000286E                 doIIX                        ;MR_IX(); 
  299 0000286E 00000004 
                       _type   SETA             _ABS
  300 0000286E F819 0B01       ldrb             r0,[m6502_pc],#1
  301 00002872 EB06 6000       add              r0,m6502_x,r0,lsl#24
  302 00002876         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  303 00002876 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  304 0000287A F81B C00C       ldrb             addy,[cpu_zpage,addy]
  305 0000287E         
  306 0000287E F100 7080       add              r0,r0,#0x01000000
  307 00002882         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  308 00002882 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  309 00002886 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  310 0000288A         
  311 0000288A EA4C 2C01       orr              addy,addy,r1,lsl#8
 1600 0000288E         ;SLO(); 
 1601 0000288E         ;MW_EA();
 1602 0000288E                 fetch            8           ; ;ADD_CYCLE(8);
   70 0000288E         ;//-----------------------------------------------------
                       ----------------
   71 0000288E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00002892 F100 0008       add              r0,r0,#8
   73 00002896 F8CA 00A0       str              r0,clocksh
   74 0000289A         
   75 0000289A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000289E         ;//-----------------------------------------------------
                       --------------------
   77 0000289E F5B8 6800       subs             cycles,cycles,#8*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000028A2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000028A8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************



ARM Macro Assembler    Page 156 


                       *
   80 000028A8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000028AC F8DA F088       ldr              pc,nexttimeout
 1603 000028B0         ;-------------------------------------------------------
                       ----------
 1604 000028B0         _07                                  ; // SLO $??
 1605 000028B0         ;-------------------------------------------------------
                       -----------
 1606 000028B0                 doZ                          ;MR_ZP(); 
  346 000028B0 00000002 
                       _type   SETA             _ZP
  347 000028B0 F819 CB01       ldrb             addy,[m6502_pc],#1
 1607 000028B4         ;SLO(); 
 1608 000028B4         ;MW_ZP();
 1609 000028B4                 fetch            5           ;ADD_CYCLE(5);
   70 000028B4         ;//-----------------------------------------------------
                       ----------------
   71 000028B4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000028B8 F100 0005       add              r0,r0,#5
   73 000028BC F8CA 00A0       str              r0,clocksh
   74 000028C0         
   75 000028C0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000028C4         ;//-----------------------------------------------------
                       --------------------
   77 000028C4 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000028C8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000028CE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000028CE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000028D2 F8DA F088       ldr              pc,nexttimeout
 1610 000028D6         
 1611 000028D6         ;-------------------------------------------------------
                       ---------------------
 1612 000028D6                 IMPORT           debug_6502  ;main.c
 1613 000028D6         _xx                                  ; ???     ;invalid 
                                                            opcode ÎÞÐ§µÄ²Ù×÷Âë
                                                            
 1614 000028D6         ;-------------------------------------------------------
                       ---------------------
 1615 000028D6 F04F 0101       mov              r1,#1       ;²»ÓÃdebug¿ÉÒÔÖ±½Ó×
                                                            ¢ÒëÕâÁ½ÐÐ
 1616 000028DA F7FF FFFE       bl               debug_6502
 1617 000028DE         
 1618 000028DE                 fetch            2
   70 000028DE         ;//-----------------------------------------------------
                       ----------------
   71 000028DE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000028E2 F100 0002       add              r0,r0,#2
   73 000028E6 F8CA 00A0       str              r0,clocksh
   74 000028EA         



ARM Macro Assembler    Page 157 


   75 000028EA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000028EE         ;//-----------------------------------------------------
                       --------------------
   77 000028EE F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000028F2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000028F8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000028F8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000028FC F8DA F088       ldr              pc,nexttimeout
 1619 00002900         
 1620 00002900         ;*******************************************************
                       ********************************************
 1621 00002900         
 1622 00002900                 AREA             rom_code, CODE, READONLY
 1623 00000000         ; THUMB
 1624 00000000                 PRESERVE8
 1625 00000000         
 1626 00000000         ;-------------------------------------------------------
                       ---------------------
 1627 00000000         cpu6502_init
                               PROC
 1628 00000000         ;-------------------------------------------------------
                       ---------------------
 1629 00000000 E92D 4FF0       stmfd            sp!,{r4-r11,lr}
 1630 00000004         
 1631 00000004 F8DF A1A8       ldr              r10,=cpu_data ;¶ÁÈ¡µØÖ·
 1632 00000008 F8DF B1A8       ldr              r11,=NES_RAM ;r11=cpu_zpage
 1633 0000000C         
 1634 0000000C F8DB B000       ldr              r11,[r11]   ;NES_RAMÓÃÁËÖ¸Õë 
 1635 00000010         ;*******************************************************
                         
 1636 00000010 F8CA B044       str              r11,memmap_tbl ;NES_RAMÓÃÁËÖ¸Õë
                                                            
 1637 00000014 F8CA B048       str              r11,memmap_tbl+4
 1638 00000018 F8CA B04C       str              r11,memmap_tbl+8
 1639 0000001C         
 1640 0000001C 4866            ldr              r0,=NES_SRAM ;NES_SRAMÓÃÁËÖ¸Õë
 1641 0000001E 6800            ldr              r0,[r0]
 1642 00000020 F8CA 0050       str              r0,memmap_tbl+12
 1643 00000024         ;*******************************************************
                       ***************   
 1644 00000024         
 1645 00000024 4865            ldr              r0,=romfile
 1646 00000026 6800            ldr              r0,[r0]     ;R0ÏÖÔÚÖ¸ÏòROMÓ³Ïñ£
                                                            ¨°üÀ¨Í·£©
 1647 00000028 F100 0310       add              r3,r0,#16   ;r3ÏÖÔÚÖ¸Ïòrom¾µÏñ(
                                                            ²»°üÀ¨Í·£©
 1648 0000002C F8CA 308C       str              r3,rombase  ;ÉèÖÃrom»ùµØÖ·
 1649 00000030         ;r3=rombase til end of loadcart so DON'T FUCK IT UP
 1650 00000030 F04F 0201       mov              r2,#1
 1651 00000034 F813 1C0C       ldrb             r1,[r3,#-12] ; 16kB PROMµÄÊýÄ¿ 
                                                               2



ARM Macro Assembler    Page 158 


 1652 00000038 EBC2 3081       rsb              r0,r2,r1,lsl#14 ;romsize=X*16KB
                                                              <<14 ÄæÏò¼õ·¨Ö¸Áî
                                                              r0=0x7fff
 1653 0000003C F8CA 0094       str              r0,rommask  ;rommask=promsize-1
                                                              32768-1 
 1654 00000040         ;-------------------------------------------------------
                       ----------------------------- 
 1655 00000040 F04F 0900       mov              r9,#0       ;(Ïû³ýÈÎºÎencodePCµ
                                                            ÄÓ³ÉäÆ÷*³õÊ¼»¯¹ý³ÌÖ
                                                            ÐµÄ´íÎó)
 1656 00000044 F8CA 9084       str              r9,lastbank ;6502PC´Ó ROMµÄ×îºó
                                                            Æ«ÒÆÁ¿Ð´0
 1657 00000048         
 1658 00000048 F04F 0000       mov              r0,#0       ;Ä¬ÈÏromÓ³Éä
 1659 0000004C F000 F862       bl               map89AB_    ;89AB=1st 16k
 1660 00000050 F04F 30FF       mov              r0,#-1
 1661 00000054 F000 F87C       bl               mapCDEF_    ;CDEF=last 16k
 1662 00000058         
 1663 00000058         ;-------------------------------------------------------
                       -----------------------
 1664 00000058 F813 1C0A       ldrb             r1,[r3,#-10] ;get mapper#
 1665 0000005C F813 2C09       ldrb             r2,[r3,#-9]
 1666 00000060 F012 0F0E       tst              r2,#0x0e    ;long live DiskDude
                                                            !
 1667 00000064 F001 01F0       and              r1,r1,#0xf0
 1668 00000068 F002 02F0       and              r2,r2,#0xf0
 1669 0000006C EA42 1011       orr              r0,r2,r1,lsr#4
 1670 00000070 BF18 0908       movne            r0,r1,lsr#4 ;ignore high nibble
                                                             if header looks ba
                                                            d ºöÂÔ¸ßËÄÎ»£¬Èç¹ûÍ
                                                            ·¿´ÆðÀ´ºÜÔã¸â
 1671 00000074         ;r0=mapperºÅ
 1672 00000074         ;-------------------------------------------------------
                       ------------------------- 
 1673 00000074         
 1674 00000074 4852            ldr              r0,=Mapper_W ;±£´æ´¦ÀímapperµÄº
                                                            ¯ÊýµØÖ·
 1675 00000076 F8CA 0034       str              r0,writemem_tbl+16
 1676 0000007A F8CA 0038       str              r0,writemem_tbl+20
 1677 0000007E F8CA 003C       str              r0,writemem_tbl+24
 1678 00000082 F8CA 0040       str              r0,writemem_tbl+28
 1679 00000086         
 1680 00000086         ;-------------------------------------------------------
                       ------------------------
 1681 00000086 F7FF FFFE       bl               CPU_reset   ;reset everything e
                                                            lse
 1682 0000008A E8BD 4FF0       ldmfd            sp!,{r4-r11,lr}
 1683 0000008E 4770            bx               lr
 1684 00000090                 ENDP
 1685 00000090         
 1686 00000090         ;-------------------------------------------------------
                       ---------------------
 1687 00000090         map67_0                              ;mapper3 r0=page# ;
                                                            6502.s¶íÂÞË¹·½¿éÐèÒ
                                                            ª
 1688 00000090         ;-------------------------------------------------------
                       ---------------------
 1689 00000090 F8DF A11C       ldr              r10,=cpu_data ;¶ÁÈ¡µØÖ·
 1690 00000094 F04F 0900       mov              r9,#0       ;(Ïû³ýÈÎºÎencodePCµ



ARM Macro Assembler    Page 159 


                                                            ÄÓ³ÉäÆ÷*³õÊ¼»¯¹ý³ÌÖ
                                                            ÐµÄ´íÎó)
 1691 00000098 F8CA 9084       str              r9,lastbank ;6502PC´Ó ROMµÄ×îºó
                                                            Æ«ÒÆÁ¿Ð´0
 1692 0000009C         map67_
 1693 0000009C F8DA 1094       ldr              r1,rommask
 1694 000000A0 EA01 3040       and              r0,r1,r0,lsl#13
 1695 000000A4 F8DA 108C       ldr              r1,rombase
 1696 000000A8 4408            add              r0,r1,r0
 1697 000000AA F5A0 40C0       sub              r0,r0,#0x6000
 1698 000000AE F8CA 0050       str              r0,memmap_tbl+12
 1699 000000B2 E03C            b                flush
 1700 000000B4         ;-------------------------------------------------------
                       ---------------------
 1701 000000B4         map89_                               ;rom paging.. r0=pa
                                                            ge# ROM·ÖÒ³
 1702 000000B4         ;-------------------------------------------------------
                       ---------------------
 1703 000000B4 F8DA 108C       ldr              r1,rombase  ;rom¿ªÊ¼µØÖ·
 1704 000000B8 F5A1 4100       sub              r1,r1,#0x8000
 1705 000000BC F8DA 2094       ldr              r2,rommask
 1706 000000C0 EA02 3040       and              r0,r2,r0,lsl#13
 1707 000000C4 4408            add              r0,r1,r0
 1708 000000C6 F8CA 0054       str              r0,memmap_tbl+16
 1709 000000CA E030            b                flush
 1710 000000CC         ;-------------------------------------------------------
                       ---------------------
 1711 000000CC         mapAB_
 1712 000000CC         ;-------------------------------------------------------
                       ---------------------
 1713 000000CC F8DA 108C       ldr              r1,rombase
 1714 000000D0 F5A1 4120       sub              r1,r1,#0xa000
 1715 000000D4 F8DA 2094       ldr              r2,rommask
 1716 000000D8 EA02 3040       and              r0,r2,r0,lsl#13
 1717 000000DC 4408            add              r0,r1,r0
 1718 000000DE F8CA 0058       str              r0,memmap_tbl+20
 1719 000000E2 E024            b                flush
 1720 000000E4         ;-------------------------------------------------------
                       ---------------------
 1721 000000E4         mapCD_
 1722 000000E4         ;-------------------------------------------------------
                       ---------------------
 1723 000000E4 F8DA 108C       ldr              r1,rombase
 1724 000000E8 F5A1 4140       sub              r1,r1,#0xc000
 1725 000000EC F8DA 2094       ldr              r2,rommask
 1726 000000F0 EA02 3040       and              r0,r2,r0,lsl#13
 1727 000000F4 4408            add              r0,r1,r0
 1728 000000F6 F8CA 005C       str              r0,memmap_tbl+24
 1729 000000FA E018            b                flush
 1730 000000FC         ;-------------------------------------------------------
                       ---------------------
 1731 000000FC         mapEF_
 1732 000000FC         ;-------------------------------------------------------
                       ---------------------
 1733 000000FC F8DA 108C       ldr              r1,rombase
 1734 00000100 F5A1 4160       sub              r1,r1,#0xe000
 1735 00000104 F8DA 2094       ldr              r2,rommask
 1736 00000108 EA02 3040       and              r0,r2,r0,lsl#13
 1737 0000010C 4408            add              r0,r1,r0



ARM Macro Assembler    Page 160 


 1738 0000010E F8CA 0060       str              r0,memmap_tbl+28
 1739 00000112 E00C            b                flush
 1740 00000114         ;-------------------------------------------------------
                       ---------------------
 1741 00000114         map89AB_
 1742 00000114         ;-------------------------------------------------------
                       ---------------------
 1743 00000114 F8DA 108C       ldr              r1,rombase  ;rom»ùµØÖ·£¨²»°üÀ¨Í
                                                            ·£©
 1744 00000118 F5A1 4100       sub              r1,r1,#0x8000
 1745 0000011C F8DA 2094       ldr              r2,rommask
 1746 00000120 EA02 3080       and              r0,r2,r0,lsl#14
 1747 00000124 4408            add              r0,r1,r0
 1748 00000126 F8CA 0054       str              r0,memmap_tbl+16
 1749 0000012A F8CA 0058       str              r0,memmap_tbl+20
 1750 0000012E         flush                                ;update m6502_pc & 
                                                            lastbank
 1751 0000012E F8DA 1084       ldr              r1,lastbank
 1752 00000132 EBA9 0901       sub              r9,r9,r1
 1753 00000136 F409 4160       and              r1,r9,#0xE000 ;//r9ºÍ0xe000°´Î»
                                                            ÓëÔËËã
 1754 0000013A F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
 1755 0000013E EA4F 21D1       lsr              r1,r1,#11   ;//>>11Î»   r1/2048
                                                            
 1756 00000142 5850            ldr              r0,[r2,r1]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
 1757 00000144         
 1758 00000144 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
 1759 00000148 4481            add              r9,r9,r0    ;//m6502_pc+r0
 1760 0000014A F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1761 0000014E 4770            bx               lr
 1762 00000150         
 1763 00000150         ;-------------------------------------------------------
                       ---------------------
 1764 00000150         mapCDEF_
 1765 00000150         ;-------------------------------------------------------
                       ---------------------
 1766 00000150 F8DA 108C       ldr              r1,rombase
 1767 00000154 F5A1 4140       sub              r1,r1,#0xc000
 1768 00000158 F8DA 2094       ldr              r2,rommask
 1769 0000015C EA02 3080       and              r0,r2,r0,lsl#14
 1770 00000160 4408            add              r0,r1,r0
 1771 00000162 F8CA 005C       str              r0,memmap_tbl+24
 1772 00000166 F8CA 0060       str              r0,memmap_tbl+28
 1773 0000016A E7E0            b                flush
 1774 0000016C         ;-------------------------------------------------------
                       ---------------------
 1775 0000016C         map89ABCDEF_                         ;mapper9
 1776 0000016C         ;-------------------------------------------------------
                       ---------------------
 1777 0000016C F8DF A040       ldr              r10,=cpu_data ;¶ÁÈ¡µØÖ·
 1778 00000170 F04F 0900       mov              r9,#0       ;(Ïû³ýÈÎºÎencodePCµ
                                                            ÄÓ³ÉäÆ÷*³õÊ¼»¯¹ý³ÌÖ
                                                            ÐµÄ´íÎó)
 1779 00000174 F8CA 9084       str              r9,lastbank ;6502PC´Ó ROMµÄ×îºó
                                                            Æ«ÒÆÁ¿Ð´0



ARM Macro Assembler    Page 161 


 1780 00000178         
 1781 00000178 F8DA 108C       ldr              r1,rombase
 1782 0000017C F5A1 4100       sub              r1,r1,#0x8000
 1783 00000180 F8DA 2094       ldr              r2,rommask
 1784 00000184 EA02 30C0       and              r0,r2,r0,lsl#15
 1785 00000188 4408            add              r0,r1,r0
 1786 0000018A F8CA 0054       str              r0,memmap_tbl+16
 1787 0000018E F8CA 0058       str              r0,memmap_tbl+20
 1788 00000192 F8CA 005C       str              r0,memmap_tbl+24
 1789 00000196 F8CA 0060       str              r0,memmap_tbl+28
 1790 0000019A E7C8            b                flush
 1791 0000019C         
 1792 0000019C         ;*******************************************************
                       ******************************
 1793 0000019C                 IMPORT           asm_Mapper_Write ;
 1794 0000019C         Mapper_W
 1795 0000019C         ;-------------------------------------------
 1796 0000019C B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ»
 1797 0000019E 4661            mov              r1,r12
 1798 000001A0 F7FF FFFE       bl               asm_Mapper_Write
 1799 000001A4 E8BD 4008       ldmfd            sp!,{r3,lr}
 1800 000001A8 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1801 000001AC 4770            bx               lr
 1802 000001AE BF00            nop
 1803 000001B0         ;-------------------------------------------------------
                       --------------------------------
 1804 000001B0         
 1805 000001B0         ;*******************************************************
                       **********************************************
 1806 000001B0         
 1807 000001B0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         AREA             cpu_run, CODE, READONLY
 1808 00000000         run6502 PROC                         ;r0=ÒªÔËÐÐµÄcpuÖÜÆÚ
                                                            *256
 1809 00000000         ;-------------------------------------------------------
                       ---------------------
 1810 00000000         
 1811 00000000 E92D 4FF0       stmfd            sp!,{r4-r11,lr} ;½«Õâ¼¸¸ö¼Ä´æÆ÷
                                                            ÖÐµÄÖµ±£´æµ½¶ÑÕ»ÖÐ
 1812 00000004         
 1813 00000004 F8DF A180       ldr              globalptr,=cpu_data ;r10   wram
                                                            _globals: ¶ÁÈ¡µØÖ·
 1814 00000008 F8DF B180       ldr              cpu_zpage,=NES_RAM ;r11
 1815 0000000C F8DB B000       ldr              cpu_zpage,[cpu_zpage] 
                                                            ;NES_RAMÓÃÁËÖ¸Õë
 1816 00000010         
 1817 00000010 F10A 0164       adr              r1,cpuregs
 1818 00000014 E891 03F8       ldmia            r1,{m6502_nz-m6502_pc} ;restore
                                                             6502 state»Ö¸´6502
                                                            ×´Ì¬  r3-r9 
 1819 00000018 4480            add              cycles,cycles,r0
 1820 0000001A         
 1821 0000001A F89A 00A8       ldrb             r0,cpuirqf  ;cpuÖÐ¶Ï±êÖ¾



ARM Macro Assembler    Page 162 


 1822 0000001E 2801            cmp              r0,#0x01    ;
 1823 00000020 D036            beq              CheckI      ;EQ       ÏàµÈ(EQua
                                                            l) irq6502;
 1824 00000022         
 1825 00000022                 fetch            0           ;//ÌáÈ¡²Ù×÷Âë²¢ÔËÐÐ
                                                                      
   70 00000022         ;//-----------------------------------------------------
                       ----------------
   71 00000022 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000026 F100 0000       add              r0,r0,#0
   73 0000002A F8CA 00A0       str              r0,clocksh
   74 0000002E         
   75 0000002E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 00000032         ;//-----------------------------------------------------
                       --------------------
   77 00000032 F1B8 0800       subs             cycles,cycles,#0*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000036 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 0000003C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 0000003C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 00000040 F8DA F088       ldr              pc,nexttimeout
 1826 00000044         exit_run
 1827 00000044         
 1828 00000044 F89A 00A4       ldrb             r0,cpunmif  ;cpuÖÐ¶Ï±êÖ¾
 1829 00000048 2801            cmp              r0,#0x01    ;
 1830 0000004A D0FE            beq              NMI6502     ;EQ       ÏàµÈ(EQua
                                                            l) 
 1831 0000004C         
 1832 0000004C         exit_nmi
 1833 0000004C F10A 0064       adr              r0,cpuregs
 1834 00000050 E880 03F8       stmia            r0,{m6502_nz-m6502_pc} ;±£´æ650
                                                            2×´Ì¬   r3-r9
 1835 00000054         
 1836 00000054 E8BD 8FF0       ldmfd            sp!,{r4-r11,pc} ;exit      
 1837 00000058                 ENDP
 1838 00000058         ;*******************************************************
                       ********************************
 1839 00000058         NMI6502 PROC                         ;------------------
                                                            ---------
 1840 00000058 F04F 0000       mov              r0,#0
 1841 0000005C F8CA 00A4       str              r0,cpunmif  ;Çå³ýcpuÖÐ¶Ï±êÖ¾   
                                                            
 1842 00000060         
 1843 00000060 F64F 7CFA       ldr              r12,=NMI_VECTOR ;NMI?  addy
 1844 00000064 F000 F830       bl               Vec6502
 1845 00000068 F5A8 68E0       sub              cycles,cycles,#7*256 ;CYCLE=256
                                                              6502µÄÖÐ¶ÏÇ±·üÆÚÎ
                                                            ªÆß (7) ¸öÖÜ
 1846 0000006C         ; ÆÚ; ÕâÒ²¾ÍÊÇËµÐèÒªÐèÒªÆß (7) ¸öÖÜÆÚÀ´ÒÆÈëºÍÒÆ³öÒ»¸öÖÐ¶
                       Ï
 1847 0000006C E7EE            b                exit_nmi    ;return 



ARM Macro Assembler    Page 163 


 1848 0000006E                 ENDP
 1849 0000006E         ;-------------------------------------------------------
                       ---------------------
 1850 0000006E         
 1851 0000006E         default_scanlinehook
 1852 0000006E         
 1853 0000006E                 fetch            0
   70 0000006E         ;//-----------------------------------------------------
                       ----------------
   71 0000006E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 00000072 F100 0000       add              r0,r0,#0
   73 00000076 F8CA 00A0       str              r0,clocksh
   74 0000007A         
   75 0000007A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 0000007E         ;//-----------------------------------------------------
                       --------------------
   77 0000007E F1B8 0800       subs             cycles,cycles,#0*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 00000082 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 00000088         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 00000088 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 0000008C F8DA F088       ldr              pc,nexttimeout
 1854 00000090         ;-------------------------------------------------------
                       ---
 1855 00000090         CheckI                               ;Check Interrupt Di
                                                            sable ¼ì²éÖÐ¶Ï½ûÓÃ
 1856 00000090         ;-------------------------------------------------------
                       ---
 1857 00000090 F018 0F04       tst              cycles,#CYC_I
 1858 00000094 D1EB            bne              default_scanlinehook ;we dont w
                                                            ant no stinkin irqs
                                                             ÎÒÃÇ²»ÐèÒªÃ»ÓÐÌÖÑá
                                                            µÄIRQ
 1859 00000096         ;-------------------------------------------------------
                       ---
 1860 00000096         irq6502
 1861 00000096         ;-------------------------------------------------------
                       ---
 1862 00000096 F04F 0000       mov              r0,#0
 1863 0000009A F8CA 00A8       str              r0,cpuirqf  ;Çå³ýcpuÖÐ¶Ï±êÖ¾
 1864 0000009E         
 1865 0000009E F64F 7CFE       ldr              r12,=IRQ_VECTOR
 1866 000000A2 F000 F811       bl               Vec6502
 1867 000000A6                 fetch            7
   70 000000A6         ;//-----------------------------------------------------
                       ----------------
   71 000000A6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   72 000000AA F100 0007       add              r0,r0,#7
   73 000000AE F8CA 00A0       str              r0,clocksh
   74 000000B2         



ARM Macro Assembler    Page 164 


   75 000000B2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   76 000000B6         ;//-----------------------------------------------------
                       --------------------
   77 000000B6 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   78 000000BA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   79 000000C0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   80 000000C0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   81 000000C4 F8DA F088       ldr              pc,nexttimeout
 1868 000000C8         ;-------------------------------------------------------
                       ---
 1869 000000C8         Vec6502
 1870 000000C8         ;-------------------------------------------------------
                       ---
 1871 000000C8 F8DA 0084       ldr              r0,lastbank
 1872 000000CC EBA9 0000       sub              r0,m6502_pc,r0
 1873 000000D0                 push16                       ;save PC
  217 000000D0 EA4F 2110       mov              r1,r0,lsr#8
  218 000000D4 F8DA 2080       ldr              r2,m6502_s
  219 000000D8 F802 1901       strb             r1,[r2],#-1
  220 000000DC F442 7280       orr              r2,r2,#0x100
  221 000000E0 F802 0901       strb             r0,[r2],#-1
  222 000000E4 F88A 2080       strb             r2,m6502_s
 1874 000000E8         
 1875 000000E8                 encodeP          (R)         ;save P
   51 000000E8 F008 004D       and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   52 000000EC F013 4F00       tst              m6502_nz,#0x80000000 ;//PSR_N
   53 000000F0 BF18 F040 
              0080             orrne            r0,r0,#N    ;N
   54 000000F6 F013 0FFF       tst              m6502_nz,#0xff
   55 000000FA BF08 F040 
              0002             orreq            r0,r0,#Z    ;Z
   56 00000100 F040 0020       orr              r0,r0,#(R)  ;R(&B)
 1876 00000104         VecCont
 1877 00000104                 push8            r0
  227 00000104 F8DA 2080       ldr              r2,m6502_s
  228 00000108 F802 0901       strb             r0,[r2],#-1
  229 0000010C F88A 2080       strb             r2,m6502_s
 1878 00000110         
 1879 00000110 F048 0804       orr              cycles,cycles,#CYC_I ;disable I
                                                            RQ ½ûÓÃIRQ
 1880 00000114         
 1881 00000114 F8DA 0060       ldr              r0,memmap_tbl+28 ;7*4
 1882 00000118         ; ldrb m6502_pc,[r0,r12]!
 1883 00000118 F810 900C       ldrb             m6502_pc,[r0,r12] ;ÔÚÊý¾Ý´«ËÍÖ®
                                                            Ç°,½«Æ«ÒÆÁ¿¼Óµ½Rn Ö
                                                            Ð,Æä½á¹û×÷Îª´«ËÍÊý¾
                                                            ÝµÄ´æ´¢µØÖ·
 1884 0000011C         ;ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
 1885 0000011C 4460            add              r0,r0,r12   ;R12=0xfffc ;// ¸´Î
                                                            »ÖÐ¶ÏÏòÁ¿µØÖ·



ARM Macro Assembler    Page 165 


 1886 0000011E         
 1887 0000011E 7842            ldrb             r2,[r0,#1]
 1888 00000120 EA49 2902       orr              m6502_pc,m6502_pc,r2,lsl#8
 1889 00000124                 encodePC                     ;get IRQ vectorµÃµ½
                                                            6502 PC ROMµÄÆ«ÒÆÁ¿
                                                            
   39 00000124 F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   40 00000128 F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   41 0000012C         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   42 0000012C EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   43 00000130 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   44 00000132         
   45 00000132 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   46 00000136 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
 1890 00000138         
 1891 00000138 4770            bx               lr          ; º¯Êý·µ»Ø
 1892 0000013A         ;-------------------------------------------------------
                       ---------------------
 1893 0000013A         CPU_reset
                               PROC                         ;called by loadcart
                                                             (r0-r9 are free to
                                                             use)
 1894 0000013A         ;-------------------------------------------------------
                       ---------------------
 1895 0000013A F84D ED04       str              lr,[sp,#-4]!
 1896 0000013E         
 1897 0000013E F04F 0500       mov              m6502_a,#0
 1898 00000142 F04F 0600       mov              m6502_x,#0
 1899 00000146 F04F 0700       mov              m6502_y,#0
 1900 0000014A F04F 0300       mov              m6502_nz,#0
 1901 0000014E F10A 0404       adr              m6502_rmem,readmem_tbl ;°Ñreadm
                                                            em_tblµÄµØÖ·¼ÓÔØµ½m
                                                            6502_rmem
 1902 00000152         
 1903 00000152         ; ldr r0,=NES_RAM+0x100    ;256 
 1904 00000152 480E            ldr              r0,=NES_RAM ;NES_RAMÓÃÁËÖ¸Õë
 1905 00000154 6800            ldr              r0,[r0]     ;
 1906 00000156 F500 7080       add              r0,#0x100
 1907 0000015A         
 1908 0000015A F8CA 0080       str              r0,m6502_s  ;S=0xFD (0x100-3)  
                                                             °ÑÒ»¸ö¼Ä´æÆ÷°´×Ö´æ
                                                            ´¢µ½´æ´¢Æ÷ÖÐ
 1909 0000015E         ;-------------------------------------------------------
                        
 1910 0000015E F04F 0000       mov              r0,#0
 1911 00000162 F8CA 00A4       str              r0,cpunmif  ;Çå³ýcpuÖÐ¶Ï±êÖ¾
 1912 00000166 F8CA 00A8       str              r0,cpuirqf  ;Çå³ýcpuÖÐ¶Ï±êÖ¾
 1913 0000016A         ;------------------------------------------ 
 1914 0000016A F04F 0800       mov              cycles,#0   ;D=0, C=0, V=0, I=1
                                                             disable IRQ.
 1915 0000016E         
 1916 0000016E F64F 7CFC       ldr              r12,=RES_VECTOR ;// ¸´Î»ÖÐ¶ÏÏòÁ
                                                            ¿µØÖ·



ARM Macro Assembler    Page 166 


 1917 00000172 F7FF FFA9       bl               Vec6502
 1918 00000176         
 1919 00000176 F10A 0064       adr              r0,cpuregs  ;¶ÁÈ¡µØÖ·
 1920 0000017A E880 03F8       stmia            r0,{m6502_nz-m6502_pc} 
                                                            ;±£´æ6502×´Ì¬
 1921 0000017E         
 1922 0000017E 4904            ldr              r1,=exit_run ;
 1923 00000180 F8CA 1088       str              r1,nexttimeout ;±£´æÖ¸ÁîÖ´ÐÐÍêº
                                                            óÏÂÒ»²½µÄPCµØÖ·
 1924 00000184         
 1925 00000184 F85D FB04       ldr              pc,[sp],#4
 1926 00000188                 ENDP
 1927 00000188         ; nop
 1928 00000188         ;-------------------------------------------------------
                       ------------------
 1929 00000188         
 1930 00000188 00000000 
              00000000 
              00000000         AREA             rwram_code, CODE, READONLY ;REA
                                                            DWRITE*************
                                                            *******************
                                                            ******
 1931 00000000         ;-------------------------------------------------------
                       ---------------------
 1932 00000000         ;memory
 1933 00000000         ;-------------------------------------------------------
                       -----------------
 1934 00000000         empty_R                              ;¶ÁµØÖ·²»ÕýÈ·read b
                                                            ad address (error)
 1935 00000000         ;-------------------------------------------------------
                       --------------------- 
 1936 00000000 4660            mov              r0,r12
 1937 00000002 F04F 0102       mov              r1,#2
 1938 00000006 F7FF FFFE       bl               debug_6502
 1939 0000000A         ;----------------------------------
 1940 0000000A F04F 0000       mov              r0,#0
 1941 0000000E F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1942 00000012 4770            bx               lr
 1943 00000014         ;-------------------------------------------------------
                       ---------------------
 1944 00000014         void    PROC                         ;- - - - - - - - -¿
                                                            Õº¯Êý
 1945 00000014 F04F 0000       mov              r0,#0
 1946 00000018 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1947 0000001C 4770            bx               lr
 1948 0000001E                 ENDP
 1949 0000001E         ;-------------------------------------------------------
                       ---------------------
 1950 0000001E         ram_R                                ;ram read ($0000-$1
                                                            FFF)
 1951 0000001E         ;-------------------------------------------------------
                       ---------------------
 1952 0000001E F42C 3CFC       bic              addy,addy,#0x1f800 
                                                            ;only 0x07FF is RAM
                                                            
 1953 00000022 F81B 000C       ldrb             r0,[cpu_zpage,addy]
 1954 00000026 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ



ARM Macro Assembler    Page 167 


                                                            ëarm×´Ì¬
 1955 0000002A 4770            bx               lr
 1956 0000002C         ;-------------------------------------------------------
                       ---------------------
 1957 0000002C         ram_W                                ;ram write ($0000-$
                                                            1FFF)
 1958 0000002C         ;-------------------------------------------------------
                       ---------------------
 1959 0000002C F42C 3CFC       bic              addy,addy,#0x1f800 
                                                            ;only 0x07FF is RAM
                                                            
 1960 00000030 F80B 000C       strb             r0,[cpu_zpage,addy] ; cpu_zpage
                                                             RN r11 ;=CPU_RAM
 1961 00000034 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1962 00000038 4770            bx               lr
 1963 0000003A         ;-------------------------------------------------------
                       ---------------------
 1964 0000003A         sram_R                               ;sram read ($6000-$
                                                            7FFF)
 1965 0000003A         ;-------------------------------------------------------
                       ---------------------
 1966 0000003A F5AC 41C0       sub              r1,addy,#0x6000
 1967 0000003E F8DA 2050       ldr              r2,memmap_tbl+12
 1968 00000042         ; ldrb r0,[cpu_zpage,r1]
 1969 00000042 5C50            ldrb             r0,[r2,r1]
 1970 00000044 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1971 00000048 4770            bx               lr
 1972 0000004A         ;-------------------------------------------------------
                       ---------------------
 1973 0000004A         sram_W                               ;sram write ($6000-
                                                            $7FFF)
 1974 0000004A         ;-------------------------------------------------------
                       ---------------------
 1975 0000004A F5AC 4CC0       sub              addy,addy,#0x6000
 1976 0000004E F8DA 1050       ldr              r1,memmap_tbl+12
 1977 00000052         ; strb r0,[cpu_zpage,addy]
 1978 00000052 F801 000C       strb             r0,[r1,addy]
 1979 00000056 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1980 0000005A 4770            bx               lr
 1981 0000005C         ;-------------------------------------------------------
                       ---------------------
 1982 0000005C         rom_R60                              ;rom read ($6000-$7
                                                            FFF)
 1983 0000005C         ;-------------------------------------------------------
                       ---------------------
 1984 0000005C F8DA 1050       ldr              r1,memmap_tbl+12
 1985 00000060 F811 000C       ldrb             r0,[r1,addy]
 1986 00000064 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1987 00000068 4770            bx               lr
 1988 0000006A         ;-------------------------------------------------------
                       ---------------------
 1989 0000006A         rom_R80                              ;rom read ($8000-$9
                                                            FFF)
 1990 0000006A         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 168 


 1991 0000006A F8DA 1054       ldr              r1,memmap_tbl+16
 1992 0000006E F811 000C       ldrb             r0,[r1,addy]
 1993 00000072 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1994 00000076 4770            bx               lr
 1995 00000078         ;-------------------------------------------------------
                       ---------------------
 1996 00000078         rom_RA0                              ;rom read ($A000-$B
                                                            FFF)
 1997 00000078         ;-------------------------------------------------------
                       ---------------------
 1998 00000078 F8DA 1058       ldr              r1,memmap_tbl+20
 1999 0000007C F811 000C       ldrb             r0,[r1,addy]
 2000 00000080 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2001 00000084 4770            bx               lr
 2002 00000086         ;-------------------------------------------------------
                       ---------------------
 2003 00000086         rom_RC0                              ;rom read ($C000-$D
                                                            FFF)
 2004 00000086         ;-------------------------------------------------------
                       ---------------------
 2005 00000086 F8DA 105C       ldr              r1,memmap_tbl+24
 2006 0000008A F811 000C       ldrb             r0,[r1,addy]
 2007 0000008E F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2008 00000092 4770            bx               lr
 2009 00000094         ;-------------------------------------------------------
                       ---------------------
 2010 00000094         rom_RE0                              ;rom read ($E000-$F
                                                            FFF)
 2011 00000094         ;-------------------------------------------------------
                       ---------------------
 2012 00000094 F8DA 1060       ldr              r1,memmap_tbl+28
 2013 00000098 F811 000C       ldrb             r0,[r1,addy]
 2014 0000009C F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2015 000000A0 4770            bx               lr
 2016 000000A2         
 2017 000000A2 BF00            nop
 2018 000000A4         ;-------------------------------------------------------
                       ---------------------
 2019 000000A4         ;IO
 2020 000000A4                 AREA             io_code, CODE, READONLY ;--
 2021 00000000         ;-------------------------------------------------------
                       ---------------------
 2022 00000000         
 2023 00000000         ;-------------------------------------------------------
                       ---------------------
 2024 00000000         IO_R                                 ;I/O read
 2025 00000000         ;-------------------------------------------------------
                       ---------------------
 2026 00000000 F244 0218       mov              r2,#0x4018  ;$4018-$6000
 2027 00000004 4594            cmp              r12,r2
 2028 00000006 D8FE            bhi              Read_Low    ;HI  ÎÞ·ûºÅÊý´óÓÚ  
                                                            C==1 && Z==0 
 2029 00000008         
 2030 00000008 F5AC 4180       sub              r1,r12,#0x4000 ;addy=r12
 2031 0000000C 3915            subs             r1,r1,#0x15



ARM Macro Assembler    Page 169 


 2032 0000000E F53F AFFE       bmi              empty_R     ;¶ÁµØÖ·²»ÕýÈ· MI   
                                                                ¸ºÊý(MInus)    
                                                                           N==1
                                                             
 2033 00000012 2903            cmp              r1,#3
 2034 00000014         ; ldrmi pc,[pc,r2,lsl#2]
 2035 00000014 4A69            ldr              r2,=io_read_tbl ;//¸Ä¹ý£¬¼Ó3ÐÐ
 2036 00000016 EB02 0281       add              r2,r2,r1,lsl#2 ;<<2
 2037 0000001A BF48 F8D2 
              F000             ldrmi            pc,[r2]
 2038 00000020 F7FF BFFE       b                empty_R     ;¶ÁµØÖ·²»ÕýÈ·
 2039 00000024         ; nop
 2040 00000024         
 2041 00000024         io_read_tbl
 2042 00000024 00000000        DCD              apu_4015R   ;void;_4015r ;4015 
                                                            (sound)
 2043 00000028 00000000        DCD              joy0_R      ;4016: controller 1
                                                            
 2044 0000002C 00000000        DCD              joy1_R      ;4017: controller 2
                                                            
 2045 00000030         ;-------------------------------------------------------
                       ---------------------
 2046 00000030         IO_W                                 ;I/O write
 2047 00000030         ;-------------------------------------------------------
                       ---------------------
 2048 00000030 F244 0218       mov              r2,#0x4018  ;$4018-$6000
 2049 00000034 4594            cmp              r12,r2
 2050 00000036 D8FE            bhi              Write_Low   ;HI  ÎÞ·ûºÅÊý´óÓÚ  
                                                            C==1 && Z==0 
 2051 00000038         
 2052 00000038 F5AC 4180       sub              r1,r12,#0x4000 ;addy=r12
 2053 0000003C 2918            cmp              r1,#0x18
 2054 0000003E         ; ldrmi pc,[pc,r2,lsl#2]
 2055 0000003E 4A60            ldr              r2,=io_write_tbl ;//¸Ä¹ý£¬¼Ó3ÐÐ
                                                            
 2056 00000040 EB02 0281       add              r2,r2,r1,lsl#2 ;<<2  
 2057 00000044 BF48 F8D2 
              F000             ldrmi            pc,[r2]     ;//Ö±½Ó²Ù×÷pcÌ«ËûÂè
                                                            Î£ÏÕÁË
 2058 0000004A F7FF BFFE       b                empty_R     ;¶ÁµØÖ·²»ÕýÈ·
 2059 0000004E BF00            nop
 2060 00000050         
 2061 00000050         io_write_tbl
 2062 00000050 00000000        DCD              apu_w       ;void;_4000w
 2063 00000054 00000000        DCD              apu_w       ;_4001w
 2064 00000058 00000000        DCD              apu_w       ;_4002w
 2065 0000005C 00000000        DCD              apu_w       ;_4003w
 2066 00000060 00000000        DCD              apu_w       ;_4004w
 2067 00000064 00000000        DCD              apu_w       ;_4005w
 2068 00000068 00000000        DCD              apu_w       ;_4006w
 2069 0000006C 00000000        DCD              apu_w       ;_4007w
 2070 00000070 00000000        DCD              apu_w       ;_4008w
 2071 00000074 00000000        DCD              apu_w       ;void;
 2072 00000078 00000000        DCD              apu_w       ;_400aw
 2073 0000007C 00000000        DCD              apu_w       ;void;_400bw
 2074 00000080 00000000        DCD              apu_w       ;void;_400cw
 2075 00000084 00000000        DCD              apu_w       ;void
 2076 00000088 00000000        DCD              apu_w       ;void;_400ew
 2077 0000008C 00000000        DCD              apu_w       ;void;_400fw



ARM Macro Assembler    Page 170 


 2078 00000090 00000000        DCD              apu_w       ;void;_4010w
 2079 00000094 00000000        DCD              apu_w       ;void;_4011w
 2080 00000098 00000000        DCD              apu_w       ;void;_4012w
 2081 0000009C 00000000        DCD              apu_w       ;void;_4013w
 2082 000000A0 00000000        DCD              dma_W       ;$4014: Sprite DMA 
                                                            transfer
 2083 000000A4 00000000        DCD              apu_4015w   ;void;_4015w   ; Éù
                                                            ÒôÍ¨µÀÇÐ»» 
 2084 000000A8         
 2085 000000A8 00000000        DCD              joy0_W      ;$4016: Joypad 0 wr
                                                            ite;joypad_write_pt
                                                            r
 2086 000000AC 00000000        DCD              apu_4017w   ;void;$4017: ?
 2087 000000B0         
 2088 000000B0         ;-------------------------------------------------------
                       ------------------------
 2089 000000B0                 IMPORT           asm_Mapper_ReadLow
 2090 000000B0         Read_Low
                               PROC                         ;$5000-$6000  mappe
                                                            r->MemoryReadLow(ad
                                                            dr); 
 2091 000000B0         ;-------------------------------------------------------
                       -----------------------
 2092 000000B0 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 2093 000000B2 4660            mov              r0,r12
 2094 000000B4 F7FF FFFE       bl               asm_Mapper_ReadLow
 2095 000000B8         
 2096 000000B8 E8BD 4008       ldmfd            sp!,{r3,lr}
 2097 000000BC F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2098 000000C0 4770            bx               lr
 2099 000000C2                 ENDP
 2100 000000C2         ;-------------------------------------------------------
                       ------------------------
 2101 000000C2                 IMPORT           asm_Mapper_WriteLow
 2102 000000C2         Write_Low
                               PROC                         ;$5000-$6000  mappe
                                                            r->MemoryWriteLow( 
                                                            data, addr); 
 2103 000000C2         ;-------------------------------------------------------
                       -----------------------
 2104 000000C2 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 2105 000000C4 4661            mov              r1,r12
 2106 000000C6 F7FF FFFE       bl               asm_Mapper_WriteLow
 2107 000000CA         
 2108 000000CA E8BD 4008       ldmfd            sp!,{r3,lr}
 2109 000000CE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2110 000000D2 4770            bx               lr
 2111 000000D4                 ENDP
 2112 000000D4         ;-------------------------------------------------------
                       ----------------------
 2113 000000D4                 IMPORT           Apu_Write   ;apu.c 
 2114 000000D4                 IMPORT           Apu_Write4015 ;apu.c 
 2115 000000D4         ;-------------------------------------------------------
                       ----------------------------
 2116 000000D4         apu_w                                ; 0x4000--0x4013
 2117 000000D4         ;-------------------------------------------------------
                       --------------------------



ARM Macro Assembler    Page 171 


 2118 000000D4 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 2119 000000D6 F7FF FFFE       bl               Apu_Write
 2120 000000DA         
 2121 000000DA E8BD 4008       ldmfd            sp!,{r3,lr}
 2122 000000DE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2123 000000E2 4770            bx               lr
 2124 000000E4         ;-------------------------------------------------------
                       ----------------------------
 2125 000000E4         apu_4015w
 2126 000000E4         ;-------------------------------------------------------
                       ------------------
 2127 000000E4 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ»     
                                                             
 2128 000000E6 F7FF FFFE       bl               Apu_Write4015
 2129 000000EA         
 2130 000000EA E8BD 4008       ldmfd            sp!,{r3,lr}
 2131 000000EE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2132 000000F2 4770            bx               lr
 2133 000000F4         ;-------------------------------------------------------
                       ----------------------------
 2134 000000F4                 IMPORT           Apu_Write4017 ;apu.c
 2135 000000F4         apu_4017w
 2136 000000F4         ;-------------------------------------------------------
                       ------------------
 2137 000000F4 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ»     
                                                             
 2138 000000F6 F7FF FFFE       bl               Apu_Write4017
 2139 000000FA         
 2140 000000FA E8BD 4008       ldmfd            sp!,{r3,lr}
 2141 000000FE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2142 00000102 4770            bx               lr
 2143 00000104         ;-------------------------------------------------------
                       ---------------------
 2144 00000104                 IMPORT           Apu_Read4015 ;apu.c
 2145 00000104         apu_4015R                            ;4015
 2146 00000104         ;-------------------------------------------------------
                       --------------------------- 
 2147 00000104 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 2148 00000106 F101 0015       add              r0,r1,#0x15
 2149 0000010A F7FF FFFE       bl               Apu_Read4015
 2150 0000010E         
 2151 0000010E E8BD 4008       ldmfd            sp!,{r3,lr}
 2152 00000112 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2153 00000116 4770            bx               lr
 2154 00000118         ;-------------------------------------------------------
                       ---------------------
 2155 00000118         dma_W                                ;(4014)  sprite DMA
                                                             transfer ¾«ÁéDMA´«
                                                            Êä DMA·ÃÎÊ¾«ÁéRAM£º
                                                            
 2156 00000118         ;Í¨¹ýÐ´Ò»¸öÖµxxµ½Õâ¸ö¶Ë¿Ú£¬ÒýÆðCPUÄÚ´æµØÖ·Îª$xx00£­$xxFF
                       µÄÇøÓò´«ËÍµ½¾«ÁéÄÚ´æ 
 2157 00000118         ;-------------------------------------------------------
                       ---------------------
 2158 00000118 F5A8 3800       sub              cycles,cycles,#512*256



ARM Macro Assembler    Page 172 


 2159 0000011C B508            stmfd            sp!,{r3,lr}
 2160 0000011E         
 2161 0000011E F000 01E0       and              r1,r0,#0xe0
 2162 00000122 F10A 0244       adr              r2,memmap_tbl ;CPU_RAM 
 2163 00000126 EA4F 01D1       lsr              r1,r1,#3    ;>>3
 2164 0000012A 5852            ldr              r2,[r2,r1]
 2165 0000012C F000 00FF       and              r0,r0,#0xff
 2166 00000130 EB02 2200       add              r2,r2,r0,lsl#8 ;addy  r2=DMA so
                                                            urce Ô´
 2167 00000134 4923            ldr              r1,=spr_ram ;r1     DMAµÄ Ä¿µÄµ
                                                            Ø    ppu.c
 2168 00000136 6809            ldr              r1,[r1]     ;spr_ramÓÃÁËÖ¸Õë
 2169 00000138         
 2170 00000138 F04F 0040       mov              r0,#64      ;256/4
 2171 0000013C         copy_
 2172 0000013C 1E40            subs             r0,r0,#1    ;-1
 2173 0000013E F852 3020       ldr              r3,[r2,r0,lsl#2]
 2174 00000142 F841 3020       str              r3,[r1,r0,lsl#2] ;<<2    *4
 2175 00000146 D1F9            bne              copy_       ;r0!=0
 2176 00000148         
 2177 00000148 E8BD 4008       ldmfd            sp!,{r3,lr}
 2178 0000014C F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2179 00000150 4770            bx               lr
 2180 00000152         ;-------------------------------------------------------
                       ---------------------
 2181 00000152                 IMPORT           PADdata0
 2182 00000152                 IMPORT           PADdata1
 2183 00000152         joy0_W                               ;4016  ÊÖ±ú1¼üÖµ [7
                                                            :0]ÓÒ7 ×ó6 ÏÂ5 ÉÏ4 
                                                            Start3 Select2 B1 A
                                                            0   )
 2184 00000152         ;-------------------------------------------------------
                       ---------------------
 2185 00000152 F010 0F01       tst              r0,#1       ;0£½Ð´£¬1£½¶Á
 2186 00000156 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2187 0000015A BF18 4770       bxne             lr          ;NE       ²»µÈ£¨Not
                                                            Equal£©  
 2188 0000015E         
 2189 0000015E 491A            ldr              r1,=PADdata0 ;   //ÊÖ±ú1¼üÖµ  
 2190 00000160 6809            ldr              r1,[r1]
 2191 00000162 F8CA 1098       str              r1,joy0data
 2192 00000166         
 2193 00000166 4919            ldr              r1,=PADdata1 ;   //ÊÖ±ú1¼üÖµ  
 2194 00000168 6809            ldr              r1,[r1]
 2195 0000016A F8CA 109C       str              r1,joy1data
 2196 0000016E         
 2197 0000016E 4770            bx               lr
 2198 00000170         ;-------------------------------------------------------
                       ---------------------
 2199 00000170         joy0_R                               ;4016
 2200 00000170         ;-------------------------------------------------------
                       --------------------- 
 2201 00000170 F8DA 0098       ldr              r0,joy0data ;´®ÐÐÊý¾Ý  µ±Ç°¶ÁÈ¡
                                                            Î»;joy0dataÊÇ¼üÖµ
 2202 00000174 EA4F 0150       mov              r1,r0,lsr#1 ;>>1
 2203 00000178 F8CA 1098       str              r1,joy0data
 2204 0000017C         



ARM Macro Assembler    Page 173 


 2205 0000017C F000 0001       and              r0,r0,#1    ;&1 
 2206 00000180 F040 0040       orr              r0,r0,#0x40 ;|0x40
 2207 00000184         
 2208 00000184 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2209 00000188 4770            bx               lr
 2210 0000018A         ;-------------------------------------------------------
                       ---------------------
 2211 0000018A         joy1_R                               ;4017
 2212 0000018A         ;-------------------------------------------------------
                       ---------------------
 2213 0000018A F8DA 009C       ldr              r0,joy1data ;´®ÐÐÊý¾Ý  µ±Ç°¶ÁÈ¡
                                                            Î»;joy0dataÊÇ¼üÖµ
 2214 0000018E EA4F 0150       mov              r1,r0,lsr#1 ;>>1
 2215 00000192 F8CA 109C       str              r1,joy1data
 2216 00000196         
 2217 00000196 F000 0001       and              r0,r0,#1    ;&1 
 2218 0000019A F040 0040       orr              r0,r0,#0x40
 2219 0000019E         
 2220 0000019E F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2221 000001A2 4770            bx               lr
 2222 000001A4         ;-------------------------------------------------------
                       -------
 2223 000001A4         K6502_Read
                               PROC                         ;apu  Rendering DPC
                                                            M channel #5  r0=AP
                                                            U->ApuC5Address²»È·
                                                            ¶¨ÕýÈ·*
 2224 000001A4         ;-------------------------------------------------------
                       --------
 2225 000001A4                 EXPORT           K6502_Read  ;switch ( wAddr & 0
                                                            xe000 ) apu.c
 2226 000001A4 B500            stmfd            sp!,{lr}
 2227 000001A6         
 2228 000001A6 EA4F 3150       mov              r1,r0,lsr#13 ;>>13=  & 0xe000
 2229 000001AA 4A09            ldr              r2,=CPU_RAM ;;//´æ´¢Æ÷Ó³Ïó ram+
                                                            rom 
 2230 000001AC F852 1021       ldr              r1,[r2,r1,lsl#2] ;lookup rom pt
                                                            r..²éÕÒptr
 2231 000001B0         
 2232 000001B0 F420 4060       bic              r0,r0,#0xe000 ;and r0,#0x1fff &
                                                            0x1fff 
 2233 000001B4 5C08            ldrb             r0,[r1,r0]
 2234 000001B6         
 2235 000001B6 F85D EB04       ldmfd            sp!,{lr}
 2236 000001BA 4770            bx               lr
 2237 000001BC                 ENDP
 2238 000001BC         ; nop
 2239 000001BC         ;-------------------------------------------------------
                       -----------------
 2240 000001BC 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         AREA             CPU_GPU, CODE, READONLY
 2241 00000000         
 2242 00000000                 IMPORT           PPU_WriteToPort ;PPU.c



ARM Macro Assembler    Page 174 


 2243 00000000                 IMPORT           PPU_ReadFromPort ;PPU.c
 2244 00000000         ;-------------------------------------------------------
                       -----------------------------
 2245 00000000         PPU_W
 2246 00000000 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 2247 00000002 4661            mov              r1,r12
 2248 00000004 F7FF FFFE       bl               PPU_WriteToPort
 2249 00000008 E8BD 4008       ldmfd            sp!,{r3,lr}
 2250 0000000C F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 2251 00000010 4770            bx               lr
 2252 00000012         ;-------------------------------------------------------
                       -------------------------------
 2253 00000012         PPU_R
 2254 00000012 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ»    »
                                                            á¸Ä±äR4 
 2255 00000014 4660            mov              r0,r12
 2256 00000016 F7FF FFFE       bl               PPU_ReadFromPort
 2257 0000001A E8BD 4008       ldmfd            sp!,{r3,lr}
 2258 0000001E F04E 0E01       orr              lr,#0x01
 2259 00000022 4770            bx               lr
 2260 00000024 BF00            nop
 2261 00000026         ;-------------------------------------------------------
                       ----------------------------------
 2262 00000026                 AREA             cpu_code, DATA, READONLY
 2263 00002900         ;-------------------------------------------------------
                       ----------------------------------  
 2264 00002900         op_table                             ;DCD ÓÃÓÚ·ÖÅäÒ»¶Î×Ö
                                                            ÄÚ´æµ¥Ôª op_tableÄÚ
                                                            ´æ¿éÆðÊ¼µØÖ·±êºÅ
 2265 00002900 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _00,_01,_xx,_03,_xx,_05,_06,_07
,_08,_09,_0A,_xx,_xx,_0D,_0E,_xx
 2266 00002940 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 175 


              00000000 
              00000000 
              00000000 
              00000000         DCD              _10,_11,_xx,_xx,_14,_15,_16,_xx
,_18,_19,_xx,_xx,_xx,_1D,_1E,_xx
 2267 00002980 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _20,_21,_xx,_xx,_24,_25,_26,_xx
,_28,_29,_2A,_xx,_2C,_2D,_2E,_xx
 2268 000029C0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _30,_31,_xx,_xx,_xx,_35,_36,_xx
,_38,_39,_xx,_xx,_xx,_3D,_3E,_xx
 2269 00002A00 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _40,_41,_xx,_xx,_xx,_45,_46,_xx
,_48,_49,_4A,_xx,_4C,_4D,_4E,_xx
 2270 00002A40 00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 176 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _50,_51,_xx,_xx,_xx,_55,_56,_xx
,_58,_59,_xx,_xx,_xx,_5D,_5E,_xx
 2271 00002A80 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _60,_61,_xx,_xx,_xx,_65,_66,_67
,_68,_69,_6A,_xx,_6C,_6D,_6E,_xx
 2272 00002AC0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _70,_71,_xx,_xx,_xx,_75,_76,_xx
,_78,_79,_xx,_xx,_xx,_7D,_7E,_xx
 2273 00002B00 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 177 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _xx,_81,_xx,_xx,_84,_85,_86,_xx
,_88,_xx,_8A,_xx,_8C,_8D,_8E,_xx
 2274 00002B40 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _90,_91,_xx,_xx,_94,_95,_96,_xx
,_98,_99,_9A,_xx,_xx,_9D,_xx,_xx
 2275 00002B80 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _A0,_A1,_A2,_xx,_A4,_A5,_A6,_xx
,_A8,_A9,_AA,_xx,_AC,_AD,_AE,_xx
 2276 00002BC0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _B0,_B1,_xx,_xx,_B4,_B5,_B6,_xx
,_B8,_B9,_BA,_xx,_BC,_BD,_BE,_xx
 2277 00002C00 00000000 
              00000000 



ARM Macro Assembler    Page 178 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _C0,_C1,_xx,_xx,_C4,_C5,_C6,_xx
,_C8,_C9,_CA,_xx,_CC,_CD,_CE,_xx
 2278 00002C40 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _D0,_D1,_xx,_xx,_xx,_D5,_D6,_xx
,_D8,_D9,_xx,_xx,_xx,_DD,_DE,_xx
 2279 00002C80 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _E0,_E1,_xx,_xx,_E4,_E5,_E6,_xx
,_E8,_E9,_EA,_xx,_EC,_ED,_EE,_xx
 2280 00002CC0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 179 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _F0,_F1,_xx,_xx,_xx,_F5,_F6,_xx
,_F8,_F9,_xx,_FB,_xx,_FD,_FE,_FF
 2281 00002D00         
 2282 00002D00         ;-------------------------------------------------------
                       --------------------------    
 2283 00002D00                 AREA             wram_globals0, DATA, READWRITE
 2284 00000000         ;-------------------------------------------------------
                       --------------------------  
 2285 00000000         cpu_data                             ;43*4
 2286 00000000 00000000        DCD              op_table    ;opz #   4      //´
                                                            úÂë±íµØÖ· 
 2287 00000004         ;readmem_tbl             
 2288 00000004 00000000        DCD              ram_R       ;$0000    
 2289 00000008 00000000        DCD              PPU_R       ;$2000
 2290 0000000C 00000000        DCD              IO_R        ;$4000
 2291 00000010 00000000        DCD              sram_R      ;$6000
 2292 00000014 00000000        DCD              rom_R80     ;$8000
 2293 00000018 00000000        DCD              rom_RA0     ;$A000
 2294 0000001C 00000000        DCD              rom_RC0     ;$C000
 2295 00000020 00000000        DCD              rom_RE0     ;$E000
 2296 00000024         ;writemem_tbl
 2297 00000024 00000000        DCD              ram_W       ;$0000     
 2298 00000028 00000000        DCD              PPU_W       ;$2000   r0´«²ÎÊý
 2299 0000002C 00000000        DCD              IO_W        ;$4000
 2300 00000030 00000000        DCD              sram_W      ;$6000
 2301 00000034 00000000        DCD              void        ;$8000
 2302 00000038 00000000        DCD              void        ;$A000
 2303 0000003C 00000000        DCD              void        ;$C000
 2304 00000040 00000000        DCD              void        ;$E000
 2305 00000044         CPU_RAM                              ;memmap_tbl  ´æ´¢Æ÷
                                                            Ó³Ïó
 2306 00000044 00000000        DCD              NES_RAM     ;$0000   0000-7fff 
                                                             keep $400 byte ali
                                                            gned for 6502 stack
                                                             shit
 2307 00000048 00000000        DCD              NES_RAM     ;$2000    shouldÓ¦¸
                                                            Ã   ±£³Ö1024×Ö½Ú¶ÔÆ
                                                            ë
 2308 0000004C 00000000        DCD              NES_RAM     ;$4000     never´ÓÀ
                                                            ´Ã»ÓÐ
 2309 00000050 00000000        DCD              NES_SRAM    ;   NES_RAM-0x5800 
                                                            ;$6000      change¸
                                                            Ä±ä
 2310 00000054 00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00       rommap  %                4*4         ;$8000-FFFF  memmap
                                                            _tbl+16
 2311 00000064         
 2312 00000064         cpustate
 2313 00000064         ;group these together for save/loadstate
 2314 00000064 00 00 00 



ARM Macro Assembler    Page 180 


              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00               %                7*4         ;cpuregs (nz,c,a,x,
                                                            y,cycles,pc)
 2315 00000080 00000000        DCD              0           ;m6502_s:
 2316 00000084 00000000        DCD              0           ;lastbank: ×îºóMEMM
                                                            APÌí¼Óµ½PC £¨ÓÃÓÚ¼Æ
                                                            Ëãµ±Ç°µÄPC £©
 2317 00000088 00000000        DCD              exit_run    ;nexttimeout:  jump
                                                             here when cycles r
                                                            uns out Ìøµ½ÏÂÒ»¸öÊ
                                                            ±ÖÓÖÜÆÚÔËÐÐ
 2318 0000008C         
 2319 0000008C 00000000        DCD              0           ;rombase # 4   ;//R
                                                            OM¿ªÊ¼µØÖ·
 2320 00000090 00000000        DCD              0           ;romnumber # 4   ;/
                                                            / 
 2321 00000094 00000000        DCD              0           ;rommask # 4     ;/
                                                            /ROMÑÚÄ¤ rommask=ro
                                                            msize-1
 2322 00000098         
 2323 00000098 00000000        DCD              0           ;joy0data # 4    ;/
                                                            /ÊÖ±ú1´®ÐÐÊý¾Ý
 2324 0000009C 00000000        DCD              0           ;joy1data # 4    ;/
                                                            /ÊÖ±ú2´®ÐÐÊý¾Ý 
 2325 000000A0         clocks
 2326 000000A0 00000000        DCD              0           ;clocksh # 4    ;//
                                                            Ö´ÐÐµÄÊ±ÖÓÊý apuÓÃ
 2327 000000A4         cpunmi
 2328 000000A4 00000000        DCD              0           ;cpunmif # 4      ;
                                                            cpuÖÐ¶Ï±êÖ¾
 2329 000000A8         cpuirq
 2330 000000A8 00000000        DCD              0           ;cpuirqf # 4      ;
                                                            cpuÖÐ¶Ï±êÖ¾   
 2331 000000AC         ; DCW 0 DCW¶¨Òå16Î»±äÁ¿
 2332 000000AC         ;-------------------------------------------------------
                       ---------------------
 2333 000000AC         ; ALIGN           ;Í¨¹ýÓÃÁã»ò¿ÕÖ¸ÁîNOPÌî³ä£¬À´Ê¹µ±Ç°Î»ÖÃ
                       ÓëÒ»¸öÖ¸¶¨µÄ±ß½ç¶ÔÆë
 2334 000000AC                 END
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp --apcs=int
erwork --depend=..\obj\6502.d -o..\obj\6502.o -I"C:\Users\hua\Desktop\¿ªÊ¼\ÊµÑé
62 ×ÛºÏ²âÊÔÊµÑé\USER\RTE" -IF:\MDK5\ARM\PACK\Keil\STM32F4xx_DFP\2.9.0\Drivers\C
MSIS\Device\ST\STM32F4xx\Include -IF:\MDK5\ARM\CMSIS\Include -IF:\MDK5\ARM\PACK
\Keil\STM32F4xx_DFP\2.9.0\Device\Include --predefine="__UVISION_VERSION SETA 52
1" --predefine="STM32F429xx SETA 1" --list=..\obj\6502.lst ..\NES\6502.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

 0000009A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000001EE

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000234

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000252

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000002CA

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000003B8

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000402

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000044C

Symbol: 



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000046A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000051E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000006C2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000716

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000075C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000780

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000007F8

Symbol: 
   Definitions
      None
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

      None
Warning:  undefinedComment:  unused
 000008EC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000936

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000980

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000009A4

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000A74

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000BEE

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000C34

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000C50



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Relocatable symbols


Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000CC8

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000DB2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000DFC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000E46

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000E62

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000F0E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000010FC

Symbol: 
   Definitions



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Relocatable symbols

      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001156

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000117E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000011F6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001316

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001374

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000013D2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000013FA

Symbol: 
   Definitions
      None
   Uses
      None



ARM Macro Assembler    Page 6 Alphabetic symbol ordering
Relocatable symbols

Warning:  undefinedComment:  unused
 00001454

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001576

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000015BC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001602

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001682

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001796

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000180A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001886




ARM Macro Assembler    Page 7 Alphabetic symbol ordering
Relocatable symbols

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000019FA

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001A40

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001A86

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001B06

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001C18

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001C90

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001CDA

Symbol: 
   Definitions
      None



ARM Macro Assembler    Page 8 Alphabetic symbol ordering
Relocatable symbols

   Uses
      None
Warning:  undefinedComment:  unused
 00001D24

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001DB0

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001F22

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001F6C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001FB6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001FD2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000204A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused



ARM Macro Assembler    Page 9 Alphabetic symbol ordering
Relocatable symbols

 0000213E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000218C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000021DA

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000021F6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000227A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000240E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002458

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000024B0

Symbol: 



ARM Macro Assembler    Page 10 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000024CC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002544

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002654

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000026B0

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000270C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002728

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000276A

Symbol: 
   Definitions
      None
   Uses



ARM Macro Assembler    Page 11 Alphabetic symbol ordering
Relocatable symbols

      None
Warning:  undefinedComment:  unused
 000027C6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
_00 00000000

Symbol: _00
   Definitions
      At line 610 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _00 used once
_01 0000006A

Symbol: _01
   Definitions
      At line 626 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _01 used once
_03 0000286E

Symbol: _03
   Definitions
      At line 1597 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _03 used once
_05 000000C4

Symbol: _05
   Definitions
      At line 632 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _05 used once
_06 000000F6

Symbol: _06
   Definitions
      At line 638 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _06 used once
_07 000028B0

Symbol: _07
   Definitions
      At line 1604 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _07 used once
_08 0000012E



ARM Macro Assembler    Page 12 Alphabetic symbol ordering
Relocatable symbols


Symbol: _08
   Definitions
      At line 644 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _08 used once
_09 00000178

Symbol: _09
   Definitions
      At line 650 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _09 used once
_0A 000001A6

Symbol: _0A
   Definitions
      At line 656 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _0A used once
_0D 000001D2

Symbol: _0D
   Definitions
      At line 663 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _0D used once
_0E 00000218

Symbol: _0E
   Definitions
      At line 669 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
Comment: _0E used once
_10 00000274

Symbol: _10
   Definitions
      At line 675 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _10 used once
_11 000002A6

Symbol: _11
   Definitions
      At line 684 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _11 used once
_14 00002802

Symbol: _14
   Definitions



ARM Macro Assembler    Page 13 Alphabetic symbol ordering
Relocatable symbols

      At line 1585 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _14 used once
_15 000002F4

Symbol: _15
   Definitions
      At line 690 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _15 used once
_16 0000032E

Symbol: _16
   Definitions
      At line 696 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _16 used once
_18 00000372

Symbol: _18
   Definitions
      At line 702 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _18 used once
_19 00000398

Symbol: _19
   Definitions
      At line 707 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _19 used once
_1D 000003E2

Symbol: _1D
   Definitions
      At line 713 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _1D used once
_1E 0000042C

Symbol: _1E
   Definitions
      At line 719 in file ..\NES\6502.s
   Uses
      At line 2266 in file ..\NES\6502.s
Comment: _1E used once
_20 0000048C

Symbol: _20
   Definitions
      At line 725 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s



ARM Macro Assembler    Page 14 Alphabetic symbol ordering
Relocatable symbols

Comment: _20 used once
_21 000004EE

Symbol: _21
   Definitions
      At line 736 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _21 used once
_24 00000548

Symbol: _24
   Definitions
      At line 742 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _24 used once
_25 00000588

Symbol: _25
   Definitions
      At line 748 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _25 used once
_26 000005BA

Symbol: _26
   Definitions
      At line 754 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _26 used once
_28 000005F8

Symbol: _28
   Definitions
      At line 760 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _28 used once
_29 00000642

Symbol: _29
   Definitions
      At line 766 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _29 used once
_2A 00000670

Symbol: _2A
   Definitions
      At line 772 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _2A used once
_2C 000006A6




ARM Macro Assembler    Page 15 Alphabetic symbol ordering
Relocatable symbols

Symbol: _2C
   Definitions
      At line 781 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _2C used once
_2D 000006FA

Symbol: _2D
   Definitions
      At line 787 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _2D used once
_2E 00000740

Symbol: _2E
   Definitions
      At line 793 in file ..\NES\6502.s
   Uses
      At line 2267 in file ..\NES\6502.s
Comment: _2E used once
_30 000007A2

Symbol: _30
   Definitions
      At line 799 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _30 used once
_31 000007D4

Symbol: _31
   Definitions
      At line 808 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _31 used once
_35 00000822

Symbol: _35
   Definitions
      At line 814 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _35 used once
_36 0000085C

Symbol: _36
   Definitions
      At line 820 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _36 used once
_38 000008A6

Symbol: _38
   Definitions
      At line 826 in file ..\NES\6502.s



ARM Macro Assembler    Page 16 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _38 used once
_39 000008CC

Symbol: _39
   Definitions
      At line 831 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _39 used once
_3D 00000916

Symbol: _3D
   Definitions
      At line 837 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _3D used once
_3E 00000960

Symbol: _3E
   Definitions
      At line 843 in file ..\NES\6502.s
   Uses
      At line 2268 in file ..\NES\6502.s
Comment: _3E used once
_40 000009C6

Symbol: _40
   Definitions
      At line 849 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _40 used once
_41 00000A44

Symbol: _41
   Definitions
      At line 857 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _41 used once
_45 00000A9E

Symbol: _45
   Definitions
      At line 863 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _45 used once
_46 00000AD0

Symbol: _46
   Definitions
      At line 869 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _46 used once



ARM Macro Assembler    Page 17 Alphabetic symbol ordering
Relocatable symbols

_48 00000B04

Symbol: _48
   Definitions
      At line 875 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _48 used once
_49 00000B36

Symbol: _49
   Definitions
      At line 881 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _49 used once
_4A 00000B64

Symbol: _4A
   Definitions
      At line 887 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _4A used once
_4C 00000B90

Symbol: _4C
   Definitions
      At line 894 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _4C used once
_4D 00000BD2

Symbol: _4D
   Definitions
      At line 902 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _4D used once
_4E 00000C18

Symbol: _4E
   Definitions
      At line 908 in file ..\NES\6502.s
   Uses
      At line 2269 in file ..\NES\6502.s
Comment: _4E used once
_50 00000C72

Symbol: _50
   Definitions
      At line 914 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _50 used once
_51 00000CA4

Symbol: _51



ARM Macro Assembler    Page 18 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 923 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _51 used once
_55 00000CF2

Symbol: _55
   Definitions
      At line 929 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _55 used once
_56 00000D2C

Symbol: _56
   Definitions
      At line 935 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _56 used once
_58 00000D6C

Symbol: _58
   Definitions
      At line 941 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _58 used once
_59 00000D92

Symbol: _59
   Definitions
      At line 946 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _59 used once
_5D 00000DDC

Symbol: _5D
   Definitions
      At line 952 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _5D used once
_5E 00000E26

Symbol: _5E
   Definitions
      At line 958 in file ..\NES\6502.s
   Uses
      At line 2270 in file ..\NES\6502.s
Comment: _5E used once
_60 00000E84

Symbol: _60
   Definitions
      At line 964 in file ..\NES\6502.s
   Uses



ARM Macro Assembler    Page 19 Alphabetic symbol ordering
Relocatable symbols

      At line 2271 in file ..\NES\6502.s
Comment: _60 used once
_61 00000EDE

Symbol: _61
   Definitions
      At line 971 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _61 used once
_65 00000F4C

Symbol: _65
   Definitions
      At line 977 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _65 used once
_66 00000F92

Symbol: _66
   Definitions
      At line 983 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _66 used once
_67 00002828

Symbol: _67
   Definitions
      At line 1590 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _67 used once
_68 00000FD4

Symbol: _68
   Definitions
      At line 989 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _68 used once
_69 0000100E

Symbol: _69
   Definitions
      At line 995 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _69 used once
_6A 00001050

Symbol: _6A
   Definitions
      At line 1001 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _6A used once
_6C 00001084



ARM Macro Assembler    Page 20 Alphabetic symbol ordering
Relocatable symbols


Symbol: _6C
   Definitions
      At line 1010 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _6C used once
_6D 000010E0

Symbol: _6D
   Definitions
      At line 1027 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _6D used once
_6E 0000113A

Symbol: _6E
   Definitions
      At line 1033 in file ..\NES\6502.s
   Uses
      At line 2271 in file ..\NES\6502.s
Comment: _6E used once
_70 000011A0

Symbol: _70
   Definitions
      At line 1039 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _70 used once
_71 000011D2

Symbol: _71
   Definitions
      At line 1048 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _71 used once
_75 00001234

Symbol: _75
   Definitions
      At line 1054 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _75 used once
_76 00001282

Symbol: _76
   Definitions
      At line 1060 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _76 used once
_78 000012D0

Symbol: _78
   Definitions



ARM Macro Assembler    Page 21 Alphabetic symbol ordering
Relocatable symbols

      At line 1066 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _78 used once
_79 000012F6

Symbol: _79
   Definitions
      At line 1071 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _79 used once
_7D 00001354

Symbol: _7D
   Definitions
      At line 1077 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _7D used once
_7E 000013B2

Symbol: _7E
   Definitions
      At line 1083 in file ..\NES\6502.s
   Uses
      At line 2272 in file ..\NES\6502.s
Comment: _7E used once
_81 0000141C

Symbol: _81
   Definitions
      At line 1089 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _81 used once
_84 00001476

Symbol: _84
   Definitions
      At line 1095 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _84 used once
_85 000014A4

Symbol: _85
   Definitions
      At line 1101 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _85 used once
_86 000014D2

Symbol: _86
   Definitions
      At line 1107 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s



ARM Macro Assembler    Page 22 Alphabetic symbol ordering
Relocatable symbols

Comment: _86 used once
_88 00001500

Symbol: _88
   Definitions
      At line 1113 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _88 used once
_8A 0000152A

Symbol: _8A
   Definitions
      At line 1119 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _8A used once
_8C 00001552

Symbol: _8C
   Definitions
      At line 1125 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _8C used once
_8D 00001598

Symbol: _8D
   Definitions
      At line 1131 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _8D used once
_8E 000015DE

Symbol: _8E
   Definitions
      At line 1137 in file ..\NES\6502.s
   Uses
      At line 2273 in file ..\NES\6502.s
Comment: _8E used once
_90 00001624

Symbol: _90
   Definitions
      At line 1143 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _90 used once
_91 00001656

Symbol: _91
   Definitions
      At line 1152 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _91 used once
_94 000016A4




ARM Macro Assembler    Page 23 Alphabetic symbol ordering
Relocatable symbols

Symbol: _94
   Definitions
      At line 1158 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _94 used once
_95 000016DA

Symbol: _95
   Definitions
      At line 1164 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _95 used once
_96 00001710

Symbol: _96
   Definitions
      At line 1170 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _96 used once
_98 00001746

Symbol: _98
   Definitions
      At line 1176 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _98 used once
_99 0000176E

Symbol: _99
   Definitions
      At line 1182 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _99 used once
_9A 000017B8

Symbol: _9A
   Definitions
      At line 1188 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _9A used once
_9D 000017E2

Symbol: _9D
   Definitions
      At line 1194 in file ..\NES\6502.s
   Uses
      At line 2274 in file ..\NES\6502.s
Comment: _9D used once
_A0 0000182C

Symbol: _A0
   Definitions
      At line 1200 in file ..\NES\6502.s



ARM Macro Assembler    Page 24 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A0 used once
_A1 00001856

Symbol: _A1
   Definitions
      At line 1206 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A1 used once
_A2 000018B0

Symbol: _A2
   Definitions
      At line 1212 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A2 used once
_A4 000018DA

Symbol: _A4
   Definitions
      At line 1218 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A4 used once
_A5 00001908

Symbol: _A5
   Definitions
      At line 1224 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A5 used once
_A6 00001936

Symbol: _A6
   Definitions
      At line 1230 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A6 used once
_A8 00001964

Symbol: _A8
   Definitions
      At line 1236 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A8 used once
_A9 0000198C

Symbol: _A9
   Definitions
      At line 1242 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _A9 used once



ARM Macro Assembler    Page 25 Alphabetic symbol ordering
Relocatable symbols

_AA 000019B6

Symbol: _AA
   Definitions
      At line 1248 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _AA used once
_AC 000019DE

Symbol: _AC
   Definitions
      At line 1254 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _AC used once
_AD 00001A24

Symbol: _AD
   Definitions
      At line 1260 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _AD used once
_AE 00001A6A

Symbol: _AE
   Definitions
      At line 1266 in file ..\NES\6502.s
   Uses
      At line 2275 in file ..\NES\6502.s
Comment: _AE used once
_B0 00001AB0

Symbol: _B0
   Definitions
      At line 1272 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B0 used once
_B1 00001AE2

Symbol: _B1
   Definitions
      At line 1281 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B1 used once
_B4 00001B30

Symbol: _B4
   Definitions
      At line 1287 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B4 used once
_B5 00001B66

Symbol: _B5



ARM Macro Assembler    Page 26 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 1293 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B5 used once
_B6 00001B9C

Symbol: _B6
   Definitions
      At line 1299 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B6 used once
_B8 00001BD2

Symbol: _B8
   Definitions
      At line 1305 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B8 used once
_B9 00001BF8

Symbol: _B9
   Definitions
      At line 1310 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _B9 used once
_BA 00001C42

Symbol: _BA
   Definitions
      At line 1316 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _BA used once
_BC 00001C70

Symbol: _BC
   Definitions
      At line 1323 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _BC used once
_BD 00001CBA

Symbol: _BD
   Definitions
      At line 1329 in file ..\NES\6502.s
   Uses
      At line 2276 in file ..\NES\6502.s
Comment: _BD used once
_BE 00001D04

Symbol: _BE
   Definitions
      At line 1335 in file ..\NES\6502.s
   Uses



ARM Macro Assembler    Page 27 Alphabetic symbol ordering
Relocatable symbols

      At line 2276 in file ..\NES\6502.s
Comment: _BE used once
_C0 00001D4E

Symbol: _C0
   Definitions
      At line 1341 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C0 used once
_C1 00001D80

Symbol: _C1
   Definitions
      At line 1347 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C1 used once
_C4 00001DDE

Symbol: _C4
   Definitions
      At line 1353 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C4 used once
_C5 00001E14

Symbol: _C5
   Definitions
      At line 1359 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C5 used once
_C6 00001E4A

Symbol: _C6
   Definitions
      At line 1365 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C6 used once
_C8 00001E80

Symbol: _C8
   Definitions
      At line 1371 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C8 used once
_C9 00001EAA

Symbol: _C9
   Definitions
      At line 1377 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _C9 used once
_CA 00001EDC



ARM Macro Assembler    Page 28 Alphabetic symbol ordering
Relocatable symbols


Symbol: _CA
   Definitions
      At line 1383 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _CA used once
_CC 00001F06

Symbol: _CC
   Definitions
      At line 1389 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _CC used once
_CD 00001F50

Symbol: _CD
   Definitions
      At line 1395 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _CD used once
_CE 00001F9A

Symbol: _CE
   Definitions
      At line 1401 in file ..\NES\6502.s
   Uses
      At line 2277 in file ..\NES\6502.s
Comment: _CE used once
_D0 00001FF4

Symbol: _D0
   Definitions
      At line 1407 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _D0 used once
_D1 00002026

Symbol: _D1
   Definitions
      At line 1416 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _D1 used once
_D5 00002078

Symbol: _D5
   Definitions
      At line 1422 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _D5 used once
_D6 000020B6

Symbol: _D6
   Definitions



ARM Macro Assembler    Page 29 Alphabetic symbol ordering
Relocatable symbols

      At line 1428 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _D6 used once
_D8 000020F8

Symbol: _D8
   Definitions
      At line 1434 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _D8 used once
_D9 0000211E

Symbol: _D9
   Definitions
      At line 1439 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _D9 used once
_DD 0000216C

Symbol: _DD
   Definitions
      At line 1445 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _DD used once
_DE 000021BA

Symbol: _DE
   Definitions
      At line 1451 in file ..\NES\6502.s
   Uses
      At line 2278 in file ..\NES\6502.s
Comment: _DE used once
_E0 00002218

Symbol: _E0
   Definitions
      At line 1457 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _E0 used once
_E1 0000224A

Symbol: _E1
   Definitions
      At line 1463 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _E1 used once
_E4 000022B6

Symbol: _E4
   Definitions
      At line 1469 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s



ARM Macro Assembler    Page 30 Alphabetic symbol ordering
Relocatable symbols

Comment: _E4 used once
_E5 000022EC

Symbol: _E5
   Definitions
      At line 1475 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _E5 used once
_E6 00002330

Symbol: _E6
   Definitions
      At line 1481 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _E6 used once
_E8 00002366

Symbol: _E8
   Definitions
      At line 1487 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _E8 used once
_E9 00002390

Symbol: _E9
   Definitions
      At line 1493 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _E9 used once
_EA 000023D0

Symbol: _EA
   Definitions
      At line 1499 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _EA used once
_EC 000023F2

Symbol: _EC
   Definitions
      At line 1503 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _EC used once
_ED 0000243C

Symbol: _ED
   Definitions
      At line 1509 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _ED used once
_EE 00002494




ARM Macro Assembler    Page 31 Alphabetic symbol ordering
Relocatable symbols

Symbol: _EE
   Definitions
      At line 1515 in file ..\NES\6502.s
   Uses
      At line 2279 in file ..\NES\6502.s
Comment: _EE used once
_F0 000024EE

Symbol: _F0
   Definitions
      At line 1521 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _F0 used once
_F1 00002520

Symbol: _F1
   Definitions
      At line 1530 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _F1 used once
_F5 00002580

Symbol: _F5
   Definitions
      At line 1536 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _F5 used once
_F6 000025CC

Symbol: _F6
   Definitions
      At line 1542 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _F6 used once
_F8 0000260E

Symbol: _F8
   Definitions
      At line 1548 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _F8 used once
_F9 00002634

Symbol: _F9
   Definitions
      At line 1553 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _F9 used once
_FB 000027A6

Symbol: _FB
   Definitions
      At line 1578 in file ..\NES\6502.s



ARM Macro Assembler    Page 32 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _FB used once
_FD 00002690

Symbol: _FD
   Definitions
      At line 1559 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _FD used once
_FE 000026EC

Symbol: _FE
   Definitions
      At line 1565 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _FE used once
_FF 0000274A

Symbol: _FF
   Definitions
      At line 1571 in file ..\NES\6502.s
   Uses
      At line 2280 in file ..\NES\6502.s
Comment: _FF used once
_xx 000028D6

Symbol: _xx
   Definitions
      At line 1613 in file ..\NES\6502.s
   Uses
      At line 2265 in file ..\NES\6502.s
      At line 2265 in file ..\NES\6502.s
      At line 2265 in file ..\NES\6502.s
      At line 2265 in file ..\NES\6502.s
      At line 2265 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2266 in file ..\NES\6502.s
      At line 2267 in file ..\NES\6502.s
      At line 2267 in file ..\NES\6502.s
      At line 2267 in file ..\NES\6502.s
      At line 2267 in file ..\NES\6502.s
      At line 2267 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2268 in file ..\NES\6502.s
      At line 2269 in file ..\NES\6502.s



ARM Macro Assembler    Page 33 Alphabetic symbol ordering
Relocatable symbols

      At line 2269 in file ..\NES\6502.s
      At line 2269 in file ..\NES\6502.s
      At line 2269 in file ..\NES\6502.s
      At line 2269 in file ..\NES\6502.s
      At line 2269 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2270 in file ..\NES\6502.s
      At line 2271 in file ..\NES\6502.s
      At line 2271 in file ..\NES\6502.s
      At line 2271 in file ..\NES\6502.s
      At line 2271 in file ..\NES\6502.s
      At line 2271 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2272 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2273 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2274 in file ..\NES\6502.s
      At line 2275 in file ..\NES\6502.s
      At line 2275 in file ..\NES\6502.s
      At line 2275 in file ..\NES\6502.s
      At line 2275 in file ..\NES\6502.s
      At line 2276 in file ..\NES\6502.s
      At line 2276 in file ..\NES\6502.s
      At line 2276 in file ..\NES\6502.s
      At line 2276 in file ..\NES\6502.s
      At line 2276 in file ..\NES\6502.s
      At line 2277 in file ..\NES\6502.s
      At line 2277 in file ..\NES\6502.s
      At line 2277 in file ..\NES\6502.s
      At line 2277 in file ..\NES\6502.s
      At line 2277 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s



ARM Macro Assembler    Page 34 Alphabetic symbol ordering
Relocatable symbols

      At line 2278 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s
      At line 2278 in file ..\NES\6502.s
      At line 2279 in file ..\NES\6502.s
      At line 2279 in file ..\NES\6502.s
      At line 2279 in file ..\NES\6502.s
      At line 2279 in file ..\NES\6502.s
      At line 2279 in file ..\NES\6502.s
      At line 2280 in file ..\NES\6502.s
      At line 2280 in file ..\NES\6502.s
      At line 2280 in file ..\NES\6502.s
      At line 2280 in file ..\NES\6502.s
      At line 2280 in file ..\NES\6502.s
      At line 2280 in file ..\NES\6502.s

cpu_code 00000000

Symbol: cpu_code
   Definitions
      At line 573 in file ..\NES\6502.s
   Uses
      None
Comment: cpu_code unused
op_table 00002900

Symbol: op_table
   Definitions
      At line 2264 in file ..\NES\6502.s
   Uses
      At line 2286 in file ..\NES\6502.s
Comment: op_table used once
235 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

Mapper_W 0000019C

Symbol: Mapper_W
   Definitions
      At line 1794 in file ..\NES\6502.s
   Uses
      At line 1674 in file ..\NES\6502.s
Comment: Mapper_W used once
cpu6502_init 00000000

Symbol: cpu6502_init
   Definitions
      At line 1627 in file ..\NES\6502.s
   Uses
      At line 551 in file ..\NES\6502.s
Comment: cpu6502_init used once
flush 0000012E

Symbol: flush
   Definitions
      At line 1750 in file ..\NES\6502.s
   Uses
      At line 1699 in file ..\NES\6502.s
      At line 1709 in file ..\NES\6502.s
      At line 1719 in file ..\NES\6502.s
      At line 1729 in file ..\NES\6502.s
      At line 1739 in file ..\NES\6502.s
      At line 1773 in file ..\NES\6502.s
      At line 1790 in file ..\NES\6502.s

map67_ 0000009C

Symbol: map67_
   Definitions
      At line 1692 in file ..\NES\6502.s
   Uses
      At line 552 in file ..\NES\6502.s
Comment: map67_ used once
map67_0 00000090

Symbol: map67_0
   Definitions
      At line 1687 in file ..\NES\6502.s
   Uses
      At line 553 in file ..\NES\6502.s
Comment: map67_0 used once
map89ABCDEF_ 0000016C

Symbol: map89ABCDEF_
   Definitions
      At line 1775 in file ..\NES\6502.s
   Uses
      At line 558 in file ..\NES\6502.s
Comment: map89ABCDEF_ used once
map89AB_ 00000114

Symbol: map89AB_
   Definitions
      At line 1741 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 1659 in file ..\NES\6502.s
Comment: map89AB_ used once
map89_ 000000B4

Symbol: map89_
   Definitions
      At line 1701 in file ..\NES\6502.s
   Uses
      At line 554 in file ..\NES\6502.s
Comment: map89_ used once
mapAB_ 000000CC

Symbol: mapAB_
   Definitions
      At line 1711 in file ..\NES\6502.s
   Uses
      At line 555 in file ..\NES\6502.s
Comment: mapAB_ used once
mapCDEF_ 00000150

Symbol: mapCDEF_
   Definitions
      At line 1764 in file ..\NES\6502.s
   Uses
      At line 1661 in file ..\NES\6502.s
Comment: mapCDEF_ used once
mapCD_ 000000E4

Symbol: mapCD_
   Definitions
      At line 1721 in file ..\NES\6502.s
   Uses
      At line 556 in file ..\NES\6502.s
Comment: mapCD_ used once
mapEF_ 000000FC

Symbol: mapEF_
   Definitions
      At line 1731 in file ..\NES\6502.s
   Uses
      At line 557 in file ..\NES\6502.s
Comment: mapEF_ used once
rom_code 00000000

Symbol: rom_code
   Definitions
      At line 1622 in file ..\NES\6502.s
   Uses
      None
Comment: rom_code unused
13 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CPU_reset 0000013A

Symbol: CPU_reset
   Definitions
      At line 1893 in file ..\NES\6502.s
   Uses
      At line 548 in file ..\NES\6502.s
      At line 1681 in file ..\NES\6502.s

CheckI 00000090

Symbol: CheckI
   Definitions
      At line 1855 in file ..\NES\6502.s
   Uses
      At line 1823 in file ..\NES\6502.s
Comment: CheckI used once
NMI6502 00000058

Symbol: NMI6502
   Definitions
      At line 1839 in file ..\NES\6502.s
   Uses
      At line 547 in file ..\NES\6502.s
      At line 1830 in file ..\NES\6502.s

Vec6502 000000C8

Symbol: Vec6502
   Definitions
      At line 1869 in file ..\NES\6502.s
   Uses
      At line 1844 in file ..\NES\6502.s
      At line 1866 in file ..\NES\6502.s
      At line 1917 in file ..\NES\6502.s

VecCont 00000104

Symbol: VecCont
   Definitions
      At line 1876 in file ..\NES\6502.s
   Uses
      At line 621 in file ..\NES\6502.s
Comment: VecCont used once
cpu_run 00000000

Symbol: cpu_run
   Definitions
      At line 1807 in file ..\NES\6502.s
   Uses
      None
Comment: cpu_run unused
default_scanlinehook 0000006E

Symbol: default_scanlinehook
   Definitions
      At line 1851 in file ..\NES\6502.s
   Uses
      At line 1858 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Comment: default_scanlinehook used once
exit_nmi 0000004C

Symbol: exit_nmi
   Definitions
      At line 1832 in file ..\NES\6502.s
   Uses
      At line 1847 in file ..\NES\6502.s
Comment: exit_nmi used once
exit_run 00000044

Symbol: exit_run
   Definitions
      At line 1826 in file ..\NES\6502.s
   Uses
      At line 1922 in file ..\NES\6502.s
      At line 2317 in file ..\NES\6502.s

irq6502 00000096

Symbol: irq6502
   Definitions
      At line 1860 in file ..\NES\6502.s
   Uses
      None
Comment: irq6502 unused
run6502 00000000

Symbol: run6502
   Definitions
      At line 1808 in file ..\NES\6502.s
   Uses
      At line 549 in file ..\NES\6502.s
Comment: run6502 used once
11 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

empty_R 00000000

Symbol: empty_R
   Definitions
      At line 1934 in file ..\NES\6502.s
   Uses
      At line 2032 in file ..\NES\6502.s
      At line 2038 in file ..\NES\6502.s
      At line 2058 in file ..\NES\6502.s

ram_R 0000001E

Symbol: ram_R
   Definitions
      At line 1950 in file ..\NES\6502.s
   Uses
      At line 2288 in file ..\NES\6502.s
Comment: ram_R used once
ram_W 0000002C

Symbol: ram_W
   Definitions
      At line 1957 in file ..\NES\6502.s
   Uses
      At line 2297 in file ..\NES\6502.s
Comment: ram_W used once
rom_R60 0000005C

Symbol: rom_R60
   Definitions
      At line 1982 in file ..\NES\6502.s
   Uses
      None
Comment: rom_R60 unused
rom_R80 0000006A

Symbol: rom_R80
   Definitions
      At line 1989 in file ..\NES\6502.s
   Uses
      At line 2292 in file ..\NES\6502.s
Comment: rom_R80 used once
rom_RA0 00000078

Symbol: rom_RA0
   Definitions
      At line 1996 in file ..\NES\6502.s
   Uses
      At line 2293 in file ..\NES\6502.s
Comment: rom_RA0 used once
rom_RC0 00000086

Symbol: rom_RC0
   Definitions
      At line 2003 in file ..\NES\6502.s
   Uses
      At line 2294 in file ..\NES\6502.s
Comment: rom_RC0 used once
rom_RE0 00000094



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols


Symbol: rom_RE0
   Definitions
      At line 2010 in file ..\NES\6502.s
   Uses
      At line 2295 in file ..\NES\6502.s
Comment: rom_RE0 used once
rwram_code 00000000

Symbol: rwram_code
   Definitions
      At line 1930 in file ..\NES\6502.s
   Uses
      None
Comment: rwram_code unused
sram_R 0000003A

Symbol: sram_R
   Definitions
      At line 1964 in file ..\NES\6502.s
   Uses
      At line 2291 in file ..\NES\6502.s
Comment: sram_R used once
sram_W 0000004A

Symbol: sram_W
   Definitions
      At line 1973 in file ..\NES\6502.s
   Uses
      At line 2300 in file ..\NES\6502.s
Comment: sram_W used once
void 00000014

Symbol: void
   Definitions
      At line 1944 in file ..\NES\6502.s
   Uses
      At line 2301 in file ..\NES\6502.s
      At line 2302 in file ..\NES\6502.s
      At line 2303 in file ..\NES\6502.s
      At line 2304 in file ..\NES\6502.s

12 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

IO_R 00000000

Symbol: IO_R
   Definitions
      At line 2024 in file ..\NES\6502.s
   Uses
      At line 2290 in file ..\NES\6502.s
Comment: IO_R used once
IO_W 00000030

Symbol: IO_W
   Definitions
      At line 2046 in file ..\NES\6502.s
   Uses
      At line 2299 in file ..\NES\6502.s
Comment: IO_W used once
K6502_Read 000001A4

Symbol: K6502_Read
   Definitions
      At line 2223 in file ..\NES\6502.s
   Uses
      At line 2225 in file ..\NES\6502.s
Comment: K6502_Read used once
Read_Low 000000B0

Symbol: Read_Low
   Definitions
      At line 2090 in file ..\NES\6502.s
   Uses
      At line 2028 in file ..\NES\6502.s
Comment: Read_Low used once
Write_Low 000000C2

Symbol: Write_Low
   Definitions
      At line 2102 in file ..\NES\6502.s
   Uses
      At line 2050 in file ..\NES\6502.s
Comment: Write_Low used once
apu_4015R 00000104

Symbol: apu_4015R
   Definitions
      At line 2145 in file ..\NES\6502.s
   Uses
      At line 2042 in file ..\NES\6502.s
Comment: apu_4015R used once
apu_4015w 000000E4

Symbol: apu_4015w
   Definitions
      At line 2125 in file ..\NES\6502.s
   Uses
      At line 2083 in file ..\NES\6502.s
Comment: apu_4015w used once
apu_4017w 000000F4

Symbol: apu_4017w



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 2135 in file ..\NES\6502.s
   Uses
      At line 2086 in file ..\NES\6502.s
Comment: apu_4017w used once
apu_w 000000D4

Symbol: apu_w
   Definitions
      At line 2116 in file ..\NES\6502.s
   Uses
      At line 2062 in file ..\NES\6502.s
      At line 2063 in file ..\NES\6502.s
      At line 2064 in file ..\NES\6502.s
      At line 2065 in file ..\NES\6502.s
      At line 2066 in file ..\NES\6502.s
      At line 2067 in file ..\NES\6502.s
      At line 2068 in file ..\NES\6502.s
      At line 2069 in file ..\NES\6502.s
      At line 2070 in file ..\NES\6502.s
      At line 2071 in file ..\NES\6502.s
      At line 2072 in file ..\NES\6502.s
      At line 2073 in file ..\NES\6502.s
      At line 2074 in file ..\NES\6502.s
      At line 2075 in file ..\NES\6502.s
      At line 2076 in file ..\NES\6502.s
      At line 2077 in file ..\NES\6502.s
      At line 2078 in file ..\NES\6502.s
      At line 2079 in file ..\NES\6502.s
      At line 2080 in file ..\NES\6502.s
      At line 2081 in file ..\NES\6502.s

copy_ 0000013C

Symbol: copy_
   Definitions
      At line 2171 in file ..\NES\6502.s
   Uses
      At line 2175 in file ..\NES\6502.s
Comment: copy_ used once
dma_W 00000118

Symbol: dma_W
   Definitions
      At line 2155 in file ..\NES\6502.s
   Uses
      At line 2082 in file ..\NES\6502.s
Comment: dma_W used once
io_code 00000000

Symbol: io_code
   Definitions
      At line 2020 in file ..\NES\6502.s
   Uses
      None
Comment: io_code unused
io_read_tbl 00000024

Symbol: io_read_tbl



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 2041 in file ..\NES\6502.s
   Uses
      At line 2035 in file ..\NES\6502.s
Comment: io_read_tbl used once
io_write_tbl 00000050

Symbol: io_write_tbl
   Definitions
      At line 2061 in file ..\NES\6502.s
   Uses
      At line 2055 in file ..\NES\6502.s
Comment: io_write_tbl used once
joy0_R 00000170

Symbol: joy0_R
   Definitions
      At line 2199 in file ..\NES\6502.s
   Uses
      At line 2043 in file ..\NES\6502.s
Comment: joy0_R used once
joy0_W 00000152

Symbol: joy0_W
   Definitions
      At line 2183 in file ..\NES\6502.s
   Uses
      At line 2085 in file ..\NES\6502.s
Comment: joy0_W used once
joy1_R 0000018A

Symbol: joy1_R
   Definitions
      At line 2211 in file ..\NES\6502.s
   Uses
      At line 2044 in file ..\NES\6502.s
Comment: joy1_R used once
17 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CPU_GPU 00000000

Symbol: CPU_GPU
   Definitions
      At line 2240 in file ..\NES\6502.s
   Uses
      None
Comment: CPU_GPU unused
PPU_R 00000012

Symbol: PPU_R
   Definitions
      At line 2253 in file ..\NES\6502.s
   Uses
      At line 2289 in file ..\NES\6502.s
Comment: PPU_R used once
PPU_W 00000000

Symbol: PPU_W
   Definitions
      At line 2245 in file ..\NES\6502.s
   Uses
      At line 2298 in file ..\NES\6502.s
Comment: PPU_W used once
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CPU_RAM 00000044

Symbol: CPU_RAM
   Definitions
      At line 2305 in file ..\NES\6502.s
   Uses
      At line 2229 in file ..\NES\6502.s
Comment: CPU_RAM used once
clocks 000000A0

Symbol: clocks
   Definitions
      At line 2325 in file ..\NES\6502.s
   Uses
      At line 544 in file ..\NES\6502.s
Comment: clocks used once
cpu_data 00000000

Symbol: cpu_data
   Definitions
      At line 2285 in file ..\NES\6502.s
   Uses
      At line 545 in file ..\NES\6502.s
      At line 1631 in file ..\NES\6502.s
      At line 1689 in file ..\NES\6502.s
      At line 1777 in file ..\NES\6502.s
      At line 1813 in file ..\NES\6502.s

cpuirq 000000A8

Symbol: cpuirq
   Definitions
      At line 2329 in file ..\NES\6502.s
   Uses
      At line 543 in file ..\NES\6502.s
Comment: cpuirq used once
cpunmi 000000A4

Symbol: cpunmi
   Definitions
      At line 2327 in file ..\NES\6502.s
   Uses
      At line 542 in file ..\NES\6502.s
Comment: cpunmi used once
cpustate 00000064

Symbol: cpustate
   Definitions
      At line 2312 in file ..\NES\6502.s
   Uses
      None
Comment: cpustate unused
rommap 00000054

Symbol: rommap
   Definitions
      At line 2310 in file ..\NES\6502.s
   Uses
      At line 546 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Comment: rommap used once
wram_globals0 00000000

Symbol: wram_globals0
   Definitions
      At line 2283 in file ..\NES\6502.s
   Uses
      None
Comment: wram_globals0 unused
8 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

B 00000010

Symbol: B
   Definitions
      At line 32 in file ..\NES\6502.s
   Uses
      At line 56 in macro encodeP
      at line 618 in file ..\NES\6502.s
Comment: B used once
C 00000001

Symbol: C
   Definitions
      At line 28 in file ..\NES\6502.s
   Uses
      At line 62 in macro decodeP
      at line 763 in file ..\NES\6502.s
Comment: C used once
CYC_C 00000001

Symbol: CYC_C
   Definitions
      At line 566 in file ..\NES\6502.s
   Uses
      At line 51 in macro encodeP
      at line 618 in file ..\NES\6502.s
      At line 411 in macro opASL
      at line 641 in file ..\NES\6502.s
      At line 660 in file ..\NES\6502.s
      At line 704 in file ..\NES\6502.s
      At line 61 in macro decodeP
      at line 763 in file ..\NES\6502.s
      At line 828 in file ..\NES\6502.s
      At line 474 in macro opLSR
      at line 872 in file ..\NES\6502.s
      At line 891 in file ..\NES\6502.s
      At line 467 in macro opLSR
      at line 911 in file ..\NES\6502.s
      At line 483 in macro opLSR
      at line 938 in file ..\NES\6502.s
      At line 395 in macro opADC
      at line 974 in file ..\NES\6502.s
      At line 1145 in file ..\NES\6502.s
      At line 1274 in file ..\NES\6502.s
      At line 430 in macro opCOMP
      at line 1344 in file ..\NES\6502.s
      At line 526 in macro opSBC
      at line 1466 in file ..\NES\6502.s

CYC_D 00000008

Symbol: CYC_D
   Definitions
      At line 569 in file ..\NES\6502.s
   Uses
      At line 51 in macro encodeP
      at line 618 in file ..\NES\6502.s
      At line 61 in macro decodeP
      at line 763 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

      At line 1436 in file ..\NES\6502.s
      At line 1550 in file ..\NES\6502.s

CYC_I 00000004

Symbol: CYC_I
   Definitions
      At line 568 in file ..\NES\6502.s
   Uses
      At line 51 in macro encodeP
      at line 618 in file ..\NES\6502.s
      At line 61 in macro decodeP
      at line 763 in file ..\NES\6502.s
      At line 943 in file ..\NES\6502.s
      At line 1068 in file ..\NES\6502.s
      At line 1857 in file ..\NES\6502.s
      At line 1879 in file ..\NES\6502.s

CYC_V 00000040

Symbol: CYC_V
   Definitions
      At line 570 in file ..\NES\6502.s
   Uses
      At line 51 in macro encodeP
      at line 618 in file ..\NES\6502.s
      At line 418 in macro opBIT
      at line 745 in file ..\NES\6502.s
      At line 420 in macro opBIT
      at line 745 in file ..\NES\6502.s
      At line 61 in macro decodeP
      at line 763 in file ..\NES\6502.s
      At line 916 in file ..\NES\6502.s
      At line 395 in macro opADC
      at line 974 in file ..\NES\6502.s
      At line 396 in macro opADC
      at line 974 in file ..\NES\6502.s
      At line 1041 in file ..\NES\6502.s
      At line 1307 in file ..\NES\6502.s
      At line 526 in macro opSBC
      at line 1466 in file ..\NES\6502.s
      At line 527 in macro opSBC
      at line 1466 in file ..\NES\6502.s

D 00000008

Symbol: D
   Definitions
      At line 31 in file ..\NES\6502.s
   Uses
      At line 62 in macro decodeP
      at line 763 in file ..\NES\6502.s
Comment: D used once
I 00000004

Symbol: I
   Definitions
      At line 30 in file ..\NES\6502.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 62 in macro decodeP
      at line 763 in file ..\NES\6502.s
Comment: I used once
IRQ_VECTOR 0000FFFE

Symbol: IRQ_VECTOR
   Definitions
      At line 560 in file ..\NES\6502.s
   Uses
      At line 620 in file ..\NES\6502.s
      At line 1865 in file ..\NES\6502.s

N 00000080

Symbol: N
   Definitions
      At line 35 in file ..\NES\6502.s
   Uses
      At line 53 in macro encodeP
      at line 618 in file ..\NES\6502.s
Comment: N used once
NMI_VECTOR 0000FFFA

Symbol: NMI_VECTOR
   Definitions
      At line 562 in file ..\NES\6502.s
   Uses
      At line 1843 in file ..\NES\6502.s
Comment: NMI_VECTOR used once
R 00000020

Symbol: R
   Definitions
      At line 33 in file ..\NES\6502.s
   Uses
      At line 56 in macro encodeP
      at line 618 in file ..\NES\6502.s
Comment: R used once
RES_VECTOR 0000FFFC

Symbol: RES_VECTOR
   Definitions
      At line 561 in file ..\NES\6502.s
   Uses
      At line 1916 in file ..\NES\6502.s
Comment: RES_VECTOR used once
V 00000040

Symbol: V
   Definitions
      At line 34 in file ..\NES\6502.s
   Uses
      At line 419 in macro opBIT
      at line 745 in file ..\NES\6502.s
      At line 62 in macro decodeP
      at line 763 in file ..\NES\6502.s

Z 00000002




ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Absolute symbols

Symbol: Z
   Definitions
      At line 29 in file ..\NES\6502.s
   Uses
      At line 55 in macro encodeP
      at line 618 in file ..\NES\6502.s
      At line 65 in macro decodeP
      at line 763 in file ..\NES\6502.s

_ABS 00000004

Symbol: _ABS
   Definitions
      At line 262 in file ..\NES\6502.s
   Uses
      At line 299 in macro doIIX
      at line 628 in file ..\NES\6502.s
      At line 146 in macro readmem
      at line 493 in macro opORA
      at line 629 in file ..\NES\6502.s
      At line 203 in macro writemem
      at line 412 in macro opASL
      at line 641 in file ..\NES\6502.s
      At line 266 in macro doABS
      at line 665 in file ..\NES\6502.s
      At line 316 in macro doIIY
      at line 686 in file ..\NES\6502.s
      At line 284 in macro doAIY
      at line 709 in file ..\NES\6502.s
      At line 274 in macro doAIX
      at line 715 in file ..\NES\6502.s
      At line 464 in macro opLSR
      at line 872 in file ..\NES\6502.s
      At line 162 in macro readmems
      at line 458 in macro opLOAD
      at line 1203 in file ..\NES\6502.s

_IMM 00000001

Symbol: _IMM
   Definitions
      At line 259 in file ..\NES\6502.s
   Uses
      At line 155 in macro readmem
      at line 493 in macro opORA
      at line 629 in file ..\NES\6502.s
      At line 294 in macro doIMM
      at line 652 in file ..\NES\6502.s
      At line 169 in macro readmems
      at line 458 in macro opLOAD
      at line 1203 in file ..\NES\6502.s

_ZP 00000002

Symbol: _ZP
   Definitions
      At line 260 in file ..\NES\6502.s
   Uses
      At line 149 in macro readmem



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Absolute symbols

      at line 493 in macro opORA
      at line 629 in file ..\NES\6502.s
      At line 346 in macro doZ
      at line 634 in file ..\NES\6502.s
      At line 206 in macro writemem
      at line 412 in macro opASL
      at line 641 in file ..\NES\6502.s
      At line 471 in macro opLSR
      at line 872 in file ..\NES\6502.s
      At line 166 in macro readmems
      at line 458 in macro opLOAD
      at line 1203 in file ..\NES\6502.s
      At line 358 in macro doZIX
      at line 1289 in file ..\NES\6502.s
      At line 373 in macro doZIY
      at line 1301 in file ..\NES\6502.s

_ZPI 00000003

Symbol: _ZPI
   Definitions
      At line 261 in file ..\NES\6502.s
   Uses
      At line 152 in macro readmem
      at line 493 in macro opORA
      at line 629 in file ..\NES\6502.s
      At line 209 in macro writemem
      at line 412 in macro opASL
      at line 641 in file ..\NES\6502.s
      At line 366 in macro doZIXf
      at line 692 in file ..\NES\6502.s
      At line 477 in macro opLSR
      at line 872 in file ..\NES\6502.s
      At line 381 in macro doZIYf
      at line 1172 in file ..\NES\6502.s

19 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Register relative symbols

clocksh 000000A0

Symbol: clocksh
   Definitions
      At line 24 in file ..\NES\6502.s
   Uses
      At line 71 in macro fetch
      at line 623 in file ..\NES\6502.s
      At line 73 in macro fetch
      at line 623 in file ..\NES\6502.s
      At line 87 in macro fetch_c
      at line 642 in file ..\NES\6502.s
      At line 89 in macro fetch_c
      at line 642 in file ..\NES\6502.s

cpuirqf 000000A8

Symbol: cpuirqf
   Definitions
      At line 26 in file ..\NES\6502.s
   Uses
      At line 1821 in file ..\NES\6502.s
      At line 1863 in file ..\NES\6502.s
      At line 1912 in file ..\NES\6502.s

cpunmif 000000A4

Symbol: cpunmif
   Definitions
      At line 25 in file ..\NES\6502.s
   Uses
      At line 1828 in file ..\NES\6502.s
      At line 1841 in file ..\NES\6502.s
      At line 1911 in file ..\NES\6502.s

cpuregs 00000064

Symbol: cpuregs
   Definitions
      At line 12 in file ..\NES\6502.s
   Uses
      At line 1817 in file ..\NES\6502.s
      At line 1833 in file ..\NES\6502.s
      At line 1919 in file ..\NES\6502.s

joy0data 00000098

Symbol: joy0data
   Definitions
      At line 21 in file ..\NES\6502.s
   Uses
      At line 2191 in file ..\NES\6502.s
      At line 2201 in file ..\NES\6502.s
      At line 2203 in file ..\NES\6502.s

joy1data 0000009C

Symbol: joy1data
   Definitions



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Register relative symbols

      At line 22 in file ..\NES\6502.s
   Uses
      At line 2195 in file ..\NES\6502.s
      At line 2213 in file ..\NES\6502.s
      At line 2215 in file ..\NES\6502.s

lastbank 00000084

Symbol: lastbank
   Definitions
      At line 14 in file ..\NES\6502.s
   Uses
      At line 613 in file ..\NES\6502.s
      At line 728 in file ..\NES\6502.s
      At line 45 in macro encodePC
      at line 733 in file ..\NES\6502.s
      At line 1656 in file ..\NES\6502.s
      At line 1691 in file ..\NES\6502.s
      At line 1751 in file ..\NES\6502.s
      At line 1758 in file ..\NES\6502.s
      At line 1779 in file ..\NES\6502.s
      At line 1871 in file ..\NES\6502.s

m6502_s 00000080

Symbol: m6502_s
   Definitions
      At line 13 in file ..\NES\6502.s
   Uses
      At line 218 in macro push16
      at line 616 in file ..\NES\6502.s
      At line 222 in macro push16
      at line 616 in file ..\NES\6502.s
      At line 227 in macro push8
      at line 647 in file ..\NES\6502.s
      At line 229 in macro push8
      at line 647 in file ..\NES\6502.s
      At line 246 in macro pop8
      at line 762 in file ..\NES\6502.s
      At line 248 in macro pop8
      at line 762 in file ..\NES\6502.s
      At line 234 in macro pop16
      at line 853 in file ..\NES\6502.s
      At line 236 in macro pop16
      at line 853 in file ..\NES\6502.s
      At line 237 in macro pop16
      at line 853 in file ..\NES\6502.s
      At line 1191 in file ..\NES\6502.s
      At line 1318 in file ..\NES\6502.s
      At line 1908 in file ..\NES\6502.s

memmap_tbl 00000044

Symbol: memmap_tbl
   Definitions
      At line 11 in file ..\NES\6502.s
   Uses
      At line 40 in macro encodePC
      at line 733 in file ..\NES\6502.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Register relative symbols

      At line 1013 in file ..\NES\6502.s
      At line 1636 in file ..\NES\6502.s
      At line 1637 in file ..\NES\6502.s
      At line 1638 in file ..\NES\6502.s
      At line 1642 in file ..\NES\6502.s
      At line 1698 in file ..\NES\6502.s
      At line 1708 in file ..\NES\6502.s
      At line 1718 in file ..\NES\6502.s
      At line 1728 in file ..\NES\6502.s
      At line 1738 in file ..\NES\6502.s
      At line 1748 in file ..\NES\6502.s
      At line 1749 in file ..\NES\6502.s
      At line 1754 in file ..\NES\6502.s
      At line 1771 in file ..\NES\6502.s
      At line 1772 in file ..\NES\6502.s
      At line 1786 in file ..\NES\6502.s
      At line 1787 in file ..\NES\6502.s
      At line 1788 in file ..\NES\6502.s
      At line 1789 in file ..\NES\6502.s
      At line 1881 in file ..\NES\6502.s
      At line 1967 in file ..\NES\6502.s
      At line 1976 in file ..\NES\6502.s
      At line 1984 in file ..\NES\6502.s
      At line 1991 in file ..\NES\6502.s
      At line 1998 in file ..\NES\6502.s
      At line 2005 in file ..\NES\6502.s
      At line 2012 in file ..\NES\6502.s
      At line 2162 in file ..\NES\6502.s

nexttimeout 00000088

Symbol: nexttimeout
   Definitions
      At line 15 in file ..\NES\6502.s
   Uses
      At line 81 in macro fetch
      at line 623 in file ..\NES\6502.s
      At line 97 in macro fetch_c
      at line 642 in file ..\NES\6502.s
      At line 1923 in file ..\NES\6502.s

opz 00000000

Symbol: opz
   Definitions
      At line 8 in file ..\NES\6502.s
   Uses
      At line 75 in macro fetch
      at line 623 in file ..\NES\6502.s
      At line 91 in macro fetch_c
      at line 642 in file ..\NES\6502.s

readmem_tbl 00000004

Symbol: readmem_tbl
   Definitions
      At line 9 in file ..\NES\6502.s
   Uses
      At line 1901 in file ..\NES\6502.s



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Register relative symbols

Comment: readmem_tbl used once
rombase 0000008C

Symbol: rombase
   Definitions
      At line 17 in file ..\NES\6502.s
   Uses
      At line 1648 in file ..\NES\6502.s
      At line 1695 in file ..\NES\6502.s
      At line 1703 in file ..\NES\6502.s
      At line 1713 in file ..\NES\6502.s
      At line 1723 in file ..\NES\6502.s
      At line 1733 in file ..\NES\6502.s
      At line 1743 in file ..\NES\6502.s
      At line 1766 in file ..\NES\6502.s
      At line 1781 in file ..\NES\6502.s

rommask 00000094

Symbol: rommask
   Definitions
      At line 19 in file ..\NES\6502.s
   Uses
      At line 1653 in file ..\NES\6502.s
      At line 1693 in file ..\NES\6502.s
      At line 1705 in file ..\NES\6502.s
      At line 1715 in file ..\NES\6502.s
      At line 1725 in file ..\NES\6502.s
      At line 1735 in file ..\NES\6502.s
      At line 1745 in file ..\NES\6502.s
      At line 1768 in file ..\NES\6502.s
      At line 1783 in file ..\NES\6502.s

romnumber 00000090

Symbol: romnumber
   Definitions
      At line 18 in file ..\NES\6502.s
   Uses
      None
Comment: romnumber unused
writemem_tbl 00000024

Symbol: writemem_tbl
   Definitions
      At line 10 in file ..\NES\6502.s
   Uses
      At line 178 in macro writememabs
      at line 204 in macro writemem
      at line 412 in macro opASL
      at line 672 in file ..\NES\6502.s
      At line 1675 in file ..\NES\6502.s
      At line 1676 in file ..\NES\6502.s
      At line 1677 in file ..\NES\6502.s
      At line 1678 in file ..\NES\6502.s

16 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

Apu_Read4015 00000000

Symbol: Apu_Read4015
   Definitions
      At line 2144 in file ..\NES\6502.s
   Uses
      At line 2149 in file ..\NES\6502.s
Comment: Apu_Read4015 used once
Apu_Write 00000000

Symbol: Apu_Write
   Definitions
      At line 2113 in file ..\NES\6502.s
   Uses
      At line 2119 in file ..\NES\6502.s
Comment: Apu_Write used once
Apu_Write4015 00000000

Symbol: Apu_Write4015
   Definitions
      At line 2114 in file ..\NES\6502.s
   Uses
      At line 2128 in file ..\NES\6502.s
Comment: Apu_Write4015 used once
Apu_Write4017 00000000

Symbol: Apu_Write4017
   Definitions
      At line 2134 in file ..\NES\6502.s
   Uses
      At line 2138 in file ..\NES\6502.s
Comment: Apu_Write4017 used once
NES_RAM 00000000

Symbol: NES_RAM
   Definitions
      At line 537 in file ..\NES\6502.s
   Uses
      At line 1632 in file ..\NES\6502.s
      At line 1814 in file ..\NES\6502.s
      At line 1904 in file ..\NES\6502.s
      At line 2306 in file ..\NES\6502.s
      At line 2307 in file ..\NES\6502.s
      At line 2308 in file ..\NES\6502.s

NES_SRAM 00000000

Symbol: NES_SRAM
   Definitions
      At line 538 in file ..\NES\6502.s
   Uses
      At line 1640 in file ..\NES\6502.s
      At line 2309 in file ..\NES\6502.s

PADdata0 00000000

Symbol: PADdata0
   Definitions
      At line 2181 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

   Uses
      At line 2189 in file ..\NES\6502.s
Comment: PADdata0 used once
PADdata1 00000000

Symbol: PADdata1
   Definitions
      At line 2182 in file ..\NES\6502.s
   Uses
      At line 2193 in file ..\NES\6502.s
Comment: PADdata1 used once
PPU_ReadFromPort 00000000

Symbol: PPU_ReadFromPort
   Definitions
      At line 2243 in file ..\NES\6502.s
   Uses
      At line 2256 in file ..\NES\6502.s
Comment: PPU_ReadFromPort used once
PPU_WriteToPort 00000000

Symbol: PPU_WriteToPort
   Definitions
      At line 2242 in file ..\NES\6502.s
   Uses
      At line 2248 in file ..\NES\6502.s
Comment: PPU_WriteToPort used once
asm_Mapper_ReadLow 00000000

Symbol: asm_Mapper_ReadLow
   Definitions
      At line 2089 in file ..\NES\6502.s
   Uses
      At line 2094 in file ..\NES\6502.s
Comment: asm_Mapper_ReadLow used once
asm_Mapper_Write 00000000

Symbol: asm_Mapper_Write
   Definitions
      At line 1793 in file ..\NES\6502.s
   Uses
      At line 1798 in file ..\NES\6502.s
Comment: asm_Mapper_Write used once
asm_Mapper_WriteLow 00000000

Symbol: asm_Mapper_WriteLow
   Definitions
      At line 2101 in file ..\NES\6502.s
   Uses
      At line 2106 in file ..\NES\6502.s
Comment: asm_Mapper_WriteLow used once
debug_6502 00000000

Symbol: debug_6502
   Definitions
      At line 1612 in file ..\NES\6502.s
   Uses
      At line 1616 in file ..\NES\6502.s
      At line 1938 in file ..\NES\6502.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols


romfile 00000000

Symbol: romfile
   Definitions
      At line 540 in file ..\NES\6502.s
   Uses
      At line 1645 in file ..\NES\6502.s
Comment: romfile used once
spr_ram 00000000

Symbol: spr_ram
   Definitions
      At line 539 in file ..\NES\6502.s
   Uses
      At line 2167 in file ..\NES\6502.s
Comment: spr_ram used once
16 symbols
701 symbols in table
